{"version":3,"mappings":"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","names":["isNodeJS","createErrorWithCleanStackTrace","errorMessage","numberOfStackTraceLinesToRemove","err","stackTraceLimit__original","clean","errStack","stackLines","splitByLine","linesRemoved","line","isStackTraceLine","str","getGlobalObject","key","defaultValue","allGlobalObjects","isObject","value","unique","arr","globalObject","clientRuntimesClonflict","clientNotSingleInstance","assertSingleInstance","versions","assertUsage","assertWarning","onClientEntry_ClientRouting","isProduction","onProjectInfo","projectVersion","condition","errMsg","onlyOnce","showStackTrace","msg","alreadyLogged","PROJECT_VERSION","projectInfo","v","s","pc","logType","projectTag","projectTagWithVersion","assert","debugInfo","debugStr","debugInfoSerialized","link","addWhitespace","addPrefixAssertType","addPrefixProjctName","internalError","usageError","getProjectError","assertInfo","tag","prefix","color","showProjectVersion","isBrowser","state","assertClientRouting","assertNoContradiction","checkIfClientRouting","noContradiction","extJavaScript","extTemplates","scriptFileExtensionList","isScriptFile","filePath","yes","ext","isJavaScriptFile","isTemplateFile","slice","thing","from","to","sliceArray","list","listSlice","start","end","el","PROTOCOLS","isParsable","url","p","assertUsageUrl","errPrefix","parseUrl","baseServer","urlWithoutHash","hashList","hashOriginal","hash","decodeSafe","urlWithoutHashNorSearch","searchList","searchOriginal","search","searchAll","val","origin","pathnameResolved","getPathname","pathnameOriginal","assertUrlComponents","pathname","hasBaseServer","analyzeBaseServer","decodePathname","urlComponent","urlPathname","dir","parseOrigin","baseURI","_a","base","resolveUrlPathnameRelative","protocol","originPart1","originPart2","originPart3","pathnameParts","pathnameRelative","stack","parts","baseRestoreTrailingSlash","i","pathnameAbsolute","assertPathname","urlPathnameWithBase","isBaseServer","baseServerNormalized","urlRecreated","createUrlFromComponents","objectAssign","obj","objAddendum","isCallable","higherFirst","getValue","element1","element2","val1","val2","lowerFirst","makeFirst","makeLast","element","hasProp","prop","type","propValue","isPlainObject","compareString","str1","str2","isNotNullish","stringifyStringArray","stringList","assertPosixPath","path","isPropertyGetter","descriptor","isPromise","getValuePrintable","escapeRegex","enforceTrue","assertExportValues","pageFile","exportName","explainer","forbiddenDefaultExports","assertDefaultExports","defaultExportName","getExportPath","fileExportPathToShowToUser","configName","exportObjectPath","suffix","getConfigDefinedAtString","sentenceBegin","definedAt","definedAtString","getDefinedAtString","definedAtStr","configNameStr","files","source","filePathToShowToUser","exportPath","getConfigValue","pageConfig","configValue","getConfigValueEntry","assertConfigValueType","typeActual","valuePrintable","problem","getPageConfig","pageId","pageConfigs","getConfigValueFilePathToShowToUser","getHookFilePathToShowToUser","getExports","pageFiles","configEntries","config","exportsAll","getExportValues","exportValue","isFromDefaultExport","configValueFilePathToShowToUser","configDefinedAt","pageExports","createObjectWithDeprecationWarning","exports","values","_fileType","_isFromDefaultExport","fileExports","exportValues","defaultExportValue","args","determinePageIdOld","pageSuffix","assertPageFilePath","getErrorPageId","pageFilesAll","errorPageConfigs","errorPageIds","isErrorPageId","errorPageId","_isV1Design","isErrorPage","fileTypes","determineFileType","suffix1","suffix2","getPageFileObject","isRelevant","isRendererFilePath","isAncestorDefaultPage","fileType","env","isDefaultFilePath","defaultPageFilePath","defaultPageDir","filePathSegment","assertPageConfigsSerialized","pageConfigsSerialized","pageConfigSerialized","assertPageConfigGlobalSerialized","pageConfigGlobalSerialized","EXPORTS_IGNORE","TOLERATE_SIDE_EXPORTS","assertExportsOfValueFile","assertExports","exportsRelevant","exportsInvalid","e","exportDefault","exportConfigName","exportInvalid","exportsInvalidStr","parseConfigValuesImported","configValuesImported","configValues","addConfigValue","importPath","assertIsNotNull","configValueLoaded","isSideExport","types","pattern","flags","serializer","deserializer","parse","modifier","reviver","match","deserialize","parseConfigValuesSerialized","configValuesSerialized","configValueSeriliazed","valueSerialized","parsePageConfigs","configValuesAddendum","routeFilesystem","loadConfigValuesAll","assertRouteConfigValue","pageConfigGlobal","configValueType","parseGlobResults","pageFilesExports","pageFilesMap","parseGlobResult","globValue","loadModule","assertLoadModule","moduleExports","globObject","ret","globFiles","setPageFiles","getPageFilesAll","isClientSide","allPageIds","getAllPageIds","allPageFiles","fileIds","isDefaultPageFile","allPageIds2","getPageFilesClientSide","determine","getPageFilesServerSide","envIsClient","pageFilesRelevant","getPageFilesSorter","getPageIdFile","iso","pageIdFile","pageIdFileEnv","pageIdFileIso","getRendererFile","rendererFileEnv","rendererFileIso","defaultFilesNonRenderer","e1First","e2First","noOrder","e1","e2","e1_isRenderer","e2_isRenderer","e1_distance","getPathDistance","e2_distance","pathA","pathB","idx","pathAWithoutCommon","pathBWithoutCommon","distanceA","distanceB","assertIsBrowser","onLoad","humanizeTime","milliseconds","seconds","round","plural","minutes","n","rounded","executeHook","hookFnCaller","hook","hookName","hookFilePath","timeoutErr","timeoutWarn","resolve","reject","promise","resolve_","reject_","clearTimeouts","currentTimeoutWarn","currentTimeoutErr","isNotDisabled","timeout","getCurrentUrl","options","urlCurrent","isReact","isReact1","_b","isReact2","_d","_c","isReact3","deepEqual","x","y","ok","tx","isEquivalentError","err1","err2","serverSideRouteTo","sleep","r","throttle","func","waitTime","isQueued","onPageHide","listener","onPageShow","isExternalLink","initHistoryState","hasModifications","getTimestamp","getScrollPosition","assertState","replaceHistoryState","getHistoryState","saveScrollPosition","scrollPosition","pushHistory","overwriteLastHistoryEntry","timestamp","pushHistoryState","pushStateOriginal","monkeyPatchHistoryPushState","stateFromUser","rest","getPageContextSerializedInHtml","id","elem","pageContextJson","pageContextSerializedInHtml","analyzePageServerSide","pageFilesServerSideOnly","exportNames","getHook","pageContext","hooksTimeout","hookTimeout","getHookTimeout","hookFn","file","assertHookFn","getHookFromPageConfigGlobal","getHookTimeoutDefault","assertHook","hooksTimeoutProvidedByUser","hooksTimeoutProvidedbyUserNormalized","getHooksTimeoutProvidedByUserNormalized","providedbyUser","hooksTimeoutProvidedByUserNormalized","hookTimeoutProvidedbyUser","error","warning","timeoutName","timeoutVal","sortPageContext","entries","key1","key2","addIs404ToPageProps","assertIs404","addIs404","pageProps","notSerializable","getPageContextProxyForUser","_","propName","assertIsDefined","ignoreNextRead","isExpected","IGNORE_LIST","preparePageContextForUserConsumptionClientSide","isClientRouting","pageContextTyped","Page","resolveGetters","pageContextForUserConsumption","findPageConfig","result","loadConfigValues","isDev","configValuesLoaded","stamp","loadPageFilesClientSide","pageFilesClientSide","pageConfigLoaded","isFetchError","isErrorFetchingStaticAssets","BUILT_IN_CLIENT_ROUTER","BUILT_IN_CLIENT","removeBuiltInOverrides","urlToFile","fileExtension","doNotCreateExtraDirectory","hasTrailingSlash","pathnameModified","pageContextJsonFileExtension","getPageContextRequestUrl","assertPageContextProvidedByUser","pageContextProvidedByUser","assertHookReturnedObject","keysExpected","keysUnknown","keys","assertOnBeforeRenderHookReturn","hookReturnValue","isObjectWithKeys","isStringRecord","joinEnglish","conjunction","colorizer","firsts","last","executeGuardHook","prepareForUserConsumption","findPageGuard","guard","res","hookResult","pageRouteFile","AbortRender","pageContextAbort","isAbortError","isAbortPageContext","logAbortErrorHandled","abortCall","getPageContextFromAllRewrites","pageContextsFromRewrite","assertNoInfiniteLoop","pageContextFromAllRewrites","pageContextFromRewrite","urlRewrites","urlRewrite","loop","assertNoInfiniteAbortLoop","rewriteCount","redirectCount","abortCalls","getPageContextFromHooks_firstRender","pageContextFromHooks","pageContextForHook","onBeforeRenderClientOnlyExists","pageContextFromHook","executeOnBeforeRenderHookClientSide","setPageContextInitHasClientData","getPageContextFromHooks_errorPage","getPageContextAlreadyRouted","getPageContextFromHooks_uponNavigation","pageContextFetchedFromServer","hasPageContextServer","pageContextFromServer","fetchPageContextFromServer","onBeforeRender","pageContextFromOnBeforeRender","onBeforeRenderServerOnlyExists","onBeforeRenderEnv","hasOnBeforeRenderServerSideOnlyHook","pageContextUrl","response","contentType","contentTypeCorrect","isCorrect","AlreadyServerSideRouted","responseText","isAlreadyServerSideRouted","addUrlComputedProps","enumerable","urlPathnameGetter","urlGetter","urlParsedGetter","getUrlParsed","urlHandler","urlResolved","urlParsedOriginal","hashIsAvailable","warnHashNotAvailable","urlParsed","makeNonEnumerable","assertPageContextUrlComputedProps","deduceRouteStringFromFilesystemPath","filesystemRoots","fsBase","filesystemRoot","filesystemRoute","urlRoot","resolveRouteFunction","routeFunction","routeDefinedAt","assertSyncRouting","precedence","assertRouteParams","routeParams","warnDeprecatedAllowKey","allowKey","loadPageRoutes","onBeforeRouteHook","getGlobalHooks","getPageRoutes","pageRoutes","pageIds","comesFromV1PageConfig","removePageId","pageRoute","route","routeString","definedBy","onBeforeRoute","dirname","paths","dirPath","length","getBaseServer","createPageContext","urlOriginal","skipLink","linkTag","isNewTabLink","isHashUrl","isVikeLink","isDisableAutomaticLinkInterception","target","rel","removeHash","getPrefetchSettings","prefetchStaticAssets","getPrefetchStaticAssets","prefetchAttribute","getPrefetchAttribute","wrongUsageMsg","when","correctValue","attr","attrOld","deprecationNotice","linkAlreadyPrefetched","isAlreadyPrefetched","getUrlPathname","markAsAlreadyPrefetched","getExportNames","analyzeExports","pageFilesServerSide","isHtmlOnly","assertClientSideRenderHook","hasClientSideRenderHook","determineClientEntry","clientEntries","clientDependencies","clientEntry","getVikeClientEntry","analyzePageClientSide","removeOverridenPageFiles","analyzePageClientSideInit","sharedPageFilesAlreadyLoaded","pageFilesClientSide_","analyzeClientSide","isClientSideRoutable","isClientSideRenderable","PARAM_TOKEN_NEW","PARAM_TOKEN_OLD","assertRouteString","errPrefix2","highlight","resolveRouteString","segments","parseRouteString","routeRegexStrInner","segment","routeRegex","routeRegexMatch","segmentsValue","globIdx","hasMultipleGlobs","param","pushStatic","segmentLast","isFirst","isLast","isParam","analyzeRouteString","countStaticParts","numberOfStaticPartsBeginning","numberOfStaticParts","sum","a","numberOfParams","numberOfGlobs","routeSegment","isStaticRouteString","resolvePrecendence","routeMatches","sortMatches","routeMatch","routeMatch1","routeMatch2","precedence1","precedence2","executeOnBeforeRouteHook","pageContextFromOnBeforeRouteHook","getPageContextFromHook","hookReturn","deprecatedReturn","pageContextAddendumHook","_debug","debug","pageContextForRoute","pageContextFromRoute","routeType","winner","prefetchAssets","disableClientRouting","addLinkPrefetchHandlers","prefetchIfPossible","observer","entry","executeOnRenderClientHook","renderHook","urlToShowToUser","getUrlToShowToUser","pageClientsFilesLoaded","setScrollPosition","scrollTarget","getUrlHash","hashTarget","setScroll","scroll","done","autoSaveScrollPosition","getState","onBrowserHistoryNavigation","ev","currentState","isUserLandPushStateNavigation","isHashNavigation","isBackwardNavigation","renderPageClientSide","updateState","setupNativeScrollRestoration","browserNativeScrollRestoration_enable","browserNativeScrollRestoration_disable","setInitialRenderIsDone","renderArgs","isClientSideNavigation","abortRender","setHydrationCanBeAborted","isFirstRender","getAbortRender","renderState","onError","isClientRoutable","isSamePage","callTransitionHooks","shouldSwallowAndInterrupt","errAbort","urlRedirect","onPageTransitionStartHook","changeUrl","handleErrorFetchingStaticAssets","log","renderNumber","hydrationCanBeAborted","isRenderCleanup","getRenderCount","onLinkClick","handler","isNormalLeftClick","findLinkTag","parentNode","installClientRouter","isProd"],"sources":["../../../../node_modules/vike/dist/esm/utils/isNodeJS.js","../../../../node_modules/vike/dist/esm/utils/createErrorWithCleanStackTrace.js","../../../../node_modules/vike/dist/esm/utils/getGlobalObject.js","../../../../node_modules/vike/dist/esm/utils/isObject.js","../../../../node_modules/vike/dist/esm/utils/unique.js","../../../../node_modules/vike/dist/esm/utils/assertSingleInstance.js","../../../../node_modules/vike/dist/esm/utils/projectInfo.js","../../../../node_modules/@brillout/picocolors/picocolors.browser.mjs","../../../../node_modules/vike/dist/esm/utils/assert.js","../../../../node_modules/vike/dist/esm/utils/isBrowser.js","../../../../node_modules/vike/dist/esm/utils/assertRoutingType.js","../../../../node_modules/vike/dist/esm/utils/isScriptFile.js","../../../../node_modules/vike/dist/esm/utils/slice.js","../../../../node_modules/vike/dist/esm/utils/parseUrl.js","../../../../node_modules/vike/dist/esm/utils/objectAssign.js","../../../../node_modules/vike/dist/esm/utils/isCallable.js","../../../../node_modules/vike/dist/esm/utils/sorter.js","../../../../node_modules/vike/dist/esm/utils/hasProp.js","../../../../node_modules/vike/dist/esm/utils/isPlainObject.js","../../../../node_modules/vike/dist/esm/utils/compareString.js","../../../../node_modules/vike/dist/esm/utils/isNotNullish.js","../../../../node_modules/vike/dist/esm/utils/stringifyStringArray.js","../../../../node_modules/vike/dist/esm/utils/filesystemPathHandling.js","../../../../node_modules/vike/dist/esm/utils/isPropertyGetter.js","../../../../node_modules/vike/dist/esm/utils/isPromise.js","../../../../node_modules/vike/dist/esm/utils/getValuePrintable.js","../../../../node_modules/vike/dist/esm/utils/escapeRegex.js","../../../../node_modules/vike/dist/esm/shared/getPageFiles/assert_exports_old_design.js","../../../../node_modules/vike/dist/esm/shared/page-configs/getExportPath.js","../../../../node_modules/vike/dist/esm/shared/page-configs/helpers/getConfigDefinedAtString.js","../../../../node_modules/vike/dist/esm/shared/page-configs/helpers/getConfigValue.js","../../../../node_modules/vike/dist/esm/shared/page-configs/helpers.js","../../../../node_modules/vike/dist/esm/shared/getPageFiles/getExports.js","../../../../node_modules/vike/dist/esm/shared/determinePageIdOld.js","../../../../node_modules/vike/dist/esm/shared/assertPageFilePath.js","../../../../node_modules/vike/dist/esm/shared/error-page.js","../../../../node_modules/vike/dist/esm/shared/getPageFiles/fileTypes.js","../../../../node_modules/vike/dist/esm/shared/getPageFiles/getPageFileObject.js","../../../../node_modules/vike/dist/esm/shared/page-configs/serialize/assertPageConfigsSerialized.js","../../../../node_modules/vike/dist/esm/shared/page-configs/assertExports.js","../../../../node_modules/vike/dist/esm/shared/page-configs/serialize/parseConfigValuesImported.js","../../../../node_modules/@brillout/json-serializer/dist/esm/types.js","../../../../node_modules/@brillout/json-serializer/dist/esm/parse.js","../../../../node_modules/vike/dist/esm/shared/page-configs/serialize/parseConfigValuesSerialized.js","../../../../node_modules/vike/dist/esm/shared/page-configs/serialize/parsePageConfigs.js","../../../../node_modules/vike/dist/esm/shared/getPageFiles/parseGlobResults.js","../../../../node_modules/vike/dist/esm/shared/getPageFiles/setPageFiles.js","../../../../node_modules/vike/dist/esm/shared/getPageFiles/getAllPageIdFiles.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/pageFiles.js","../../../../node_modules/vike/dist/esm/utils/assertIsBrowser.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/onLoad.js","../../../../node_modules/vike/dist/esm/client/server-routing-runtime/onLoad.js","../../../../node_modules/vike/dist/esm/utils/humanizeTime.js","../../../../node_modules/vike/dist/esm/shared/hooks/executeHook.js","../../../../node_modules/vike/dist/esm/utils/getCurrentUrl.js","../../../../node_modules/vike/dist/esm/client/server-routing-runtime/utils.js","../../../../node_modules/vike/dist/esm/utils/isReact.js","../../../../node_modules/vike/dist/esm/utils/deepEqual.js","../../../../node_modules/vike/dist/esm/utils/isEquivalentError.js","../../../../node_modules/vike/dist/esm/utils/serverSideRouteTo.js","../../../../node_modules/vike/dist/esm/utils/sleep.js","../../../../node_modules/vike/dist/esm/utils/throttle.js","../../../../node_modules/vike/dist/esm/utils/onPageVisibilityChange.js","../../../../node_modules/vike/dist/esm/utils/isExternalLink.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/utils.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/history.js","../../../../node_modules/vike/dist/esm/client/shared/getPageContextSerializedInHtml.js","../../../../node_modules/vike/dist/esm/shared/getPageFiles/analyzePageServerSide.js","../../../../node_modules/vike/dist/esm/shared/hooks/getHook.js","../../../../node_modules/vike/dist/esm/shared/sortPageContext.js","../../../../node_modules/vike/dist/esm/shared/addIs404ToPageProps.js","../../../../node_modules/vike/dist/esm/shared/notSerializable.js","../../../../node_modules/vike/dist/esm/client/shared/getPageContextProxyForUser.js","../../../../node_modules/vike/dist/esm/client/shared/preparePageContextForUserConsumptionClientSide.js","../../../../node_modules/vike/dist/esm/shared/page-configs/findPageConfig.js","../../../../node_modules/vike/dist/esm/shared/page-configs/loadConfigValues.js","../../../../node_modules/vike/dist/esm/client/shared/loadPageFilesClientSide.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/getPageContext/removeBuiltInOverrides.js","../../../../node_modules/vike/dist/esm/utils/urlToFile.js","../../../../node_modules/vike/dist/esm/shared/getPageContextRequestUrl.js","../../../../node_modules/vike/dist/esm/shared/assertPageContextProvidedByUser.js","../../../../node_modules/vike/dist/esm/shared/assertHookReturnedObject.js","../../../../node_modules/vike/dist/esm/shared/assertOnBeforeRenderHookReturn.js","../../../../node_modules/vike/dist/esm/utils/isObjectWithKeys.js","../../../../node_modules/vike/dist/esm/utils/isStringRecord.js","../../../../node_modules/vike/dist/esm/utils/joinEnglish.js","../../../../node_modules/vike/dist/esm/shared/route/utils.js","../../../../node_modules/vike/dist/esm/shared/route/executeGuardHook.js","../../../../node_modules/vike/dist/esm/shared/route/abort.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/getPageContextFromHooks.js","../../../../node_modules/vike/dist/esm/shared/addUrlComputedProps.js","../../../../node_modules/vike/dist/esm/shared/route/deduceRouteStringFromFilesystemPath.js","../../../../node_modules/vike/dist/esm/shared/route/resolveRouteFunction.js","../../../../node_modules/vike/dist/esm/shared/route/loadPageRoutes.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/getBaseServer.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/createPageContext.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/skipLink.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/prefetch/getPrefetchSettings.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/prefetch/alreadyPrefetched.js","../../../../node_modules/vike/dist/esm/shared/getPageFiles/analyzePageClientSide/getExportNames.js","../../../../node_modules/vike/dist/esm/shared/getPageFiles/analyzePageClientSide/analyzeExports.js","../../../../node_modules/vike/dist/esm/shared/getPageFiles/analyzePageClientSide/determineClientEntry.js","../../../../node_modules/vike/dist/esm/shared/getPageFiles/analyzePageClientSide.js","../../../../node_modules/vike/dist/esm/shared/getPageFiles/analyzeClientSide.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/isClientSideRoutable.js","../../../../node_modules/vike/dist/esm/shared/route/resolveRouteString.js","../../../../node_modules/vike/dist/esm/shared/route/resolvePrecedence.js","../../../../node_modules/vike/dist/esm/shared/route/executeOnBeforeRouteHook.js","../../../../node_modules/vike/dist/esm/shared/route/debug.js","../../../../node_modules/vike/dist/esm/shared/route/index.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/prefetch.js","../../../../node_modules/vike/dist/esm/client/shared/executeOnRenderClientHook.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/setScrollPosition.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/onBrowserHistoryNavigation.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/scrollRestoration.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/renderPageClientSide.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/onLinkClick.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/installClientRouter.js","../../../../node_modules/vike/dist/esm/client/client-routing-runtime/entry.js"],"sourcesContent":["export function isNodeJS() {\n    if (typeof process === 'undefined')\n        return false;\n    if (!process.cwd)\n        return false;\n    // https://stackoverflow.com/questions/4224606/how-to-check-whether-a-script-is-running-under-node-js/35813135#35813135\n    if (!process.versions || typeof process.versions.node === 'undefined')\n        return false;\n    // https://stackoverflow.com/questions/4224606/how-to-check-whether-a-script-is-running-under-node-js/35813135#comment92529277_35813135\n    if (!process.release || process.release.name !== 'node')\n        return false;\n    return true;\n}\n","export { createErrorWithCleanStackTrace };\nimport { isNodeJS } from './isNodeJS.js';\nfunction createErrorWithCleanStackTrace(errorMessage, numberOfStackTraceLinesToRemove) {\n    let err;\n    {\n        var stackTraceLimit__original = Error.stackTraceLimit;\n        Error.stackTraceLimit = Infinity;\n        err = new Error(errorMessage);\n        Error.stackTraceLimit = stackTraceLimit__original;\n    }\n    if (isNodeJS()) {\n        err.stack = clean(err.stack, numberOfStackTraceLinesToRemove);\n    }\n    return err;\n}\nfunction clean(errStack, numberOfStackTraceLinesToRemove) {\n    if (!errStack) {\n        return errStack;\n    }\n    const stackLines = splitByLine(errStack);\n    let linesRemoved = 0;\n    const stackLine__cleaned = stackLines\n        .filter((line) => {\n        // Remove internal stack traces\n        if (line.includes(' (internal/') || line.includes(' (node:internal')) {\n            return false;\n        }\n        if (linesRemoved < numberOfStackTraceLinesToRemove && isStackTraceLine(line)) {\n            linesRemoved++;\n            return false;\n        }\n        return true;\n    })\n        .join('\\n');\n    return stackLine__cleaned;\n}\nfunction isStackTraceLine(line) {\n    return line.startsWith('    at ');\n}\nfunction splitByLine(str) {\n    // https://stackoverflow.com/questions/21895233/how-in-node-to-split-string-by-newline-n\n    return str.split(/\\r?\\n/);\n}\n","export function getGlobalObject(\n// We use the filename as key; each `getGlobalObject()` call should live in a unique filename.\nkey, defaultValue) {\n    const allGlobalObjects = (globalThis.__vike = globalThis.__vike || {});\n    const globalObject = (allGlobalObjects[key] = allGlobalObjects[key] || defaultValue);\n    return globalObject;\n}\n","export function isObject(value) {\n    return typeof value === 'object' && value !== null;\n}\n","export { unique };\nfunction unique(arr) {\n    return Array.from(new Set(arr));\n}\n","export { onClientEntry_ServerRouting };\nexport { onClientEntry_ClientRouting };\nexport { onProjectInfo };\n//  - Throw error if there are two different versions of vike loaded\n//  - Show warning if entry of Client Routing and entry of Server Routing are both loaded\n//  - Show warning if vike is loaded twice\nimport { unique } from './unique.js';\nimport { getGlobalObject } from './getGlobalObject.js';\n/* Use original assertUsage() & assertWarning() after all CJS is removed from node_modules/vike/dist/\nimport { assertUsage, assertWarning } from './assert.js'\n*/\nconst globalObject = getGlobalObject('assertPackageInstances.ts', {\n    instances: [],\n    alreadyLogged: new Set()\n});\nconst clientRuntimesClonflict = \"The client runtime of Server Routing as well as the client runtime of Client Routing are both being loaded. Make sure they aren't loaded both at the same time for a given page. See https://vike.dev/client-runtimes-conflict\";\nconst clientNotSingleInstance = \"Two vike client runtime instances are being loaded. Make sure your client-side bundles don't include vike twice. (In order to reduce the size of your client-side JavaScript bundles.)\";\nfunction assertSingleInstance() {\n    {\n        const versions = unique(globalObject.instances);\n        assertUsage(versions.length <= 1, \n        // DO *NOT* patch vike to remove this error: because of multiple conflicting versions, you *will* eventually encounter insidious issues that hard to debug and potentially a security hazard, see for example https://github.com/vikejs/vike/issues/1108\n        `Both vike@${versions[0]} and vike@${versions[1]} loaded. Only one version should be loaded.`);\n    }\n    if (globalObject.checkSingleInstance && globalObject.instances.length > 1) {\n        /*/ Not sure whether circular dependency can cause problems? In principle not since client-side code is ESM.\n        console.warn(clientNotSingleInstance)\n        /*/\n        assertWarning(false, clientNotSingleInstance, { onlyOnce: true, showStackTrace: true });\n        //*/\n    }\n}\nfunction onClientEntry_ServerRouting(isProduction) {\n    assertWarning(globalObject.isClientRouting !== true, clientRuntimesClonflict, {\n        onlyOnce: true,\n        showStackTrace: true\n    });\n    assertWarning(globalObject.isClientRouting === undefined, clientNotSingleInstance, {\n        onlyOnce: true,\n        showStackTrace: true\n    });\n    globalObject.isClientRouting = false;\n    if (isProduction)\n        globalObject.checkSingleInstance = true;\n    assertSingleInstance();\n}\nfunction onClientEntry_ClientRouting(isProduction) {\n    assertWarning(globalObject.isClientRouting !== false, clientRuntimesClonflict, {\n        onlyOnce: true,\n        showStackTrace: true\n    });\n    assertWarning(globalObject.isClientRouting === undefined, clientNotSingleInstance, {\n        onlyOnce: true,\n        showStackTrace: true\n    });\n    globalObject.isClientRouting = true;\n    if (isProduction)\n        globalObject.checkSingleInstance = true;\n    assertSingleInstance();\n}\n// Called by utils/projectInfo.ts which is loaded by all entries (since utils/asserts.ts depends on utils/projectInfo.ts, we can have confidence that onProjectInfo() is called by each entry). That way we don't have to call a callback for every entry (there are a *lot* of entries: `client/router/`, `client/`, `node/runtime/`, `node/plugin/`, `node/cli`).\nfunction onProjectInfo(projectVersion) {\n    globalObject.instances.push(projectVersion);\n    assertSingleInstance();\n}\nfunction assertUsage(condition, errorMessage) {\n    if (condition) {\n        return;\n    }\n    const errMsg = `[vike][Wrong Usage] ${errorMessage}`;\n    throw new Error(errMsg);\n}\nfunction assertWarning(condition, errorMessage, { onlyOnce, showStackTrace }) {\n    if (condition) {\n        return;\n    }\n    const msg = `[vike][Warning] ${errorMessage}`;\n    if (onlyOnce) {\n        const { alreadyLogged } = globalObject;\n        const key = onlyOnce === true ? msg : onlyOnce;\n        if (alreadyLogged.has(key)) {\n            return;\n        }\n        else {\n            alreadyLogged.add(key);\n        }\n    }\n    if (showStackTrace) {\n        console.warn(new Error(msg));\n    }\n    else {\n        console.warn(msg);\n    }\n}\n","export { projectInfo };\nexport { PROJECT_VERSION };\nimport { onProjectInfo } from './assertSingleInstance.js';\nconst PROJECT_VERSION = '0.4.150';\nconst projectInfo = {\n    projectName: 'Vike',\n    projectVersion: PROJECT_VERSION,\n    npmPackageName: 'vike',\n    githubRepository: 'https://github.com/vikejs/vike'\n};\n// Trick: since `utils/asserts.ts` depends on this file (`utils/projectInfo.ts`), we can have confidence that this file is always instantiated. So that we don't have to initialize this code snippet at every possible entry. (There are a *lot* of entries: `client/router/`, `client/`, `node/`, `node/plugin/`, `node/cli`, etc.)\nonProjectInfo(projectInfo.projectVersion);\n","const v=new Proxy((s) => s,{get:()=>v})\nexport default v\n","export { assert };\nexport { assertUsage };\nexport { assertWarning };\nexport { assertInfo };\nexport { getProjectError };\nexport { addOnBeforeLogHook };\nexport { getAssertErrMsg };\nexport { overwriteAssertProductionLogger };\nexport { isBug };\nimport { createErrorWithCleanStackTrace } from './createErrorWithCleanStackTrace.js';\nimport { getGlobalObject } from './getGlobalObject.js';\nimport { isObject } from './isObject.js';\nimport { projectInfo } from './projectInfo.js';\nimport pc from '@brillout/picocolors';\nconst globalObject = getGlobalObject('utils/assert.ts', {\n    alreadyLogged: new Set(),\n    // Production logger. Overwritten by loggerNotProd.ts in non-production environments.\n    logger(msg, logType) {\n        if (logType === 'info') {\n            console.log(msg);\n        }\n        else {\n            console.warn(msg);\n        }\n    },\n    showStackTraceList: new WeakSet()\n});\nconst projectTag = `[${projectInfo.npmPackageName}]`;\nconst projectTagWithVersion = `[${projectInfo.npmPackageName}@${projectInfo.projectVersion}]`;\nconst numberOfStackTraceLinesToRemove = 2;\nfunction assert(condition, debugInfo) {\n    if (condition)\n        return;\n    const debugStr = (() => {\n        if (!debugInfo) {\n            return null;\n        }\n        const debugInfoSerialized = typeof debugInfo === 'string' ? debugInfo : JSON.stringify(debugInfo);\n        return pc.dim(`Debug info (for ${projectInfo.projectName} maintainers; you can ignore this): ${debugInfoSerialized}`);\n    })();\n    const link = `${projectInfo.githubRepository}/issues/new`;\n    let errMsg = [\n        `You stumbled upon a bug in ${projectInfo.projectName}'s source code.`,\n        `Go to ${pc.blue(link)} and copy-paste this error; a maintainer will fix the bug (usually under 24 hours).`,\n        debugStr\n    ]\n        .filter(Boolean)\n        .join(' ');\n    errMsg = addWhitespace(errMsg);\n    errMsg = addPrefixAssertType(errMsg, 'Bug');\n    errMsg = addPrefixProjctName(errMsg, true);\n    const internalError = createErrorWithCleanStackTrace(errMsg, numberOfStackTraceLinesToRemove);\n    globalObject.onBeforeLog?.();\n    throw internalError;\n}\nfunction assertUsage(condition, errMsg, { showStackTrace } = {}) {\n    if (condition)\n        return;\n    errMsg = addWhitespace(errMsg);\n    errMsg = addPrefixAssertType(errMsg, 'Wrong Usage');\n    errMsg = addPrefixProjctName(errMsg);\n    const usageError = createErrorWithCleanStackTrace(errMsg, numberOfStackTraceLinesToRemove);\n    if (showStackTrace) {\n        globalObject.showStackTraceList.add(usageError);\n    }\n    globalObject.onBeforeLog?.();\n    throw usageError;\n}\nfunction getProjectError(errMsg) {\n    errMsg = addWhitespace(errMsg);\n    errMsg = addPrefixAssertType(errMsg, 'Error');\n    errMsg = addPrefixProjctName(errMsg);\n    const projectError = createErrorWithCleanStackTrace(errMsg, numberOfStackTraceLinesToRemove);\n    return projectError;\n}\nfunction assertWarning(condition, msg, { onlyOnce, showStackTrace }) {\n    if (condition)\n        return;\n    msg = addWhitespace(msg);\n    msg = addPrefixAssertType(msg, 'Warning');\n    msg = addPrefixProjctName(msg);\n    if (onlyOnce) {\n        const { alreadyLogged } = globalObject;\n        const key = onlyOnce === true ? msg : onlyOnce;\n        if (alreadyLogged.has(key)) {\n            return;\n        }\n        else {\n            alreadyLogged.add(key);\n        }\n    }\n    globalObject.onBeforeLog?.();\n    if (showStackTrace) {\n        const err = new Error(msg);\n        globalObject.showStackTraceList.add(err);\n        globalObject.logger(err, 'warn');\n    }\n    else {\n        globalObject.logger(msg, 'warn');\n    }\n}\nfunction assertInfo(condition, msg, { onlyOnce }) {\n    if (condition) {\n        return;\n    }\n    msg = addWhitespace(msg);\n    msg = addPrefixProjctName(msg);\n    if (onlyOnce) {\n        const { alreadyLogged } = globalObject;\n        const key = msg;\n        if (alreadyLogged.has(key)) {\n            return;\n        }\n        else {\n            alreadyLogged.add(key);\n        }\n    }\n    globalObject.onBeforeLog?.();\n    globalObject.logger(msg, 'info');\n}\nfunction addOnBeforeLogHook(onBeforeLog) {\n    globalObject.onBeforeLog = onBeforeLog;\n}\nfunction addPrefixAssertType(msg, tag) {\n    let prefix = `[${tag}]`;\n    const color = tag === 'Warning' ? 'yellow' : 'red';\n    prefix = pc.bold(pc[color](prefix));\n    return `${prefix}${msg}`;\n}\nfunction addWhitespace(msg) {\n    if (msg.startsWith('[')) {\n        return msg;\n    }\n    else {\n        return ` ${msg}`;\n    }\n}\nfunction addPrefixProjctName(msg, showProjectVersion = false) {\n    const prefix = showProjectVersion ? projectTagWithVersion : projectTag;\n    return `${prefix}${msg}`;\n}\nfunction getAssertErrMsg(thing) {\n    let errMsg;\n    let errStack = null;\n    if (typeof thing === 'string') {\n        errMsg = thing;\n    }\n    else if (isObject(thing) && typeof thing.message === 'string' && typeof thing.stack === 'string') {\n        errMsg = thing.message;\n        errStack = thing.stack;\n    }\n    else {\n        return null;\n    }\n    let assertMsg;\n    let isBug;\n    if (errMsg.startsWith(projectTag)) {\n        assertMsg = errMsg.slice(projectTag.length);\n        isBug = false;\n    }\n    else if (errMsg.startsWith(projectTagWithVersion)) {\n        assertMsg = errMsg.slice(projectTagWithVersion.length);\n        isBug = true;\n    }\n    else {\n        return null;\n    }\n    // Append stack trace\n    if (errStack && (isBug || globalObject.showStackTraceList.has(thing))) {\n        assertMsg = `${assertMsg}\\n${removeErrMsg(errStack)}`;\n    }\n    const showVikeVersion = isBug;\n    return { assertMsg, showVikeVersion };\n}\nfunction removeErrMsg(stack) {\n    if (typeof stack !== 'string')\n        return String(stack);\n    const [firstLine, ...stackLines] = stack.split('\\n');\n    if (!firstLine.startsWith('Error: '))\n        return stack;\n    return stackLines.join('\\n');\n}\nfunction overwriteAssertProductionLogger(logger) {\n    globalObject.logger = logger;\n}\nfunction isBug(err) {\n    return !String(err).includes('[Bug]');\n}\n","export function isBrowser() {\n    // Using `typeof window !== 'undefined'` alone is not enough because some users use https://www.npmjs.com/package/ssr-window\n    return typeof window !== 'undefined' && typeof window.scrollY === 'number';\n    // Alternatively, test whether environment is a *real* browser: https://github.com/brillout/picocolors/blob/d59a33a0fd52a8a33e4158884069192a89ce0113/picocolors.js#L87-L89\n}\n","export { assertClientRouting };\nexport { assertServerRouting };\nexport { checkIfClientRouting };\nimport { assertUsage, assertWarning } from './assert.js';\nimport { getGlobalObject } from './getGlobalObject.js';\nimport { isBrowser } from './isBrowser.js';\nimport pc from '@brillout/picocolors';\nconst state = getGlobalObject('utils/assertRouterType.ts', {});\nfunction assertClientRouting() {\n    assertNoContradiction(checkIfClientRouting());\n    state.isClientRouting = true;\n}\nfunction checkIfClientRouting() {\n    return state.isClientRouting !== false;\n}\nfunction assertServerRouting() {\n    assertNoContradiction(state.isClientRouting !== true);\n    state.isClientRouting = false;\n}\nfunction assertNoContradiction(noContradiction) {\n    // If an assertion fails because of a wrong usage, then we assume that the user is trying to import from 'vike/client/router' while not setting `clientRouting` to `true`. Note that 'vike/client' only exports the type `PageContextBuiltInClient` and that the package.json#exports entry 'vike/client' will eventually be removed.\n    assertUsage(isBrowser(), `${pc.cyan(\"import { something } from 'vike/client/router'\")} is forbidden on the server-side`, { showStackTrace: true });\n    assertWarning(noContradiction, \"You shouldn't `import { something } from 'vike/client/router'` when using Server Routing. The 'vike/client/router' utilities work only with Client Routing. In particular, don't `import { navigate }` nor `import { prefetch }` as they unnecessarily bloat your client-side bundle sizes.\", { showStackTrace: true, onlyOnce: true });\n}\n","export { isScriptFile };\nexport { isTemplateFile };\nexport { scriptFileExtensions };\nexport { scriptFileExtensionList };\nimport { assert } from './assert.js';\n// We can't use a RegExp:\n//  - Needs to work with Micromatch: https://github.com/micromatch/micromatch because:\n//    - Vite's `import.meta.glob()` uses Micromatch\n//  - We need this to be a whitelist because:\n//   - A pattern `*([a-zA-Z0-9]` doesn't work.\n//     - Because of ReScript: `.res` are ReScript source files which need to be ignored. (The ReScript compiler generates `.js` files alongside `.res` files.)\n//   - Black listing doesn't work.\n//     - We cannot implement a blacklist with a glob pattern.\n//     - A post `import.meta.glob()` blacklist filtering doesn't work because Vite would still process the files (e.g. including them in the bundle).\n// prettier-ignore\nconst extJavaScript = [\n    'js',\n    'ts',\n    'cjs',\n    'cts',\n    'mjs',\n    'mts',\n    'jsx',\n    'tsx',\n    'cjsx',\n    'ctsx',\n    'mjsx',\n    'mtsx',\n];\n// prettier-ignore\nconst extTemplates = [\n    'vue',\n    'svelte',\n    'marko',\n    'md',\n    'mdx'\n];\nconst scriptFileExtensionList = [...extJavaScript, ...extTemplates];\nconst scriptFileExtensions = '(' + scriptFileExtensionList.join('|') + ')';\nfunction isScriptFile(filePath) {\n    const yes = scriptFileExtensionList.some((ext) => filePath.endsWith('.' + ext));\n    assert(!isJavaScriptFile(filePath) || yes);\n    return yes;\n}\nfunction isJavaScriptFile(filePath) {\n    return /\\.(c|m)?(j|t)sx?$/.test(filePath);\n}\nfunction isTemplateFile(filePath) {\n    return extTemplates.some((ext) => filePath.endsWith('.' + ext));\n}\n","import { assert } from './assert.js';\nexport { slice };\nfunction slice(thing, from, to) {\n    if (typeof thing === 'string') {\n        return sliceArray(thing.split(''), from, to).join('');\n    }\n    else {\n        return sliceArray(thing, from, to);\n    }\n}\nfunction sliceArray(list, from, to) {\n    const listSlice = [];\n    let start = from >= 0 ? from : list.length + from;\n    assert(start >= 0 && start <= list.length);\n    let end = to >= 0 ? to : list.length + to;\n    assert(end >= 0 && end <= list.length);\n    while (true) {\n        if (start === end) {\n            break;\n        }\n        if (start === list.length) {\n            start = 0;\n        }\n        if (start === end) {\n            break;\n        }\n        const el = list[start];\n        assert(el !== undefined);\n        listSlice.push(el);\n        start++;\n    }\n    return listSlice;\n}\n","// We don't use new URL() as it doesn't exactly do what we need, for example:\n//  - It loses the original URL parts (which we need to manipulate and recreate URLs)\n//  - It doesn't support the tauri:// protocol\n// Unit tests at ./parseUrl.spec.ts\nexport { parseUrl };\nexport { isParsable };\nexport { assertUsageUrl };\nexport { isBaseServer };\nexport { assertUrlComponents };\nexport { createUrlFromComponents };\nimport { slice } from './slice.js';\nimport { assert, assertUsage } from './assert.js';\nimport pc from '@brillout/picocolors';\nconst PROTOCOLS = ['http://', 'https://', 'tauri://'];\nfunction isParsable(url) {\n    // `parseUrl()` works with these URLs\n    return (PROTOCOLS.some((p) => url.startsWith(p)) ||\n        url.startsWith('/') ||\n        url.startsWith('.') ||\n        url.startsWith('?') ||\n        url.startsWith('#') ||\n        url === '');\n}\nfunction assertUsageUrl(url, errPrefix) {\n    assert(errPrefix.includes(' but '));\n    assertUsage(typeof url === 'string', `${errPrefix} should be a string`);\n    if (isParsable(url))\n        return;\n    if (!url.startsWith('/') && !url.includes(':')) {\n        assertUsage(false, `${errPrefix} is ${pc.cyan(url)} and it should be /${pc.cyan(url)} instead (URL pathnames should start with a leading slash)`);\n    }\n    else {\n        assertUsage(false, `${errPrefix} isn't a valid URL`);\n    }\n}\nfunction parseUrl(url, baseServer) {\n    assert(isParsable(url));\n    assert(baseServer.startsWith('/'));\n    // Hash\n    const [urlWithoutHash, ...hashList] = url.split('#');\n    assert(urlWithoutHash !== undefined);\n    const hashOriginal = ['', ...hashList].join('#') || null;\n    assert(hashOriginal === null || hashOriginal.startsWith('#'));\n    const hash = hashOriginal === null ? '' : decodeSafe(hashOriginal.slice(1));\n    // Search\n    const [urlWithoutHashNorSearch, ...searchList] = urlWithoutHash.split('?');\n    assert(urlWithoutHashNorSearch !== undefined);\n    const searchOriginal = ['', ...searchList].join('?') || null;\n    assert(searchOriginal === null || searchOriginal.startsWith('?'));\n    const search = {};\n    const searchAll = {};\n    Array.from(new URLSearchParams(searchOriginal || '')).forEach(([key, val]) => {\n        search[key] = val;\n        searchAll[key] = [...(searchAll.hasOwnProperty(key) ? searchAll[key] : []), val];\n    });\n    // Origin + pathname\n    const { origin, pathname: pathnameResolved } = getPathname(urlWithoutHashNorSearch, baseServer);\n    assert(origin === null || origin === decodeSafe(origin)); // AFAICT decoding the origin is useless\n    assert(pathnameResolved.startsWith('/'));\n    assert(origin === null || url.startsWith(origin));\n    // `pathnameOriginal`\n    const pathnameOriginal = urlWithoutHashNorSearch.slice((origin || '').length);\n    assertUrlComponents(url, origin, pathnameOriginal, searchOriginal, hashOriginal);\n    // Base URL\n    let { pathname, hasBaseServer } = analyzeBaseServer(pathnameResolved, baseServer);\n    pathname = decodePathname(pathname);\n    assert(pathname.startsWith('/'));\n    return {\n        origin,\n        pathname,\n        pathnameOriginal: pathnameOriginal,\n        hasBaseServer,\n        search,\n        searchAll,\n        searchOriginal,\n        hash,\n        hashOriginal\n    };\n}\nfunction decodeSafe(urlComponent) {\n    try {\n        return decodeURIComponent(urlComponent);\n    }\n    catch { }\n    try {\n        return decodeURI(urlComponent);\n    }\n    catch { }\n    return urlComponent;\n}\nfunction decodePathname(urlPathname) {\n    urlPathname = urlPathname.replace(/\\s+$/, '');\n    urlPathname = urlPathname\n        .split('/')\n        .map((dir) => decodeSafe(dir).split('/').join('%2F'))\n        .join('/');\n    return urlPathname;\n}\nfunction getPathname(url, baseServer) {\n    // Search and hash already extracted\n    assert(!url.includes('?') && !url.includes('#'));\n    // url has origin\n    {\n        const { origin, pathname } = parseOrigin(url);\n        if (origin) {\n            return { origin, pathname };\n        }\n        assert(pathname === url);\n    }\n    // url doesn't have origin\n    if (url.startsWith('/')) {\n        return { origin: null, pathname: url };\n    }\n    else {\n        // url is a relative path\n        // In the browser, this is the Base URL of the current URL.\n        // Safe access `window?.document?.baseURI` for users who shim `window` in Node.js\n        const baseURI = typeof window !== 'undefined' ? window?.document?.baseURI : undefined;\n        let base;\n        if (baseURI) {\n            const baseURIPathaname = parseOrigin(baseURI.split('?')[0]).pathname;\n            base = baseURIPathaname;\n        }\n        else {\n            base = baseServer;\n        }\n        const pathname = resolveUrlPathnameRelative(url, base);\n        return { origin: null, pathname };\n    }\n}\nfunction parseOrigin(url) {\n    if (!PROTOCOLS.some((protocol) => url.startsWith(protocol))) {\n        return { pathname: url, origin: null };\n    }\n    else {\n        const [originPart1, originPart2, originPart3, ...pathnameParts] = url.split('/');\n        const origin = [originPart1, originPart2, originPart3].join('/');\n        const pathname = ['', ...pathnameParts].join('/') || '/';\n        return { origin, pathname };\n    }\n}\n// Adapted from https://stackoverflow.com/questions/14780350/convert-relative-path-to-absolute-using-javascript/14780463#14780463\nfunction resolveUrlPathnameRelative(pathnameRelative, base) {\n    const stack = base.split('/');\n    const parts = pathnameRelative.split('/');\n    let baseRestoreTrailingSlash = base.endsWith('/');\n    if (pathnameRelative.startsWith('.')) {\n        // remove current file name\n        stack.pop();\n    }\n    for (const i in parts) {\n        const p = parts[i];\n        if (p == '' && i === '0')\n            continue;\n        if (p == '.')\n            continue;\n        if (p == '..')\n            stack.pop();\n        else {\n            baseRestoreTrailingSlash = false;\n            stack.push(p);\n        }\n    }\n    let pathnameAbsolute = stack.join('/');\n    if (baseRestoreTrailingSlash && !pathnameAbsolute.endsWith('/'))\n        pathnameAbsolute += '/';\n    if (!pathnameAbsolute.startsWith('/'))\n        pathnameAbsolute = '/' + pathnameAbsolute;\n    return pathnameAbsolute;\n}\n/* Not needed anymore?\nfunction assertUsageBaseServer(baseServer: string, usageErrorMessagePrefix: string = '') {\n  assertUsage(\n    !baseServer.startsWith('http'),\n    usageErrorMessagePrefix +\n      '`base` is not allowed to start with `http`. Consider using `baseAssets` instead, see https://vike.dev/base-url'\n  )\n  assertUsage(\n    baseServer.startsWith('/'),\n    usageErrorMessagePrefix + 'Wrong `base` value `' + baseServer + '`; `base` should start with `/`.'\n  )\n  assert(isBaseServer(baseServer))\n}\n*/\nfunction assertPathname(urlPathname) {\n    assert(urlPathname.startsWith('/'));\n    assert(!urlPathname.includes('?'));\n    assert(!urlPathname.includes('#'));\n}\nfunction analyzeBaseServer(urlPathnameWithBase, baseServer) {\n    assertPathname(urlPathnameWithBase);\n    assert(isBaseServer(baseServer));\n    // Mutable\n    let urlPathname = urlPathnameWithBase;\n    assert(urlPathname.startsWith('/'));\n    assert(baseServer.startsWith('/'));\n    if (baseServer === '/') {\n        const pathname = urlPathnameWithBase;\n        return { pathname, hasBaseServer: true };\n    }\n    // Support `url === '/some-base-url' && baseServer === '/some-base-url/'`\n    let baseServerNormalized = baseServer;\n    if (baseServer.endsWith('/') && urlPathname === slice(baseServer, 0, -1)) {\n        baseServerNormalized = slice(baseServer, 0, -1);\n        assert(urlPathname === baseServerNormalized);\n    }\n    if (!urlPathname.startsWith(baseServerNormalized)) {\n        const pathname = urlPathnameWithBase;\n        return { pathname, hasBaseServer: false };\n    }\n    assert(urlPathname.startsWith('/') || urlPathname.startsWith('http'));\n    assert(urlPathname.startsWith(baseServerNormalized));\n    urlPathname = urlPathname.slice(baseServerNormalized.length);\n    if (!urlPathname.startsWith('/'))\n        urlPathname = '/' + urlPathname;\n    assert(urlPathname.startsWith('/'));\n    return { pathname: urlPathname, hasBaseServer: true };\n}\nfunction isBaseServer(baseServer) {\n    return baseServer.startsWith('/');\n}\nfunction assertUrlComponents(url, origin, pathname, searchOriginal, hashOriginal) {\n    const urlRecreated = createUrlFromComponents(origin, pathname, searchOriginal, hashOriginal);\n    assert(url === urlRecreated);\n}\nfunction createUrlFromComponents(origin, pathname, searchOriginal, hashOriginal) {\n    const urlRecreated = `${origin || ''}${pathname}${searchOriginal || ''}${hashOriginal || ''}`;\n    return urlRecreated;\n}\n","export { objectAssign };\n// Same as Object.assign() but:\n//  - With type inference\n//  - Preserves property descriptors, which we need for preserving the getters added by addUrlComputedProps()\nfunction objectAssign(obj, objAddendum) {\n    if (objAddendum) {\n        Object.defineProperties(obj, Object.getOwnPropertyDescriptors(objAddendum));\n    }\n}\n","export function isCallable(thing) {\n    return thing instanceof Function || typeof thing === 'function';\n}\n","import { assert } from './assert.js';\nexport { higherFirst };\nexport { lowerFirst };\nexport { makeFirst };\nexport { makeLast };\n// -1 => element1 first (i.e. `indexOf(element1) < indexOf(element2)`)\n// +1 => element2 first (i.e. `indexOf(element2) < indexOf(element1)`)\n// 0 => keep original order of element1 and element2\nfunction higherFirst(getValue) {\n    return (element1, element2) => {\n        const val1 = getValue(element1);\n        const val2 = getValue(element2);\n        if (val1 === val2) {\n            return 0;\n        }\n        return val1 > val2 ? -1 : 1;\n    };\n}\nfunction lowerFirst(getValue) {\n    return (element1, element2) => {\n        const val1 = getValue(element1);\n        const val2 = getValue(element2);\n        if (val1 === val2) {\n            return 0;\n        }\n        return val1 < val2 ? -1 : 1;\n    };\n}\nfunction makeFirst(getValue) {\n    return (element1, element2) => {\n        const val1 = getValue(element1);\n        const val2 = getValue(element2);\n        assert([true, false, null].includes(val1));\n        assert([true, false, null].includes(val2));\n        if (val1 === val2) {\n            return 0;\n        }\n        if (val1 === true || val2 === false) {\n            return -1;\n        }\n        if (val2 === true || val1 === false) {\n            return 1;\n        }\n        assert(false);\n    };\n}\nfunction makeLast(getValue) {\n    return makeFirst((element) => {\n        const val = getValue(element);\n        if (val === null) {\n            return null;\n        }\n        else {\n            return !val;\n        }\n    });\n}\n","export { hasProp };\n// - https://2ality.com/2020/06/type-guards-assertion-functions-typescript.html\n// - https://www.typescriptlang.org/play?#code/GYVwdgxgLglg9mABDAzgFQJ4AcCmdgAUAbgIYA2IOAXIiWBgDSJTbWIDkARnHGTnewCUNUhRzIUibr35gA3AFgAUKEiwEEzLnzFylGnUbNWNdmBABbTjgBOQkXvGpE5q7cUrw0eElRa8hKL6tPRMLLimKFA2MGAA5vaIQU6SUTHxHqreGn6sOskGocYRHOAA1mBwAO5gickSiOWVNZle6r7oeYGOhUbhbGmxcYgAvKVgFdW1wlI8fHSIAN7KiMiExeIjW+OTNeyIgksrq4g2OFAgNkjRlMcAvsdnF1cb+EmOo9v9Hg9KyhAIKK0GhNKajRAAFgATMplCQUChbFACLltIQSEwzJZrHZBIJ-oCZAA6MhwOIEEj4v6eNQ+WgIpEEAFgAAmMHaIImzTAM3hiJsUEkzLZ7SOShOa0QTIQIp8hyelzAx1WUAAFjZqi4cFVEABRGwamwEdgAQQZArpADESDAyEJlHcgA\nimport { isCallable } from './isCallable.js';\nimport { isObject } from './isObject.js';\n// prettier-ignore\nfunction hasProp(obj, prop, type = 'unknown') {\n    if (!isObject(obj))\n        return false;\n    if (!(prop in obj)) {\n        return type === 'undefined';\n    }\n    if (type === 'unknown') {\n        return true;\n    }\n    const propValue = obj[prop];\n    if (type === 'array') {\n        return Array.isArray(propValue);\n    }\n    if (type === 'object') {\n        return isObject(propValue);\n    }\n    if (type === 'string[]') {\n        return Array.isArray(propValue) && propValue.every(el => typeof el === 'string');\n    }\n    if (type === 'function') {\n        return isCallable(propValue);\n    }\n    if (Array.isArray(type)) {\n        return typeof propValue === 'string' && type.includes(propValue);\n    }\n    if (type === 'null') {\n        return propValue === null;\n    }\n    if (type === 'undefined') {\n        return propValue === undefined;\n    }\n    if (type === 'true') {\n        return propValue === true;\n    }\n    if (type === 'false') {\n        return propValue === false;\n    }\n    return typeof propValue === type;\n}\n","export { isPlainObject };\nfunction isPlainObject(value) {\n    if (typeof value !== 'object' || value === null) {\n        return false;\n    }\n    // Support `Object.create(null)`\n    if (Object.getPrototypeOf(value) === null) {\n        return true;\n    }\n    return (\n    /* Doesn't work in Cloudlfare Pages workers\n    value.constructor === Object\n    */\n    value.constructor.name === 'Object');\n}\n","export { compareString };\nfunction compareString(str1, str2) {\n    if (str1.toLowerCase() < str2.toLowerCase())\n        return -1;\n    if (str1.toLowerCase() > str2.toLowerCase())\n        return 1;\n    return 0;\n}\n","export const isNotNullish = (p) => p !== null && p !== undefined;\n","export { stringifyStringArray };\nfunction stringifyStringArray(stringList) {\n    return '[' + stringList.map((str) => \"'\" + str + \"'\").join(', ') + ']';\n}\n","export { toPosixPath };\nexport { assertPosixPath };\nimport { assert } from './assert.js';\nfunction toPosixPath(path) {\n    const pathPosix = path.split('\\\\').join('/');\n    assertPosixPath(pathPosix);\n    return pathPosix;\n}\nfunction assertPosixPath(path) {\n    const errMsg = (msg) => `Not a posix path: ${msg}`;\n    assert(path !== null, errMsg('null'));\n    assert(typeof path === 'string', errMsg(`typeof path === ${JSON.stringify(typeof path)}`));\n    assert(path !== '', errMsg('(empty string)'));\n    assert(path);\n    assert(!path.includes('\\\\'), errMsg(path));\n}\n","export function isPropertyGetter(obj, prop) {\n    const descriptor = Object.getOwnPropertyDescriptor(obj, prop);\n    return !!descriptor && !('value' in descriptor) && !!descriptor.get;\n}\n","import { isCallable } from './isCallable.js';\nexport function isPromise(val) {\n    return typeof val === 'object' && val !== null && 'then' in val && isCallable(val.then);\n}\n","export function getValuePrintable(value) {\n    if ([null, undefined].includes(value))\n        return String(value);\n    if (['boolean', 'number', 'string'].includes(typeof value))\n        return JSON.stringify(value);\n    return null;\n}\n","export function escapeRegex(str) {\n    // https://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript/3561711#3561711\n    return str.replace(/[/\\-\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n}\n","// TODO/v1-release: remove this\nexport { assertDefaultExports };\nexport { assertExportValues };\nexport { forbiddenDefaultExports };\nimport { assert, assertUsage } from '../utils.js';\nconst enforceTrue = ['clientRouting'];\nfunction assertExportValues(pageFile) {\n    enforceTrue.forEach((exportName) => {\n        assert(pageFile.fileExports);\n        if (!(exportName in pageFile.fileExports))\n            return;\n        const explainer = `The value of \\`${exportName}\\` is only allowed to be \\`true\\`.`;\n        assertUsage(pageFile.fileExports[exportName] !== false, `${pageFile.filePath} has \\`export { ${exportName} }\\` with the value \\`false\\` which is prohibited: remove \\`export { ${exportName} }\\` instead. (${explainer})`);\n        assertUsage(pageFile.fileExports[exportName] === true, `${pageFile.filePath} has \\`export { ${exportName} }\\` with a forbidden value. ${explainer}`);\n    });\n}\n// Forbid exports such as `export default { render }`, because only `export { render }` can be statically analyzed by `es-module-lexer`.\nconst forbiddenDefaultExports = ['render', 'clientRouting', 'prerender', 'doNotPrerender'];\nfunction assertDefaultExports(defaultExportName, filePath) {\n    assertUsage(!forbiddenDefaultExports.includes(defaultExportName), `${filePath} has \\`export default { ${defaultExportName} }\\` which is prohibited, use \\`export { ${defaultExportName} }\\` instead.`);\n}\n","export { getExportPath };\nimport { assert } from '../utils.js';\nfunction getExportPath(fileExportPathToShowToUser, configName) {\n    if (!fileExportPathToShowToUser)\n        return null;\n    let [exportName, ...exportObjectPath] = fileExportPathToShowToUser;\n    if (!exportName)\n        return null;\n    if (exportObjectPath.length === 0 && ['*', 'default', configName].includes(exportName))\n        return null;\n    assert(exportName !== '*');\n    let prefix = '';\n    let suffix = '';\n    if (exportName === 'default') {\n        prefix = 'export default';\n    }\n    else {\n        prefix = 'export';\n        exportObjectPath = [exportName, ...exportObjectPath];\n    }\n    exportObjectPath.forEach((prop) => {\n        prefix = `${prefix} { ${prop}`;\n        suffix = ` }${suffix}`;\n    });\n    const exportPath = prefix + suffix;\n    return exportPath;\n}\n","export { getConfigDefinedAtString };\nexport { getDefinedAtString };\nimport { assert } from '../../utils.js';\nimport pc from '@brillout/picocolors';\nimport { getExportPath } from '../getExportPath.js';\nfunction getConfigDefinedAtString(sentenceBegin, configName, { definedAt }) {\n    const definedAtString = getDefinedAtString(definedAt, configName);\n    const definedAtStr = definedAtString === 'internally' ? definedAtString : `at ${definedAtString}`;\n    let configNameStr = `${configName}${ /*sentenceBegin === 'Hook' ? '()' :*/''}`;\n    const configDefinedAt = `${sentenceBegin} ${pc.cyan(configNameStr)} defined ${definedAtStr}`;\n    return configDefinedAt;\n}\nfunction getDefinedAtString(definedAt, configName) {\n    if ('isComputed' in definedAt) {\n        return 'internally';\n    }\n    let files;\n    if ('files' in definedAt) {\n        files = definedAt.files;\n    }\n    else {\n        files = [definedAt];\n    }\n    assert(files.length >= 1);\n    const definedAtString = files\n        .map((source) => {\n        const { filePathToShowToUser, fileExportPathToShowToUser } = source;\n        let s = filePathToShowToUser;\n        const exportPath = getExportPath(fileExportPathToShowToUser, configName);\n        if (exportPath) {\n            s = `${s} > ${pc.cyan(exportPath)}`;\n        }\n        return s;\n    })\n        .join(' / ');\n    return definedAtString;\n}\n","export { getConfigValue };\nimport { assert, assertUsage, getValuePrintable } from '../../utils.js';\nimport pc from '@brillout/picocolors';\nimport { getConfigDefinedAtString } from './getConfigDefinedAtString.js';\n// prettier-ignore\nfunction getConfigValue(pageConfig, configName, type) {\n    const configValue = getConfigValueEntry(pageConfig, configName);\n    if (configValue === null)\n        return null;\n    const { value, definedAt } = configValue;\n    if (type)\n        assertConfigValueType(value, type, configName, definedAt);\n    return configValue;\n}\nfunction assertConfigValueType(value, type, configName, definedAt) {\n    assert(value !== null);\n    const typeActual = typeof value;\n    if (typeActual === type)\n        return;\n    const valuePrintable = getValuePrintable(value);\n    const problem = valuePrintable !== null\n        ? `value ${pc.cyan(valuePrintable)}`\n        : `type ${pc.cyan(typeActual)}`;\n    const configDefinedAt = getConfigDefinedAtString('Config', configName, {\n        definedAt\n    });\n    const errMsg = `${configDefinedAt} has an invalid ${problem}: it should be a ${pc.cyan(type)} instead`;\n    assertUsage(false, errMsg);\n}\nfunction getConfigValueEntry(pageConfig, configName) {\n    const configValue = pageConfig.configValues[configName];\n    if (!configValue)\n        return null;\n    // Enable users to suppress global config values by setting the local config value to null\n    if (configValue.value === null)\n        return null;\n    return configValue;\n}\n","export { getPageConfig };\nexport { getConfigValueFilePathToShowToUser };\nexport { getHookFilePathToShowToUser };\nexport { getConfigDefinedAtString, getDefinedAtString } from './helpers/getConfigDefinedAtString.js';\nexport { getConfigValue } from './helpers/getConfigValue.js';\nimport { assert } from '../utils.js';\nfunction getPageConfig(pageId, pageConfigs) {\n    const pageConfig = pageConfigs.find((p) => p.pageId === pageId);\n    assert(pageConfigs.length > 0);\n    assert(pageConfig);\n    return pageConfig;\n}\nfunction getConfigValueFilePathToShowToUser({ definedAt }) {\n    // A unique file path only exists if the config value isn't cumulative nor computed:\n    //  - cumulative config values have multiple file paths\n    //  - computed values don't have any file path\n    if ('isComputed' in definedAt || 'files' in definedAt)\n        return null;\n    const { filePathToShowToUser } = definedAt;\n    assert(filePathToShowToUser);\n    return filePathToShowToUser;\n}\nfunction getHookFilePathToShowToUser({ definedAt }) {\n    const filePathToShowToUser = getConfigValueFilePathToShowToUser({ definedAt });\n    assert(filePathToShowToUser);\n    return filePathToShowToUser;\n}\n","export { getExportUnion };\nexport { getExports };\nimport { isScriptFile, isTemplateFile } from '../../utils/isScriptFile.js';\nimport { assert, hasProp, isObject, assertWarning, assertUsage, makeLast, isBrowser } from '../utils.js';\nimport { assertDefaultExports, forbiddenDefaultExports } from './assert_exports_old_design.js';\nimport { getConfigDefinedAtString, getConfigValueFilePathToShowToUser } from '../page-configs/helpers.js';\nimport pc from '@brillout/picocolors';\nfunction getExports(pageFiles, pageConfig) {\n    const configEntries = {};\n    const config = {};\n    const exportsAll = {};\n    // V0.4 design\n    // TODO/v1-release: remove\n    pageFiles.forEach((pageFile) => {\n        const exportValues = getExportValues(pageFile);\n        exportValues.forEach(({ exportName, exportValue, isFromDefaultExport }) => {\n            assert(exportName !== 'default');\n            exportsAll[exportName] = exportsAll[exportName] ?? [];\n            exportsAll[exportName].push({\n                exportValue,\n                exportSource: `${pageFile.filePath} > ${isFromDefaultExport ? `\\`export default { ${exportName} }\\`` : `\\`export { ${exportName} }\\``}`,\n                filePath: pageFile.filePath,\n                _filePath: pageFile.filePath,\n                _fileType: pageFile.fileType,\n                _isFromDefaultExport: isFromDefaultExport\n            });\n        });\n    });\n    // V1 design\n    if (pageConfig) {\n        Object.entries(pageConfig.configValues).forEach(([configName, configValue]) => {\n            const { value } = configValue;\n            const configValueFilePathToShowToUser = getConfigValueFilePathToShowToUser(configValue);\n            const configDefinedAt = getConfigDefinedAtString('Config', configName, configValue);\n            config[configName] = config[configName] ?? value;\n            configEntries[configName] = configEntries[configName] ?? [];\n            // Currently each configName has only one entry. Adding an entry for each overriden config value isn't implemented yet. (This is an isomorphic file and it isn't clear whether this can/should be implemented on the client-side. We should load a minimum amount of code on the client-side.)\n            assert(configEntries[configName].length === 0);\n            configEntries[configName].push({\n                configValue: value,\n                configDefinedAt,\n                configDefinedByFile: configValueFilePathToShowToUser\n            });\n            // TODO/v1-release: remove\n            const exportName = configName;\n            exportsAll[exportName] = exportsAll[exportName] ?? [];\n            exportsAll[exportName].push({\n                exportValue: value,\n                exportSource: configDefinedAt,\n                filePath: configValueFilePathToShowToUser,\n                _filePath: configValueFilePathToShowToUser,\n                _fileType: null,\n                _isFromDefaultExport: null\n            });\n        });\n    }\n    const pageExports = createObjectWithDeprecationWarning();\n    const exports = {};\n    Object.entries(exportsAll).forEach(([exportName, values]) => {\n        values.forEach(({ exportValue, _fileType, _isFromDefaultExport }) => {\n            exports[exportName] = exports[exportName] ?? exportValue;\n            // Legacy pageContext.pageExports\n            if (_fileType === '.page' && !_isFromDefaultExport) {\n                if (!(exportName in pageExports)) {\n                    pageExports[exportName] = exportValue;\n                }\n            }\n        });\n    });\n    assert(!('default' in exports));\n    assert(!('default' in exportsAll));\n    return {\n        config,\n        configEntries,\n        // TODO/v1-release: remove\n        exports,\n        exportsAll,\n        pageExports\n    };\n}\nfunction getExportValues(pageFile) {\n    const { filePath, fileExports } = pageFile;\n    assert(fileExports); // assume pageFile.loadFile() was called\n    assert(isScriptFile(filePath));\n    const exportValues = [];\n    Object.entries(fileExports)\n        .sort(makeLast(([exportName]) => exportName === 'default')) // `export { bla }` should override `export default { bla }`\n        .forEach(([exportName, exportValue]) => {\n        let isFromDefaultExport = exportName === 'default';\n        if (isFromDefaultExport) {\n            if (isTemplateFile(filePath)) {\n                exportName = 'Page';\n            }\n            else {\n                assertUsage(isObject(exportValue), `The ${pc.cyan('export default')} of ${filePath} should be an object.`);\n                Object.entries(exportValue).forEach(([defaultExportName, defaultExportValue]) => {\n                    assertDefaultExports(defaultExportName, filePath);\n                    exportValues.push({\n                        exportName: defaultExportName,\n                        exportValue: defaultExportValue,\n                        isFromDefaultExport\n                    });\n                });\n                return;\n            }\n        }\n        exportValues.push({\n            exportName,\n            exportValue,\n            isFromDefaultExport\n        });\n    });\n    exportValues.forEach(({ exportName, isFromDefaultExport }) => {\n        assert(!(isFromDefaultExport && forbiddenDefaultExports.includes(exportName)));\n    });\n    return exportValues;\n}\n// TODO/v1-release: remove\nfunction createObjectWithDeprecationWarning() {\n    return new Proxy({}, {\n        get(...args) {\n            // We only show the warning in Node.js because when using Client Routing Vue integration uses `Object.assign(pageContextReactive, pageContext)` which will wrongully trigger the warning. There is no cross-browser way to catch whether the property accessor was initiated by an `Object.assign()` call.\n            if (!isBrowser()) {\n                assertWarning(false, '`pageContext.pageExports` is outdated. Use `pageContext.exports` instead, see https://vike.dev/exports', { onlyOnce: true, showStackTrace: true });\n            }\n            return Reflect.get(...args);\n        }\n    });\n}\nfunction getExportUnion(exportsAll, propName) {\n    return (exportsAll[propName]\n        ?.map((e) => {\n        assertUsage(hasProp(e, 'exportValue', 'string[]'), `${e.exportSource} should be an array of strings.`);\n        return e.exportValue;\n    })\n        .flat() ?? []);\n}\n","export { determinePageIdOld };\nimport { slice, assert } from './utils.js';\n// TODO/v1-release: remove\nfunction determinePageIdOld(filePath) {\n    const pageSuffix = '.page.';\n    const pageId = slice(filePath.split(pageSuffix), 0, -1).join(pageSuffix);\n    assert(!pageId.includes('\\\\'));\n    return pageId;\n}\n","// TODO/v1-release: remove\nexport { assertPageFilePath };\nimport { assertPosixPath } from './utils.js';\nfunction assertPageFilePath(filePath) {\n    assertPosixPath(filePath);\n    /* This assert() is skipped to reduce client-side bundle size\n    assert(filePath.startsWith('/') || isNpmPackageImport(filePath), { filePath })\n    */\n}\n","export { getErrorPageId };\nexport { isErrorPageId };\nexport { isErrorPage };\n// TODO/v1-release: consider loading this file only for Client Routing\nimport { assert, assertUsage, unique } from './utils.js';\nfunction getErrorPageId(pageFilesAll, pageConfigs) {\n    if (pageConfigs.length > 0) {\n        const errorPageConfigs = pageConfigs.filter((p) => p.isErrorPage);\n        if (errorPageConfigs.length === 0)\n            return null;\n        assertUsage(errorPageConfigs.length === 1, 'Only one error page can be defined');\n        return errorPageConfigs[0].pageId;\n    }\n    // TODO/v1-release: remove\n    const errorPageIds = unique(pageFilesAll.map(({ pageId }) => pageId).filter((pageId) => isErrorPageId(pageId, false)));\n    assertUsage(errorPageIds.length <= 1, `Only one _error.page.js is allowed, but found several: ${errorPageIds.join(' ')}`);\n    if (errorPageIds.length > 0) {\n        const errorPageId = errorPageIds[0];\n        assert(errorPageId);\n        return errorPageId;\n    }\n    return null;\n}\n// TODO/v1-release: remove\nfunction isErrorPageId(pageId, _isV1Design) {\n    assert(!pageId.includes('\\\\'));\n    return pageId.includes('/_error');\n}\nfunction isErrorPage(pageId, pageConfigs) {\n    if (pageConfigs.length > 0) {\n        const pageConfig = pageConfigs.find((p) => p.pageId === pageId);\n        assert(pageConfig);\n        return !!pageConfig.isErrorPage;\n    }\n    else {\n        return isErrorPageId(pageId, false);\n    }\n}\n","// TODO/v1-release: remove\nexport { fileTypes };\nexport { isValidFileType };\nexport { determineFileType };\nimport { assert, assertPosixPath } from '../utils.js';\nimport { isScriptFile } from '../../utils/isScriptFile.js';\nconst fileTypes = [\n    '.page',\n    '.page.server',\n    '.page.route',\n    '.page.client',\n    // New type `.page.css`/`.page.server.css`/`.page.client.css` for `extensions[number].pageFileDist`.\n    //  - Extensions using `pageFileDist` are expected to use a bundler that generates a `.css` colocated next to the original `.page.js` file (e.g. `/renderer/_default.page.server.css` for `/renderer/_default.page.server.js`.\n    //  - Since these `.page.css` files Bundlers We can therefore expect that there isn't any `.page.server.sass`/...\n    '.css'\n];\nfunction isValidFileType(filePath) {\n    return ['.js', '.mjs', '.cjs', '.css'].some((ext) => filePath.endsWith(ext));\n}\nfunction determineFileType(filePath) {\n    assertPosixPath(filePath);\n    {\n        const isCSS = filePath.endsWith('.css');\n        if (isCSS) {\n            /* This assert() is skipped to reduce client-side bundle size\n            assert(isNpmPackageImport(filePath), filePath) // `.css` page files are only supported for npm packages\n            */\n            return '.css';\n        }\n    }\n    assert(isScriptFile(filePath), filePath);\n    const fileName = filePath.split('/').slice(-1)[0];\n    const parts = fileName.split('.');\n    const suffix1 = parts.slice(-3)[0];\n    const suffix2 = parts.slice(-2)[0];\n    if (suffix2 === 'page') {\n        return '.page';\n    }\n    assert(suffix1 === 'page', filePath);\n    if (suffix2 === 'server') {\n        return '.page.server';\n    }\n    if (suffix2 === 'client') {\n        return '.page.client';\n    }\n    if (suffix2 === 'route') {\n        return '.page.route';\n    }\n    assert(false, filePath);\n}\n","// TODO/v1-release: remove\nexport { getPageFileObject };\nimport { determinePageIdOld } from '../determinePageIdOld.js';\nimport { assertPageFilePath } from '../assertPageFilePath.js';\nimport { isErrorPageId } from '../error-page.js';\nimport { assert, slice } from '../utils.js';\nimport { determineFileType } from './fileTypes.js';\nfunction getPageFileObject(filePath) {\n    const isRelevant = (pageId) => pageFile.pageId === pageId ||\n        (pageFile.isDefaultPageFile &&\n            (isRendererFilePath(pageFile.filePath) || isAncestorDefaultPage(pageId, pageFile.filePath)));\n    const fileType = determineFileType(filePath);\n    const isEnv = (env) => {\n        assert(fileType !== '.page.route'); // We can't determine `.page.route.js`\n        if (env === 'CLIENT_ONLY') {\n            return fileType === '.page.client' || fileType === '.css';\n        }\n        if (env === 'SERVER_ONLY') {\n            return fileType === '.page.server';\n        }\n        if (env === 'CLIENT_AND_SERVER') {\n            return fileType === '.page';\n        }\n        assert(false);\n    };\n    const pageFile = {\n        filePath,\n        fileType,\n        isEnv,\n        isRelevant,\n        isDefaultPageFile: isDefaultFilePath(filePath),\n        isRendererPageFile: fileType !== '.css' && isDefaultFilePath(filePath) && isRendererFilePath(filePath),\n        isErrorPageFile: isErrorPageId(filePath, false),\n        pageId: determinePageIdOld(filePath)\n    };\n    return pageFile;\n}\nfunction isDefaultFilePath(filePath) {\n    assertPageFilePath(filePath);\n    if (isErrorPageId(filePath, false)) {\n        return false;\n    }\n    return filePath.includes('/_default');\n}\nfunction isRendererFilePath(filePath) {\n    assertPageFilePath(filePath);\n    return filePath.includes('/renderer/');\n}\nfunction isAncestorDefaultPage(pageId, defaultPageFilePath) {\n    assertPageFilePath(pageId);\n    assertPageFilePath(defaultPageFilePath);\n    assert(!pageId.endsWith('/'));\n    assert(!defaultPageFilePath.endsWith('/'));\n    assert(isDefaultFilePath(defaultPageFilePath));\n    const defaultPageDir = slice(defaultPageFilePath.split('/'), 0, -1)\n        .filter((filePathSegment) => filePathSegment !== '_default')\n        .join('/');\n    return pageId.startsWith(defaultPageDir);\n}\n","export { assertPageConfigsSerialized };\nexport { assertPageConfigGlobalSerialized };\nimport { assert, isObject, hasProp } from '../../utils.js';\nfunction assertPageConfigsSerialized(pageConfigsSerialized) {\n    assert(Array.isArray(pageConfigsSerialized));\n    pageConfigsSerialized.forEach((pageConfigSerialized) => {\n        assert(isObject(pageConfigSerialized));\n        assert(hasProp(pageConfigSerialized, 'pageId', 'string'));\n        assert(hasProp(pageConfigSerialized, 'routeFilesystem'));\n        assert(hasProp(pageConfigSerialized, 'configValuesSerialized'));\n        assert(hasProp(pageConfigSerialized, 'configValuesImported'));\n    });\n}\nfunction assertPageConfigGlobalSerialized(pageConfigGlobalSerialized) {\n    assert(hasProp(pageConfigGlobalSerialized, 'configValuesImported'));\n}\n","export { assertExportsOfValueFile };\nexport { assertExportsOfConfigFile };\nimport { assert, assertUsage, assertWarning, isObject } from '../utils.js';\nimport pc from '@brillout/picocolors';\nconst EXPORTS_IGNORE = [\n    // vite-plugin-solid adds `export { $$registrations }`\n    '$$registrations',\n    // @vitejs/plugin-vue adds `export { _rerender_only }`\n    '_rerender_only'\n];\n// Tolerate `export { frontmatter }` in .mdx files\nconst TOLERATE_SIDE_EXPORTS = ['.md', '.mdx'];\nfunction assertExportsOfValueFile(fileExports, filePathToShowToUser, configName) {\n    assertExports(fileExports, filePathToShowToUser, configName);\n}\nfunction assertExportsOfConfigFile(fileExports, filePathToShowToUser) {\n    assertExports(fileExports, filePathToShowToUser);\n    const exportDefault = fileExports.default;\n    assertUsage(isObject(exportDefault), `The ${pc.cyan('export default')} of ${filePathToShowToUser} should be an object (but it's ${pc.cyan(`typeof exportDefault === ${JSON.stringify(typeof exportDefault)}`)} instead)`);\n}\nfunction assertExports(fileExports, filePathToShowToUser, configName) {\n    const exportsAll = Object.keys(fileExports);\n    const exportsRelevant = exportsAll.filter((exportName) => !EXPORTS_IGNORE.includes(exportName));\n    const exportsInvalid = exportsRelevant.filter((e) => e !== 'default' &&\n        // !!configName => isValueFile\n        e !== configName);\n    if (exportsInvalid.length === 0) {\n        if (exportsRelevant.length === 1) {\n            return;\n        }\n        const exportDefault = pc.cyan('export default');\n        const exportConfigName = pc.cyan(`export { ${configName} }`);\n        if (exportsRelevant.length === 0) {\n            let errMsg = `${filePathToShowToUser} doesn't export any value, but it should have a ${exportDefault}`;\n            if (configName)\n                errMsg += ` or ${exportConfigName}`;\n            assertUsage(false, errMsg);\n        }\n        else {\n            assert(exportsRelevant.length === 2);\n            assertWarning(false, `${filePathToShowToUser} remove ${exportConfigName} or ${exportDefault}`, {\n                onlyOnce: true\n            });\n        }\n    }\n    else {\n        // !configName => isConfigFile\n        if (!configName) {\n            const exportsInvalidStr = exportsInvalid.join(', ');\n            assertUsage(false, `${filePathToShowToUser} replace ${pc.cyan(`export { ${exportsInvalidStr} }`)} with ${pc.cyan(`export default { ${exportsInvalidStr} }`)}`);\n        }\n        // !!configName => isValueFile\n        else {\n            if (TOLERATE_SIDE_EXPORTS.some((ext) => filePathToShowToUser.endsWith(ext)))\n                return;\n            exportsInvalid.forEach((exportInvalid) => {\n                assertWarning(false, `${filePathToShowToUser} should have only a single export: move ${pc.cyan(`export { ${exportInvalid} }`)} to +config.h.js or its own +${exportsInvalid}.js`, { onlyOnce: true });\n            });\n        }\n    }\n}\n","export { parseConfigValuesImported };\nimport { assert } from '../../utils.js';\nimport { assertExportsOfValueFile } from '../assertExports.js';\nfunction parseConfigValuesImported(configValuesImported) {\n    const configValues = {};\n    const addConfigValue = (configName, value, importPath, exportName) => {\n        configValues[configName] = {\n            value,\n            definedAt: {\n                // importPath cannot be relative to the current file, since the current file is a virtual file\n                filePathToShowToUser: importPath,\n                fileExportPathToShowToUser: [configName, 'default'].includes(exportName)\n                    ? []\n                    : // Side-effect config\n                        [exportName]\n            }\n        };\n        assertIsNotNull(value, configName, importPath);\n    };\n    configValuesImported.forEach((configValueLoaded) => {\n        if (configValueLoaded.isValueFile) {\n            const { exportValues, importPath, configName } = configValueLoaded;\n            if (configName !== 'client') {\n                assertExportsOfValueFile(exportValues, importPath, configName);\n            }\n            Object.entries(exportValues).forEach(([exportName, exportValue]) => {\n                const isSideExport = exportName !== 'default'; // .md files may have \"side-exports\" such as `export { frontmatter }`\n                const configName = isSideExport ? exportName : configValueLoaded.configName;\n                if (isSideExport && configName in configValues) {\n                    // We can't avoid side-export conflicts upstream. (Because we cannot know about side-exports upstream at build-time.)\n                    // Side-exports have the lowest priority.\n                    return;\n                }\n                addConfigValue(configName, exportValue, importPath, exportName);\n            });\n        }\n        else {\n            const { configName, importPath, exportValue, exportName } = configValueLoaded;\n            addConfigValue(configName, exportValue, importPath, exportName);\n        }\n    });\n    return configValues;\n}\nfunction assertIsNotNull(configValue, configName, importPath) {\n    assert(!importPath.includes('+config.'));\n    /* Re-use this for:\n     *  - upcoming config.requestPageContextOnNavigation\n     *  - for cumulative values in the future: we don't need this for now because, currently, cumulative values are never imported.\n    assertUsage(\n      configValue !== null,\n      `Set ${pc.cyan(configName)} to ${pc.cyan('null')} in a +config.h.js file instead of ${importPath}`\n    )\n    */\n}\n","export { types };\nconst types = [\n    ts({\n        is: (val) => val === undefined,\n        match: (str) => str === '!undefined',\n        serialize: () => '!undefined',\n        deserialize: () => undefined\n    }),\n    ts({\n        is: (val) => val === Infinity,\n        match: (str) => str === '!Infinity',\n        serialize: () => '!Infinity',\n        deserialize: () => Infinity\n    }),\n    ts({\n        is: (val) => val === -Infinity,\n        match: (str) => str === '!-Infinity',\n        serialize: () => '!-Infinity',\n        deserialize: () => -Infinity\n    }),\n    ts({\n        is: (val) => typeof val === 'number' && isNaN(val),\n        match: (str) => str === '!NaN',\n        serialize: () => '!NaN',\n        deserialize: () => NaN\n    }),\n    ts({\n        is: (val) => val instanceof Date,\n        match: (str) => str.startsWith('!Date:'),\n        serialize: (val) => '!Date:' + val.toISOString(),\n        deserialize: (str) => new Date(str.slice('!Date:'.length))\n    }),\n    ts({\n        is: (val) => typeof val === 'bigint',\n        match: (str) => str.startsWith('!BigInt:'),\n        serialize: (val) => '!BigInt:' + val.toString(),\n        deserialize: (str) => {\n            if (typeof BigInt === 'undefined') {\n                throw new Error('Your JavaScript environement does not support BigInt. Consider adding a polyfill.');\n            }\n            return BigInt(str.slice('!BigInt:'.length));\n        }\n    }),\n    ts({\n        is: (val) => val instanceof RegExp,\n        match: (str) => str.startsWith('!RegExp:'),\n        serialize: (val) => '!RegExp:' + val.toString(),\n        deserialize: (str) => {\n            str = str.slice('!RegExp:'.length);\n            // const args: string[] = str.match(/\\/(.*?)\\/([gimy])?$/)!\n            const args = str.match(/\\/(.*)\\/(.*)?/);\n            const pattern = args[1];\n            const flags = args[2];\n            return new RegExp(pattern, flags);\n        }\n    }),\n    ts({\n        is: (val) => val instanceof Map,\n        match: (str) => str.startsWith('!Map:'),\n        serialize: (val, serializer) => '!Map:' + serializer(Array.from(val.entries())),\n        deserialize: (str, deserializer) => new Map(deserializer(str.slice('!Map:'.length)))\n    }),\n    ts({\n        is: (val) => val instanceof Set,\n        match: (str) => str.startsWith('!Set:'),\n        serialize: (val, serializer) => '!Set:' + serializer(Array.from(val.values())),\n        deserialize: (str, deserializer) => new Set(deserializer(str.slice('!Set:'.length)))\n    }),\n    // Avoid collisions with the special strings defined above\n    ts({\n        is: (val) => typeof val === 'string' && val.startsWith('!'),\n        match: (str) => str.startsWith('!'),\n        serialize: (val) => '!' + val,\n        deserialize: (str) => str.slice(1)\n    })\n];\n// Type check\nfunction ts(t) {\n    return t;\n}\n","export { parse };\nimport { types } from './types';\nfunction parse(str) {\n    // We don't use the reviver option in `JSON.parse(str, reviver)` because it doesn't support `undefined` values\n    const value = JSON.parse(str);\n    return modifier(value);\n}\nfunction modifier(value) {\n    if (typeof value === 'string') {\n        return reviver(value);\n    }\n    if (typeof value === 'object' && value !== null) {\n        Object.entries(value).forEach(([key, val]) => {\n            ;\n            value[key] = modifier(val);\n        });\n    }\n    return value;\n}\nfunction reviver(value) {\n    for (const { match, deserialize } of types) {\n        if (match(value)) {\n            return deserialize(value, parse);\n        }\n    }\n    return value;\n}\n","export { parseConfigValuesSerialized };\nimport { assert } from '../../utils.js';\nimport { parse } from '@brillout/json-serializer/parse';\nfunction parseConfigValuesSerialized(configValuesSerialized) {\n    const configValues = {};\n    Object.entries(configValuesSerialized).forEach(([configName, configValueSeriliazed]) => {\n        const { valueSerialized, definedAt } = configValueSeriliazed;\n        assert(valueSerialized);\n        assert(!configValues[configName]);\n        configValues[configName] = {\n            value: parse(valueSerialized),\n            definedAt\n        };\n    });\n    return configValues;\n}\n","export { parsePageConfigs };\nimport { parseConfigValuesImported } from './parseConfigValuesImported.js';\nimport { assertUsage, isCallable } from '../../utils.js';\nimport { getConfigDefinedAtString } from '../helpers.js';\nimport { parseConfigValuesSerialized } from './parseConfigValuesSerialized.js';\nfunction parsePageConfigs(pageConfigsSerialized, pageConfigGlobalSerialized) {\n    const pageConfigs = pageConfigsSerialized.map((pageConfigSerialized) => {\n        const configValues = {};\n        {\n            const { configValuesSerialized } = pageConfigSerialized;\n            const configValuesAddendum = parseConfigValuesSerialized(configValuesSerialized);\n            Object.assign(configValues, configValuesAddendum);\n        }\n        {\n            const { configValuesImported } = pageConfigSerialized;\n            const configValuesAddendum = parseConfigValuesImported(configValuesImported);\n            Object.assign(configValues, configValuesAddendum);\n        }\n        const { pageId, isErrorPage, routeFilesystem, loadConfigValuesAll } = pageConfigSerialized;\n        assertRouteConfigValue(configValues);\n        return {\n            pageId,\n            isErrorPage,\n            routeFilesystem,\n            configValues,\n            loadConfigValuesAll\n        };\n    });\n    const pageConfigGlobal = { configValues: {} };\n    {\n        const configValuesAddendum = parseConfigValuesImported(pageConfigGlobalSerialized.configValuesImported);\n        Object.assign(pageConfigGlobal.configValues, configValuesAddendum);\n    }\n    return { pageConfigs, pageConfigGlobal };\n}\nfunction assertRouteConfigValue(configValues) {\n    const configName = 'route';\n    const configValue = configValues[configName];\n    if (!configValue)\n        return;\n    const { value } = configValue;\n    const configValueType = typeof value;\n    const configDefinedAt = getConfigDefinedAtString('Config', configName, configValue);\n    assertUsage(configValueType === 'string' || isCallable(value), `${configDefinedAt} has an invalid type '${configValueType}': it should be a string or a function instead, see https://vike.dev/route`);\n    /* We don't use assertRouteString() in order to avoid unnecessarily bloating the client-side bundle when using Server Routing:\n    * - When using Server Routing, this file is loaded => loading assertRouteString() would bloat the client bundle.\n    * - assertRouteString() is already called on the server-side\n    * - When using Server Routing, client-side validation is superfluous as Route Strings only need to be validated on the server-side\n   if (typeof configValue === 'string') {\n     assertRouteString(configValue, `${configElement.configDefinedAt} defines an`)\n   }\n   */\n}\n","export { parseGlobResults };\nimport { assert, hasProp, isCallable, isObject, cast, assertUsage } from '../utils.js';\nimport { assertExportValues } from './assert_exports_old_design.js';\nimport { getPageFileObject } from './getPageFileObject.js';\nimport { fileTypes } from './fileTypes.js';\nimport { assertPageConfigGlobalSerialized, assertPageConfigsSerialized } from '../page-configs/serialize/assertPageConfigsSerialized.js';\nimport { parsePageConfigs } from '../page-configs/serialize/parsePageConfigs.js';\nfunction parseGlobResults(pageFilesExports) {\n    assert(hasProp(pageFilesExports, 'isGeneratedFile'));\n    assert(pageFilesExports.isGeneratedFile !== false, `vike was re-installed(/re-built). Restart your app.`);\n    assert(pageFilesExports.isGeneratedFile === true, `\\`isGeneratedFile === ${pageFilesExports.isGeneratedFile}\\``);\n    assert(hasProp(pageFilesExports, 'pageFilesLazy', 'object'));\n    assert(hasProp(pageFilesExports, 'pageFilesEager', 'object'));\n    assert(hasProp(pageFilesExports, 'pageFilesExportNamesLazy', 'object'));\n    assert(hasProp(pageFilesExports, 'pageFilesExportNamesEager', 'object'));\n    assert(hasProp(pageFilesExports.pageFilesLazy, '.page'));\n    assert(hasProp(pageFilesExports.pageFilesLazy, '.page.client') || hasProp(pageFilesExports.pageFilesLazy, '.page.server'));\n    assert(hasProp(pageFilesExports, 'pageFilesList', 'string[]'));\n    assert(hasProp(pageFilesExports, 'pageConfigsSerialized'));\n    assert(hasProp(pageFilesExports, 'pageConfigGlobalSerialized'));\n    const { pageConfigsSerialized, pageConfigGlobalSerialized } = pageFilesExports;\n    assertPageConfigsSerialized(pageConfigsSerialized);\n    assertPageConfigGlobalSerialized(pageConfigGlobalSerialized);\n    const { pageConfigs, pageConfigGlobal } = parsePageConfigs(pageConfigsSerialized, pageConfigGlobalSerialized);\n    const pageFilesMap = {};\n    parseGlobResult(pageFilesExports.pageFilesLazy).forEach(({ filePath, pageFile, globValue }) => {\n        pageFile = pageFilesMap[filePath] = pageFilesMap[filePath] ?? pageFile;\n        const loadModule = globValue;\n        assertLoadModule(loadModule);\n        pageFile.loadFile = async () => {\n            if (!('fileExports' in pageFile)) {\n                pageFile.fileExports = await loadModule();\n                assertExportValues(pageFile);\n            }\n        };\n    });\n    parseGlobResult(pageFilesExports.pageFilesExportNamesLazy).forEach(({ filePath, pageFile, globValue }) => {\n        pageFile = pageFilesMap[filePath] = pageFilesMap[filePath] ?? pageFile;\n        const loadModule = globValue;\n        assertLoadModule(loadModule);\n        pageFile.loadExportNames = async () => {\n            if (!('exportNames' in pageFile)) {\n                const moduleExports = await loadModule();\n                // Vite 2 seems to choke following assertion: https://github.com/vikejs/vike/issues/455\n                assertUsage('exportNames' in moduleExports, 'You seem to be using Vite 2 but the latest vike versions only work with Vite 3');\n                assert(hasProp(moduleExports, 'exportNames', 'string[]'), pageFile.filePath);\n                pageFile.exportNames = moduleExports.exportNames;\n            }\n        };\n    });\n    // `pageFilesEager` contains `.page.route.js` files\n    parseGlobResult(pageFilesExports.pageFilesEager).forEach(({ filePath, pageFile, globValue }) => {\n        pageFile = pageFilesMap[filePath] = pageFilesMap[filePath] ?? pageFile;\n        const moduleExports = globValue;\n        assert(isObject(moduleExports));\n        pageFile.fileExports = moduleExports;\n    });\n    parseGlobResult(pageFilesExports.pageFilesExportNamesEager).forEach(({ filePath, pageFile, globValue }) => {\n        pageFile = pageFilesMap[filePath] = pageFilesMap[filePath] ?? pageFile;\n        const moduleExports = globValue;\n        assert(isObject(moduleExports));\n        assert(hasProp(moduleExports, 'exportNames', 'string[]'), pageFile.filePath);\n        pageFile.exportNames = moduleExports.exportNames;\n    });\n    pageFilesExports.pageFilesList.forEach((filePath) => {\n        pageFilesMap[filePath] = pageFilesMap[filePath] ?? getPageFileObject(filePath);\n    });\n    const pageFiles = Object.values(pageFilesMap);\n    pageFiles.forEach(({ filePath }) => {\n        assert(!filePath.includes('\\\\'));\n    });\n    return { pageFiles, pageConfigs, pageConfigGlobal };\n}\nfunction parseGlobResult(globObject) {\n    const ret = [];\n    Object.entries(globObject).forEach(([fileType, globFiles]) => {\n        cast(fileType);\n        assert(fileTypes.includes(fileType));\n        assert(isObject(globFiles));\n        Object.entries(globFiles).forEach(([filePath, globValue]) => {\n            const pageFile = getPageFileObject(filePath);\n            assert(pageFile.fileType === fileType);\n            ret.push({ filePath, pageFile, globValue });\n        });\n    });\n    return ret;\n}\nfunction assertLoadModule(globValue) {\n    assert(isCallable(globValue));\n}\n","export { setPageFiles };\nexport { setPageFilesAsync };\nexport { getPageFilesAll };\nimport { assert, unique } from '../utils.js';\nimport { parseGlobResults } from './parseGlobResults.js';\nimport { getGlobalObject } from '../../utils/getGlobalObject.js';\nconst globalObject = getGlobalObject('setPageFiles.ts', {});\n// TODO:v1-design-release: rename setPageFiles() getPageFilesAll() parseGlobResult()\nfunction setPageFiles(pageFilesExports) {\n    const { pageFiles, pageConfigs, pageConfigGlobal } = parseGlobResults(pageFilesExports);\n    globalObject.pageFilesAll = pageFiles;\n    globalObject.pageConfigs = pageConfigs;\n    globalObject.pageConfigGlobal = pageConfigGlobal;\n}\nfunction setPageFilesAsync(getPageFilesExports) {\n    globalObject.pageFilesGetter = async () => {\n        setPageFiles(await getPageFilesExports());\n    };\n}\nasync function getPageFilesAll(isClientSide, isProduction) {\n    if (isClientSide) {\n        assert(!globalObject.pageFilesGetter);\n        assert(isProduction === undefined);\n    }\n    else {\n        assert(globalObject.pageFilesGetter);\n        assert(typeof isProduction === 'boolean');\n        if (!globalObject.pageFilesAll ||\n            // We reload all glob imports in dev to make auto-reload work\n            !isProduction) {\n            await globalObject.pageFilesGetter();\n        }\n    }\n    const { pageFilesAll, pageConfigs, pageConfigGlobal } = globalObject;\n    assert(pageFilesAll && pageConfigs && pageConfigGlobal);\n    const allPageIds = getAllPageIds(pageFilesAll, pageConfigs);\n    return { pageFilesAll, allPageIds, pageConfigs, pageConfigGlobal };\n}\nfunction getAllPageIds(allPageFiles, pageConfigs) {\n    const fileIds = allPageFiles.filter(({ isDefaultPageFile }) => !isDefaultPageFile).map(({ pageId }) => pageId);\n    const allPageIds = unique(fileIds);\n    const allPageIds2 = pageConfigs.map((p) => p.pageId);\n    return [...allPageIds, ...allPageIds2];\n}\n","// TODO:v1-release: remove this file\nexport { getPageFilesClientSide };\nexport { getPageFilesServerSide };\nimport { assert, assertUsage, isNotNullish } from '../utils.js';\nimport { assertPageFilePath } from '../assertPageFilePath.js';\nfunction getPageFilesClientSide(pageFilesAll, pageId) {\n    return determine(pageFilesAll, pageId, true);\n}\nfunction getPageFilesServerSide(pageFilesAll, pageId) {\n    return determine(pageFilesAll, pageId, false);\n}\nfunction determine(pageFilesAll, pageId, envIsClient) {\n    const env = envIsClient ? 'CLIENT_ONLY' : 'SERVER_ONLY';\n    const pageFilesRelevant = pageFilesAll\n        .filter((p) => p.isRelevant(pageId) && p.fileType !== '.page.route')\n        .sort(getPageFilesSorter(envIsClient, pageId));\n    // Load the `.page.js` files specific to `pageId`\n    const getPageIdFile = (iso) => {\n        const files = pageFilesRelevant.filter((p) => p.pageId === pageId && p.isEnv(iso ? 'CLIENT_AND_SERVER' : env));\n        assertUsage(files.length <= 1, `Merge the following files into a single file: ${files.map((p) => p.filePath).join(' ')}`);\n        const pageIdFile = files[0];\n        assert(pageIdFile === undefined || !pageIdFile.isDefaultPageFile);\n        return pageIdFile;\n    };\n    const pageIdFileEnv = getPageIdFile(false);\n    const pageIdFileIso = getPageIdFile(true);\n    // A page can have only one renderer. In other words: Multiple `renderer/` overwrite each other.\n    // Load only load renderer (`/renderer/_default.*`)\n    const getRendererFile = (iso) => pageFilesRelevant.filter((p) => p.isRendererPageFile && p.isEnv(iso ? 'CLIENT_AND_SERVER' : env))[0];\n    const rendererFileEnv = getRendererFile(false);\n    const rendererFileIso = getRendererFile(true);\n    // A page can load multiple `_defaut.page.*` files of the same `fileType`. In other words: non-renderer `_default.page.*` files are cumulative.\n    // The exception being HTML-only pages because we pick a single page file as client entry. We handle that use case at `renderPage()`.\n    const defaultFilesNonRenderer = pageFilesRelevant.filter((p) => p.isDefaultPageFile && !p.isRendererPageFile && (p.isEnv(env) || p.isEnv('CLIENT_AND_SERVER')));\n    // Ordered by `pageContext.exports` precendence\n    const pageFiles = [pageIdFileEnv, pageIdFileIso, ...defaultFilesNonRenderer, rendererFileEnv, rendererFileIso].filter(isNotNullish);\n    return pageFiles;\n}\nfunction getPageFilesSorter(envIsClient, pageId) {\n    const env = envIsClient ? 'CLIENT_ONLY' : 'SERVER_ONLY';\n    const e1First = -1;\n    const e2First = +1;\n    const noOrder = 0;\n    return (e1, e2) => {\n        // `.page.js` files specific to `pageId` first\n        if (!e1.isDefaultPageFile && e2.isDefaultPageFile) {\n            return e1First;\n        }\n        if (!e2.isDefaultPageFile && e1.isDefaultPageFile) {\n            return e2First;\n        }\n        // Non-renderer `_default.page.*` before `renderer/**/_default.page.*`\n        {\n            const e1_isRenderer = e1.isRendererPageFile;\n            const e2_isRenderer = e2.isRendererPageFile;\n            if (!e1_isRenderer && e2_isRenderer) {\n                return e1First;\n            }\n            if (!e2_isRenderer && e1_isRenderer) {\n                return e2First;\n            }\n            assert(e1_isRenderer === e2_isRenderer);\n        }\n        // Filesystem nearest first\n        {\n            const e1_distance = getPathDistance(pageId, e1.filePath);\n            const e2_distance = getPathDistance(pageId, e2.filePath);\n            if (e1_distance < e2_distance) {\n                return e1First;\n            }\n            if (e2_distance < e1_distance) {\n                return e2First;\n            }\n            assert(e1_distance === e2_distance);\n        }\n        // `.page.server.js`/`.page.client.js` before `.page.js`\n        {\n            if (e1.isEnv(env) && e2.isEnv('CLIENT_AND_SERVER')) {\n                return e1First;\n            }\n            if (e2.isEnv(env) && e1.isEnv('CLIENT_AND_SERVER')) {\n                return e2First;\n            }\n        }\n        return noOrder;\n    };\n}\nfunction getPathDistance(pathA, pathB) {\n    assertPageFilePath(pathA);\n    assertPageFilePath(pathB);\n    // Index of first different character\n    let idx = 0;\n    for (; idx < pathA.length && idx < pathB.length; idx++) {\n        if (pathA[idx] !== pathB[idx])\n            break;\n    }\n    const pathAWithoutCommon = pathA.slice(idx);\n    const pathBWithoutCommon = pathB.slice(idx);\n    const distanceA = pathAWithoutCommon.split('/').length;\n    const distanceB = pathBWithoutCommon.split('/').length;\n    const distance = distanceA + distanceB;\n    return distance;\n}\n","import { setPageFiles } from '../../shared/getPageFiles.js';\n// @ts-ignore\nimport * as pageFilesExports from 'virtual:vike:importUserCode:client:client-routing';\nsetPageFiles(pageFilesExports);\n","export { assertIsBrowser };\nimport { isBrowser } from './isBrowser.js';\nimport { assert } from './assert.js';\nfunction assertIsBrowser() {\n    assert(isBrowser());\n}\n","export { onLoad };\nimport { assertIsBrowser } from '../../utils/assertIsBrowser.js';\nimport { assertClientRouting } from '../../utils/assertRoutingType.js';\nfunction onLoad() {\n    assertIsBrowser();\n    // Ensure we don't bloat the Server Routing runtime with Client Routing utils\n    assertClientRouting();\n}\n","export { onLoad };\nimport { assertIsBrowser } from '../../utils/assertIsBrowser.js';\nfunction onLoad() {\n    assertIsBrowser();\n}\n","export { humanizeTime };\nfunction humanizeTime(milliseconds) {\n    const seconds = milliseconds / 1000;\n    if (seconds < 120) {\n        const n = round(seconds);\n        return `${n} second${plural(n)}`;\n    }\n    {\n        const minutes = seconds / 60;\n        const n = round(minutes);\n        return `${n} minute${plural(n)}`;\n    }\n}\nfunction round(n) {\n    let rounded = n.toFixed(1);\n    if (rounded.endsWith('.0'))\n        rounded = rounded.slice(0, -2);\n    return rounded;\n}\nfunction plural(n) {\n    return n === '1' ? '' : 's';\n}\n","export { executeHook };\nexport { isUserHookError };\nimport { getProjectError, assertWarning } from '../../utils/assert.js';\nimport { getGlobalObject } from '../../utils/getGlobalObject.js';\nimport { humanizeTime } from '../../utils/humanizeTime.js';\nimport { isObject } from '../../utils/isObject.js';\nconst globalObject = getGlobalObject('utils/executeHook.ts', {\n    userHookErrors: new Map()\n});\nfunction isUserHookError(err) {\n    if (!isObject(err))\n        return false;\n    return globalObject.userHookErrors.get(err) ?? false;\n}\nfunction executeHook(hookFnCaller, hook) {\n    const { hookName, hookFilePath, hookTimeout: { error: timeoutErr, warning: timeoutWarn } } = hook;\n    let resolve;\n    let reject;\n    const promise = new Promise((resolve_, reject_) => {\n        resolve = (ret) => {\n            clearTimeouts();\n            resolve_(ret);\n        };\n        reject = (err) => {\n            clearTimeouts();\n            reject_(err);\n        };\n    });\n    const clearTimeouts = () => {\n        if (currentTimeoutWarn)\n            clearTimeout(currentTimeoutWarn);\n        if (currentTimeoutErr)\n            clearTimeout(currentTimeoutErr);\n    };\n    const currentTimeoutWarn = isNotDisabled(timeoutWarn) &&\n        setTimeout(() => {\n            assertWarning(false, `The ${hookName}() hook defined by ${hookFilePath} is slow: it's taking more than ${humanizeTime(timeoutWarn)} (https://vike.dev/hooksTimeout)`, { onlyOnce: false });\n        }, timeoutWarn);\n    const currentTimeoutErr = isNotDisabled(timeoutErr) &&\n        setTimeout(() => {\n            const err = getProjectError(`The ${hookName}() hook defined by ${hookFilePath} timed out: it didn't finish after ${humanizeTime(timeoutErr)} (https://vike.dev/hooksTimeout)`);\n            reject(err);\n        }, timeoutErr);\n    (async () => {\n        try {\n            const ret = await hookFnCaller();\n            resolve(ret);\n        }\n        catch (err) {\n            if (isObject(err)) {\n                globalObject.userHookErrors.set(err, { hookName, hookFilePath });\n            }\n            reject(err);\n        }\n    })();\n    return promise;\n}\nfunction isNotDisabled(timeout) {\n    return !!timeout && timeout !== Infinity;\n}\n","export { getCurrentUrl };\nimport { parseUrl } from './parseUrl.js';\nimport { assert } from './assert.js';\nfunction getCurrentUrl(options) {\n    const url = window.location.href;\n    const { searchOriginal, hashOriginal, pathname } = parseUrl(url, '/');\n    let urlCurrent;\n    if (options?.withoutHash) {\n        urlCurrent = `${pathname}${searchOriginal || ''}`;\n    }\n    else {\n        urlCurrent = `${pathname}${searchOriginal || ''}${hashOriginal || ''}`;\n    }\n    assert(urlCurrent.startsWith('/'));\n    return urlCurrent;\n}\n","// Utils needed by Server Routing.\n// We assume all runtime entries will load this utils.ts file\nimport { onLoad } from './onLoad.js';\nonLoad();\nexport * from '../../utils/assert.js';\nexport * from '../../utils/assertSingleInstance.js';\nexport * from '../../shared/hooks/executeHook.js';\nexport * from '../../utils/checkType.js'; // Only used by Server Routing (not needed for Client Routing)\nexport * from '../../utils/getCurrentUrl.js';\nexport * from '../../utils/getGlobalObject.js';\nexport * from '../../utils/hasProp.js';\nexport * from '../../utils/isCallable.js';\nexport * from '../../utils/isObject.js';\nexport * from '../../utils/objectAssign.js';\nexport * from '../../utils/parseUrl.js';\nexport * from '../../utils/projectInfo.js';\nexport * from '../../utils/slice.js';\nexport * from '../../utils/unique.js'; // Only used by Server Routing (not needed for Client Routing)\n","// There doesn't seem to be a reliable way to detect React:\n//  - https://stackoverflow.com/questions/73156433/detect-with-javascript-whether-the-website-is-using-react\nexport function isReact() {\n    // Heuristic using values set by React (Dev Tools)\n    // - `window.__REACT_DEVTOOLS_GLOBAL_HOOK__` is an internal API for React Dev Tools\n    //   - https://stackoverflow.com/questions/46807826/how-does-react-developer-tools-determine-that-the-webpage-is-using-react/46808361#46808361\n    //   - In principle, `window.__REACT_DEVTOOLS_GLOBAL_HOOK__` should exist only if React Dev Tools is installed. (Although it seems that it's sometimes defined even when React Dev Tools isn't installed; I don't know why.)\n    // - We use `isReact1`/`isReact2` merely to validate `isReact3` and `isReact4`. Because `isReact1`/`isReact2` can be false negatives:\n    //   - React populates `__REACT_DEVTOOLS_GLOBAL_HOOK__.renderers` fairly late => false negative early in the rendering phase\n    //   - `window.__REACT_DEVTOOLS_GLOBAL_HOOK__` is `undefined` if React Dev Tools isn't installed => false negative\n    const isReact1 = !!window.__REACT_DEVTOOLS_GLOBAL_HOOK__?.renderers?.size;\n    const isReact2 = !!window.__REACT_DEVTOOLS_GLOBAL_HOOK__?.rendererInterfaces?.size;\n    // Heuristic using values set by `@vitejs/plugin-react`\n    const isReact3 = !!window.__vite_plugin_react_preamble_installed__;\n    /* Also set by Preact Vite plugin `@preact/preset-vite`\n    const isReact4 = !!(window as any).$RefreshReg$\n    */\n    // console.log({ isReact1, isReact2, isReact3 })\n    return isReact1 || isReact2 || isReact3;\n}\n","// https://stackoverflow.com/questions/201183/how-to-determine-equality-for-two-javascript-objects/32922084#32922084\nexport function deepEqual(x, y) {\n    const ok = Object.keys, tx = typeof x, ty = typeof y;\n    return x && y && tx === 'object' && tx === ty\n        ? ok(x).length === ok(y).length && ok(x).every((key) => deepEqual(x[key], y[key]))\n        : x === y;\n}\n","import { isObject } from './isObject.js';\nimport { deepEqual } from './deepEqual.js';\nexport { isEquivalentError };\nfunction isEquivalentError(err1, err2) {\n    return (isObject(err1) &&\n        isObject(err2) &&\n        err1.constructor === err2.constructor &&\n        deepEqual({ ...err1, stack: null }, { ...err2, stack: null }) &&\n        // 'message' and 'stack' are usually non-emurable\n        err2.message === err2.message\n    /* Doesn't work because: the stack trace isn't exactly the same between the original page rendering and the fallback error page rendering\n    err2.stack === err2.stack\n    */\n    );\n}\n","export { serverSideRouteTo };\nfunction serverSideRouteTo(url) {\n    window.location.href = url;\n}\n","export function sleep(milliseconds) {\n    return new Promise((r) => setTimeout(r, milliseconds));\n}\n","export { throttle };\nfunction throttle(func, waitTime) {\n    let isQueued = false;\n    return () => {\n        if (!isQueued) {\n            isQueued = true;\n            setTimeout(() => {\n                isQueued = false;\n                func();\n            }, waitTime);\n        }\n    };\n}\n","export { onPageHide };\nexport { onPageShow };\nfunction onPageHide(listener) {\n    window.addEventListener('visibilitychange', () => {\n        if (document.visibilityState === 'hidden') {\n            listener();\n        }\n    });\n}\nfunction onPageShow(listener) {\n    window.addEventListener('visibilitychange', () => {\n        if (document.visibilityState === 'visible') {\n            listener();\n        }\n    });\n}\n","export { isExternalLink };\nfunction isExternalLink(url) {\n    return !url.startsWith('/') && !url.startsWith('.') && !url.startsWith('?') && url !== '';\n}\n","// Utils needed by Client Routing.\n// We assume all runtime entries will load this utils.ts file\nimport { onLoad } from './onLoad.js';\nonLoad();\n// We load the Server Routing utils: we tolerate the tiny amount of code that is only needed by Server Routing (only 1-2 lines).\n// We re-export some of the utils down below only to list the utils needed by Client Routing.\nexport * from '../server-routing-runtime/utils.js';\nexport * from '../../utils/assert.js';\nexport * from '../../utils/assertSingleInstance.js';\nexport * from '../../shared/hooks/executeHook.js';\nexport * from '../../utils/getCurrentUrl.js';\nexport * from '../../utils/getGlobalObject.js';\nexport * from '../../utils/hasProp.js';\nexport * from '../../utils/isBrowser.js';\nexport * from '../../utils/isCallable.js';\nexport * from '../../utils/isObject.js';\nexport * from '../../utils/isPlainObject.js';\nexport * from '../../utils/isReact.js';\nexport * from '../../utils/isEquivalentError.js';\nexport * from '../../utils/objectAssign.js';\nexport * from '../../utils/parseUrl.js';\nexport * from '../../utils/projectInfo.js';\nexport * from '../../utils/PromiseType.js';\nexport * from '../../utils/serverSideRouteTo.js';\nexport * from '../../utils/sleep.js';\nexport * from '../../utils/slice.js';\nexport * from '../../utils/throttle.js';\nexport * from '../../utils/assertRoutingType.js';\nexport * from '../../utils/onPageVisibilityChange.js';\nexport * from '../../utils/isExternalLink.js';\n","export { initHistoryState, getHistoryState, pushHistory, saveScrollPosition, monkeyPatchHistoryPushState };\nimport { assert, assertUsage, getGlobalObject, hasProp, isObject } from './utils.js';\nconst globalObject = getGlobalObject('history.ts', {});\n// Fill missing state information:\n//  - `history.state` can uninitialized (i.e. `null`):\n//    - The very first render\n//    - The user's code runs `location.hash = '#section'`\n//    - The user clicks on an anchor link `<a href=\"#section\">Section</a>` (Vike's `onLinkClick()` handler skips hash links).\n//  - State information may be incomplete if `history.state` is set by an old Vike version. (E.g. `state.timestamp` was introduced for `pageContext.isBackwardNavigation` in `0.4.19`.)\nfunction initHistoryState() {\n    let state = window.history.state;\n    if (!state) {\n        state = {};\n    }\n    let hasModifications = false;\n    if (!('timestamp' in state)) {\n        hasModifications = true;\n        state.timestamp = getTimestamp();\n    }\n    if (!('scrollPosition' in state)) {\n        hasModifications = true;\n        state.scrollPosition = getScrollPosition();\n    }\n    if (!('triggedBy' in state)) {\n        state.triggedBy = 'browser';\n    }\n    assertState(state);\n    if (hasModifications) {\n        replaceHistoryState(state);\n    }\n}\nfunction getHistoryState() {\n    const state = window.history.state || {};\n    assertState(state);\n    return state;\n}\nfunction getScrollPosition() {\n    const scrollPosition = { x: window.scrollX, y: window.scrollY };\n    return scrollPosition;\n}\nfunction getTimestamp() {\n    return new Date().getTime();\n}\nfunction saveScrollPosition() {\n    const scrollPosition = getScrollPosition();\n    const state = getHistoryState();\n    replaceHistoryState({ ...state, scrollPosition });\n}\nfunction pushHistory(url, overwriteLastHistoryEntry) {\n    if (!overwriteLastHistoryEntry) {\n        const timestamp = getTimestamp();\n        pushHistoryState({ timestamp, scrollPosition: null, triggedBy: 'vike' }, url);\n    }\n    else {\n        replaceHistoryState(getHistoryState(), url);\n    }\n}\nfunction assertState(state) {\n    assert(isObject(state));\n    if ('timestamp' in state) {\n        const { timestamp } = state;\n        assert(typeof timestamp === 'number');\n    }\n    if ('scrollPosition' in state) {\n        const { scrollPosition } = state;\n        if (scrollPosition !== null) {\n            assert(hasProp(scrollPosition, 'x', 'number') && hasProp(scrollPosition, 'y', 'number'));\n        }\n    }\n}\nfunction replaceHistoryState(state, url) {\n    window.history.replaceState(state, '', url ?? /* Passing `undefined` chokes older Edge versions */ null);\n}\nfunction pushHistoryState(state, url) {\n    pushStateOriginal(state, '', url);\n}\nfunction monkeyPatchHistoryPushState() {\n    globalObject.pushStateOriginal = globalObject.pushStateOriginal ?? window.history.pushState;\n    window.history.pushState = (stateFromUser = {}, ...rest) => {\n        assertUsage(null === stateFromUser || undefined === stateFromUser || isObject(stateFromUser), 'history.pushState(state) argument state must be an object');\n        const state = {\n            scrollPosition: getScrollPosition(),\n            timestamp: getTimestamp(),\n            ...stateFromUser,\n            // Don't allow user to overwrite triggedBy as it would break Vike's handling of the 'popstate' event\n            triggedBy: 'user'\n        };\n        return pushStateOriginal(state, ...rest);\n    };\n}\nfunction pushStateOriginal(...args) {\n    globalObject.pushStateOriginal.apply(history, args);\n}\n","import { parse } from '@brillout/json-serializer/parse';\nimport { hasProp, assert, assertUsage, objectAssign } from '../server-routing-runtime/utils.js';\nexport { getPageContextSerializedInHtml };\nfunction getPageContextSerializedInHtml() {\n    // elem should exist because:\n    // 1. <script id=\"vike_pageContext\" type=\"application/json\"> appears before the <script> that loads Vike's client runtime (which includes this file)\n    // 2. <script id=\"vike_pageContext\" type=\"application/json\"> is neither async nor defer\n    // See https://github.com/vikejs/vike/pull/1271\n    const id = 'vike_pageContext';\n    const elem = document.getElementById(id);\n    assertUsage(elem, \n    // It seems like it can be missing because of malformed HTML: https://github.com/vikejs/vike/issues/913\n    `Couldn't find #${id} (which Vike automatically injects in the HTML): make sure it exists (i.e. don't remove it and make sure your HTML isn't malformed)`);\n    const pageContextJson = elem.textContent;\n    assert(pageContextJson);\n    const pageContextSerializedInHtml = parse(pageContextJson);\n    assert(hasProp(pageContextSerializedInHtml, '_pageId', 'string'));\n    objectAssign(pageContextSerializedInHtml, {\n        _hasPageContextFromServer: true\n    });\n    return pageContextSerializedInHtml;\n}\n","export { analyzePageServerSide };\nimport { assert } from '../utils.js';\nimport { getPageFilesServerSide } from './getAllPageIdFiles.js';\nasync function analyzePageServerSide(pageFilesAll, pageId) {\n    const pageFilesServerSide = getPageFilesServerSide(pageFilesAll, pageId);\n    const pageFilesServerSideOnly = pageFilesServerSide.filter((p) => p.fileType === '.page.server');\n    await Promise.all(pageFilesServerSideOnly.map(async (p) => {\n        // In production, `exportNames` are preload\n        if (p.exportNames) {\n            return;\n        }\n        assert(p.loadExportNames, pageId);\n        await p.loadExportNames();\n    }));\n    const hasOnBeforeRenderServerSideOnlyHook = pageFilesServerSideOnly.some(({ exportNames }) => {\n        assert(exportNames);\n        return exportNames.includes('onBeforeRender');\n    });\n    return { hasOnBeforeRenderServerSideOnlyHook };\n}\n","export { getHook };\nexport { getHookFromPageConfig };\nexport { getHookFromPageConfigGlobal };\nexport { assertHook };\n// TODO/v1-release: remove\n// We export for old V0.4 design which doesn't support config.hooksTimeout\nexport { getHookTimeoutDefault };\nimport { getConfigValue, getHookFilePathToShowToUser } from '../page-configs/helpers.js';\nimport { assert, assertUsage, checkType, isCallable, isObject } from '../utils.js';\nimport pc from '@brillout/picocolors';\nfunction getHook(pageContext, hookName) {\n    if (!(hookName in pageContext.exports)) {\n        return null;\n    }\n    const { hooksTimeout } = pageContext.config;\n    const hookTimeout = getHookTimeout(hooksTimeout, hookName);\n    const hookFn = pageContext.exports[hookName];\n    const file = pageContext.exportsAll[hookName][0];\n    assert(file.exportValue === hookFn);\n    if (hookFn === null)\n        return null;\n    const hookFilePath = file.filePath;\n    assert(hookFilePath);\n    assert(!hookFilePath.endsWith(' '));\n    assertHookFn(hookFn, { hookName, hookFilePath });\n    return { hookFn, hookName, hookFilePath, hookTimeout };\n}\nfunction getHookFromPageConfig(pageConfig, hookName) {\n    const configValue = getConfigValue(pageConfig, hookName);\n    const hooksTimeout = getConfigValue(pageConfig, 'hooksTimeout')?.value;\n    if (!configValue)\n        return null;\n    const hookFn = configValue.value;\n    if (!hookFn)\n        return null;\n    const hookFilePath = getHookFilePathToShowToUser(configValue);\n    // hook isn't a computed nor a cumulative config => definedAt should always be defined\n    assert(hookFilePath);\n    assertHookFn(hookFn, { hookName, hookFilePath });\n    const hookTimeout = getHookTimeout(hooksTimeout, hookName);\n    return { hookFn, hookName, hookFilePath, hookTimeout };\n}\nfunction getHookFromPageConfigGlobal(pageConfigGlobal, hookName) {\n    const configValue = pageConfigGlobal.configValues[hookName];\n    if (!configValue)\n        return null;\n    const hookFn = configValue.value;\n    if (!hookFn)\n        return null;\n    const hookFilePath = getHookFilePathToShowToUser(configValue);\n    // hook isn't a computed nor a cumulative config => definedAt should always be defined\n    assert(hookFilePath);\n    assertHookFn(hookFn, { hookName, hookFilePath });\n    // We could use the global value of config.hooksTimeout but it requires some non-trivial refactoring\n    const hookTimeout = getHookTimeoutDefault(hookName);\n    return { hookFn, hookName, hookFilePath, hookTimeout };\n}\nfunction assertHook(pageContext, hookName) {\n    getHook(pageContext, hookName);\n}\nfunction assertHookFn(hookFn, { hookName, hookFilePath }) {\n    assert(hookName && hookFilePath);\n    assert(!hookName.endsWith(')'));\n    assertUsage(isCallable(hookFn), `Hook ${hookName}() defined by ${hookFilePath} should be a function`);\n    checkType(hookFn);\n}\nfunction getHookTimeout(hooksTimeoutProvidedByUser, hookName) {\n    const hooksTimeoutProvidedbyUserNormalized = getHooksTimeoutProvidedByUserNormalized(hooksTimeoutProvidedByUser);\n    if (hooksTimeoutProvidedbyUserNormalized === false)\n        return { error: false, warning: false };\n    const providedbyUser = hooksTimeoutProvidedbyUserNormalized[hookName];\n    const hookTimeout = getHookTimeoutDefault(hookName);\n    if (providedbyUser?.error !== undefined)\n        hookTimeout.error = providedbyUser.error;\n    if (providedbyUser?.warning !== undefined)\n        hookTimeout.warning = providedbyUser.warning;\n    return hookTimeout;\n}\n// Ideally this should be called only once and at build-time (to avoid bloating the client-side bundle), but we didn't implement any mechanism to valide config values at build-time yet\nfunction getHooksTimeoutProvidedByUserNormalized(hooksTimeoutProvidedByUser) {\n    if (hooksTimeoutProvidedByUser === undefined)\n        return {};\n    if (hooksTimeoutProvidedByUser === false)\n        return false;\n    assertUsage(isObject(hooksTimeoutProvidedByUser), `Setting ${pc.cyan('hooksTimeout')} should be ${pc.cyan('false')} or an object`);\n    const hooksTimeoutProvidedByUserNormalized = {};\n    Object.entries(hooksTimeoutProvidedByUser).forEach(([hookName, hookTimeoutProvidedbyUser]) => {\n        if (hookTimeoutProvidedbyUser === false) {\n            hooksTimeoutProvidedByUserNormalized[hookName] = { error: false, warning: false };\n            return;\n        }\n        assertUsage(isObject(hookTimeoutProvidedbyUser), `Setting ${pc.cyan(`hooksTimeout.${hookName}`)} should be ${pc.cyan('false')} or an object`);\n        const [error, warning] = ['error', 'warning'].map((timeoutName) => {\n            const timeoutVal = hookTimeoutProvidedbyUser[timeoutName];\n            if (timeoutVal === undefined || timeoutVal === false)\n                return timeoutVal;\n            const errPrefix = `Setting ${pc.cyan(`hooksTimeout.${hookName}.${timeoutName}`)} should be`;\n            assertUsage(typeof timeoutVal === 'number', `${errPrefix} ${pc.cyan('false')} or a number`);\n            assertUsage(timeoutVal > 0, `${errPrefix} a positive number`);\n            return timeoutVal;\n        });\n        hooksTimeoutProvidedByUserNormalized[hookName] = { error, warning };\n    });\n    return hooksTimeoutProvidedByUserNormalized;\n}\nfunction getHookTimeoutDefault(hookName) {\n    if (hookName === 'onBeforeRoute') {\n        return {\n            error: 5 * 1000,\n            warning: 1 * 1000\n        };\n    }\n    if (hookName === 'onPrerenderStart' ||\n        hookName === 'onBeforePrerenderStart' ||\n        // TODO/v1-release: remove\n        // Old V0.4 design hooks (https://vike.dev/migration/v1-design#renamed-hooks)\n        hookName === 'onBeforePrerender' ||\n        hookName === 'prerender') {\n        return {\n            error: 10 * 60 * 1000,\n            warning: 30 * 1000\n        };\n    }\n    return {\n        error: 30 * 1000,\n        warning: 4 * 1000\n    };\n}\n","import { compareString } from './utils.js';\nexport { sortPageContext };\n// Sort `pageContext` keys alphabetically, in order to make reading `console.log(pageContext)` easier\nfunction sortPageContext(pageContext) {\n    const entries = Object.entries(pageContext);\n    for (const key in pageContext) {\n        delete pageContext[key];\n    }\n    entries\n        .sort(([key1], [key2]) => compareString(key1, key2))\n        .forEach(([key, val]) => {\n        pageContext[key] = val;\n    });\n}\n","export { addIs404ToPageProps };\nimport { assert, assertWarning, hasProp, isObject } from './utils.js';\nimport { isErrorPage } from './error-page.js';\nfunction addIs404ToPageProps(pageContext) {\n    assertIs404(pageContext);\n    addIs404(pageContext);\n}\nfunction assertIs404(pageContext) {\n    if (isErrorPage(pageContext._pageId, pageContext._pageConfigs)) {\n        assert(hasProp(pageContext, 'is404', 'boolean'));\n    }\n}\nfunction addIs404(pageContext) {\n    if (pageContext.is404 === undefined || pageContext.is404 === null)\n        return;\n    const pageProps = pageContext.pageProps || {};\n    if (!isObject(pageProps)) {\n        assertWarning(false, 'pageContext.pageProps should be an object', { showStackTrace: true, onlyOnce: true });\n        return;\n    }\n    pageProps.is404 = pageProps.is404 || pageContext.is404;\n    pageContext.pageProps = pageProps;\n}\n","// TODO: move to ../node/runtime/html/notSerializable.ts once code is distributed as ESM\nexport const notSerializable = 'not-serializable';\n","export { getPageContextProxyForUser };\nimport { assert, assertUsage, getGlobalObject } from '../server-routing-runtime/utils.js';\nimport { notSerializable } from '../../shared/notSerializable.js';\nconst globalObject = getGlobalObject('getPageContextProxyForUser.ts', {});\n/**\n * - Throw error when pageContext value isn't serializable\n * - Throw error when pageContext prop is missing in passToClient\n */\nfunction getPageContextProxyForUser(pageContext) {\n    assert([true, false].includes(pageContext._hasPageContextFromServer));\n    assert([true, false].includes(pageContext._hasPageContextFromClient));\n    return new Proxy(pageContext, {\n        get(_, prop) {\n            const val = pageContext[prop];\n            const propName = JSON.stringify(prop);\n            assertUsage(val !== notSerializable, `pageContext[${propName}] couldn't be serialized and, therefore, is missing on the client-side. Check the server logs for more information.`);\n            assertIsDefined(pageContext, prop);\n            return val;\n        }\n    });\n}\nfunction assertIsDefined(pageContext, prop) {\n    // We disable assertIsDefined() for the next attempt to read `prop`, because of how Vue's reactivity work. When changing a reactive object:\n    //  - Vue tries to read its old value first. This triggers a `assertIsDefined()` failure if e.g. `pageContextOldReactive.routeParams = pageContextNew.routeParams` and `pageContextOldReactive` has no `routeParams`.\n    //  - Vue seems to read __v_raw before reading the property\n    if (globalObject.prev === prop || globalObject.prev === '__v_raw')\n        return;\n    ignoreNextRead(prop);\n    if (prop in pageContext)\n        return;\n    if (isExpected(prop))\n        return;\n    const propName = JSON.stringify(prop);\n    /* This handling would be the clearest but, unfortunately, it's fundamentally problematic:\n     *  - It would force the pageContext value consumer to be synchronized with the pageContext value provider. For example, if vike-react wants to conditionally do something dependening on wehther some optional pageContext value was provided by some optional vike-react-* integration package.\n     *  - If a pageContext value is set by an optional hook, then it's expected that the value is undefined if the hook doesn't exist.\n    const errMsg = `pageContext[${propName}] is \\`undefined\\` on the client-side. If it's defined on the server-side then add ${propName} to passToClient (https://vike.dev/passToClient), otherwise make sure your client-side hooks always define it (e.g. set it to \\`null\\` instead of \\`undefined\\`).`\n    assertUsage(false, errMsg)\n    */\n    if (pageContext._hasPageContextFromServer && !pageContext._hasPageContextFromClient) {\n        // We can safely assume that the property is missing in passToClient, because the server-side defines all passToClient properties even if they have an undefined value:\n        // ```\n        // <script id=\"vike_pageContext\" type=\"application/json\">{\"_pageId\":\"/pages/admin\",\"user\":\"!undefined\",\"pageProps\":\"!undefined\",\"title\":\"!undefined\",\"abortReason\":\"!undefined\",\"_urlRewrite\":null}</script>\n        // ```\n        // Note how properties have \"!undefined\" values => we can tell whether an undefined pageContext value exists in passToClient.\n        assertUsage(false, `pageContext[${propName}] isn't available on the client-side because ${propName} is missing in passToClient, see https://vike.dev/passToClient`);\n    }\n    else {\n        // Do nothing, not even a warning, because we don't know whether the user expects that the pageContext value can be undefined. (E.g. a pageContext value that is defined by an optional hook.)\n    }\n}\nconst IGNORE_LIST = [\n    'then',\n    'toJSON' // Vue tries to get `toJSON`\n];\nfunction isExpected(prop) {\n    if (IGNORE_LIST.includes(prop))\n        return true;\n    if (typeof prop === 'symbol')\n        return true; // Vue tries to access some symbols\n    if (typeof prop !== 'string')\n        return true;\n    if (prop.startsWith('__v_'))\n        return true; // Vue internals upon `reactive(pageContext)`\n    return false;\n}\nfunction ignoreNextRead(prop) {\n    globalObject.prev = prop;\n    window.setTimeout(() => {\n        globalObject.prev = undefined;\n    }, 0);\n}\n","export { preparePageContextForUserConsumptionClientSide };\nimport { assert, isObject, objectAssign } from '../server-routing-runtime/utils.js';\nimport { sortPageContext } from '../../shared/sortPageContext.js';\nimport { addIs404ToPageProps } from '../../shared/addIs404ToPageProps.js';\nimport { getPageContextProxyForUser } from './getPageContextProxyForUser.js';\n// Release `pageContext` for user consumption.\n//\n// This adds `assertPassToClient()`.\n//\n// With Vue support (when `pageContext` is made reactive with Vue).\n//\n// For Vue + Cient Routing, the `pageContext` needs to be made reactive:\n// ```js\n// import { reactive } from 'vue'\n// // See entire example at `/examples/vue-full/`\n// const pageContextReactive = reactive(pageContext)\n// ```\nfunction preparePageContextForUserConsumptionClientSide(pageContext, isClientRouting) {\n    if (isClientRouting) {\n        const pageContextTyped = pageContext;\n        assert([true, false].includes(pageContextTyped.isHydration));\n        assert([true, false, null].includes(pageContextTyped.isBackwardNavigation));\n    }\n    else {\n        const pageContextTyped = pageContext;\n        assert(pageContextTyped.isHydration === true);\n        assert(pageContextTyped.isBackwardNavigation === null);\n    }\n    assert('config' in pageContext);\n    assert('configEntries' in pageContext);\n    // TODO/v1-release: remove\n    assert('exports' in pageContext);\n    assert('exportsAll' in pageContext);\n    assert('pageExports' in pageContext);\n    assert(isObject(pageContext.pageExports));\n    const Page = pageContext.exports.Page;\n    objectAssign(pageContext, { Page });\n    // For Vue's reactivity\n    resolveGetters(pageContext);\n    // For prettier `console.log(pageContext)`\n    sortPageContext(pageContext);\n    const pageContextForUserConsumption = getPageContextProxyForUser(pageContext);\n    addIs404ToPageProps(pageContext);\n    return pageContextForUserConsumption;\n}\n// Remove propery descriptor getters because they break Vue's reactivity.\n// E.g. resolve the `pageContext.urlPathname` getter.\nfunction resolveGetters(pageContext) {\n    Object.entries(pageContext).forEach(([key, val]) => {\n        delete pageContext[key];\n        pageContext[key] = val;\n    });\n}\n","export { findPageConfig };\nimport { assert } from '../utils.js';\nfunction findPageConfig(pageConfigs, pageId) {\n    const result = pageConfigs.filter((p) => p.pageId === pageId);\n    assert(result.length <= 1);\n    const pageConfig = result[0] ?? null;\n    return pageConfig;\n}\n","export { loadConfigValues };\nimport { objectAssign } from '../utils.js';\nimport { parseConfigValuesImported } from './serialize/parseConfigValuesImported.js';\nimport { parseConfigValuesSerialized } from './serialize/parseConfigValuesSerialized.js';\nasync function loadConfigValues(pageConfig, isDev) {\n    if ('isAllLoaded' in pageConfig &&\n        // We don't need to cache in dev, since Vite already caches the virtual module\n        !isDev) {\n        return pageConfig;\n    }\n    const configValuesLoaded = await pageConfig.loadConfigValuesAll();\n    {\n        const { configValuesImported } = configValuesLoaded;\n        const configValuesAddendum = parseConfigValuesImported(configValuesImported);\n        Object.assign(pageConfig.configValues, configValuesAddendum);\n    }\n    {\n        const { configValuesSerialized } = configValuesLoaded;\n        const configValuesAddendum = parseConfigValuesSerialized(configValuesSerialized);\n        Object.assign(pageConfig.configValues, configValuesAddendum);\n    }\n    objectAssign(pageConfig, { isAllLoaded: true });\n    return pageConfig;\n}\n","export { loadPageFilesClientSide };\nexport { isErrorFetchingStaticAssets };\nimport { getPageFilesClientSide, getExports } from '../../shared/getPageFiles.js';\nimport { findPageConfig } from '../../shared/page-configs/findPageConfig.js';\nimport { loadConfigValues } from '../../shared/page-configs/loadConfigValues.js';\nconst stamp = '__whileFetchingAssets';\nasync function loadPageFilesClientSide(pageId, pageContext) {\n    const pageFilesClientSide = getPageFilesClientSide(pageContext._pageFilesAll, pageId);\n    const pageConfig = findPageConfig(pageContext._pageConfigs, pageId);\n    let pageConfigLoaded;\n    // @ts-ignore Since dist/cjs/client/ is never used, we can ignore this error.\n    const isDev = import.meta.env.DEV;\n    try {\n        // prettier-ignore\n        const result = await Promise.all([\n            pageConfig && loadConfigValues(pageConfig, isDev),\n            ...pageFilesClientSide.map((p) => p.loadFile?.()),\n        ]);\n        pageConfigLoaded = result[0];\n    }\n    catch (err) {\n        // To trigger this catch: add `throw new Error()` in the global scope of +onRenderClient.js\n        if (isFetchError(err)) {\n            Object.assign(err, { [stamp]: true });\n        }\n        throw err;\n    }\n    const { config, configEntries, exports, exportsAll, pageExports } = getExports(pageFilesClientSide, pageConfigLoaded);\n    const pageContextAddendum = {\n        config,\n        configEntries,\n        exports,\n        exportsAll,\n        pageExports,\n        _pageFilesLoaded: pageFilesClientSide\n    };\n    return pageContextAddendum;\n}\nfunction isErrorFetchingStaticAssets(err) {\n    if (!err) {\n        return false;\n    }\n    return err[stamp] === true;\n}\n// https://stackoverflow.com/questions/75928310/how-to-detect-that-import-some-url-failed-because-some-url-isnt-a-javasc\nfunction isFetchError(err) {\n    if (!(err instanceof Error))\n        return false;\n    // https://github.com/stacks-network/clarity-js-sdk/blob/e757666b59af00b5db04dd1bf0df016e3a459ea2/packages/clarity/src/providers/registry.ts#L40-L45\n    // https://github.com/modernweb-dev/web/blob/0a59b56e4c1b50af81fbf4588f36a1ceb71f3976/integration/test-runner/tests/test-failure/runTestFailureTest.ts#L11-L18\n    const FAILED_TO_FETCH_MESSAGES = [\n        // chromium\n        'Failed to fetch dynamically imported module',\n        // firefox\n        'error loading dynamically imported module',\n        // safari\n        'Importing a module script failed',\n        // ??\n        'error resolving module specifier',\n        // ??\n        'failed to resolve module'\n    ];\n    return FAILED_TO_FETCH_MESSAGES.some((s) => err.message.toLowerCase().includes(s.toLowerCase()));\n}\n","export { removeBuiltInOverrides };\nimport { assert, assertWarning } from '../utils.js';\nconst BUILT_IN_CLIENT_ROUTER = ['urlPathname', 'urlParsed'];\nconst BUILT_IN_CLIENT = ['Page', 'pageExports', 'exports'];\nfunction removeBuiltInOverrides(pageContext) {\n    const alreadySet = [...BUILT_IN_CLIENT, ...BUILT_IN_CLIENT_ROUTER];\n    alreadySet.forEach((prop) => {\n        if (prop in pageContext) {\n            // We need to cast `BUILT_IN_CLIENT` to `string[]`\n            //  - https://stackoverflow.com/questions/56565528/typescript-const-assertions-how-to-use-array-prototype-includes\n            //  - https://stackoverflow.com/questions/57646355/check-if-string-is-included-in-readonlyarray-in-typescript\n            if (BUILT_IN_CLIENT_ROUTER.includes(prop)) {\n                assert(prop.startsWith('url'));\n                assertWarning(false, `pageContext.${prop} is already available in the browser when using Client Routing; adding '${prop}' to passToClient has no effect`, { onlyOnce: true });\n            }\n            else {\n                assertWarning(false, `pageContext.${prop} is a built-in that cannot be overriden; adding '${prop}' to passToClient has no effect`, { onlyOnce: true });\n            }\n            delete pageContext[prop];\n        }\n    });\n}\n","export { urlToFile };\nexport { baseServer };\nimport { assert } from './assert.js';\nimport { parseUrl } from './parseUrl.js';\nimport { slice } from './slice.js';\n// - When doing a `.pageContext.json` HTTP request, the base URL should be preserved. (The server-side will handle the base URL.)\n// - While prerendering there is no base URL\nconst baseServer = '/';\nfunction urlToFile(url, fileExtension, doNotCreateExtraDirectory) {\n    const { pathnameOriginal, searchOriginal, hashOriginal } = parseUrl(url, baseServer);\n    if (url.startsWith('/')) {\n        assert(url === `${pathnameOriginal}${searchOriginal || ''}${hashOriginal || ''}`, { url });\n    }\n    const hasTrailingSlash = pathnameOriginal.endsWith('/');\n    let pathnameModified;\n    if (doNotCreateExtraDirectory && pathnameOriginal !== '/') {\n        if (hasTrailingSlash) {\n            pathnameModified = slice(pathnameOriginal, 0, -1);\n        }\n        else {\n            pathnameModified = pathnameOriginal;\n        }\n        assert(!pathnameModified.endsWith('/'), { url });\n        assert(pathnameModified !== '');\n    }\n    else {\n        pathnameModified = pathnameOriginal + (hasTrailingSlash ? '' : '/') + 'index';\n    }\n    assert(pathnameModified);\n    pathnameModified = pathnameModified + fileExtension;\n    const fileUrl = `${pathnameModified}${searchOriginal || ''}${hashOriginal || ''}`;\n    return fileUrl;\n}\n","export { getPageContextRequestUrl };\nexport { pageContextJsonFileExtension };\nexport { doNotCreateExtraDirectory };\n// This module isn't loaded by the client-side of Server Routing => we don't inlcude `urlToFile` to `./utils.ts`\nimport { urlToFile } from '../utils/urlToFile.js';\nconst pageContextJsonFileExtension = '.pageContext.json';\n// `/some-base-url/index.pageContext.json` instead of `/some-base-url.pageContext.json` in order to comply to common reverse proxy setups, see https://github.com/vikejs/vike/issues/443\nconst doNotCreateExtraDirectory = false;\n// See node/renderPage/handlePageContextRequestUrl.ts\nfunction getPageContextRequestUrl(url) {\n    const pageContextRequestUrl = urlToFile(url, pageContextJsonFileExtension, doNotCreateExtraDirectory);\n    return pageContextRequestUrl;\n}\n","export { assertPageContextProvidedByUser };\nimport { assert, assertUsage, assertWarning, isObject } from './utils.js';\nimport pc from '@brillout/picocolors';\nfunction assertPageContextProvidedByUser(pageContextProvidedByUser, { hookName, hookFilePath }) {\n    if (pageContextProvidedByUser === undefined || pageContextProvidedByUser === null)\n        return;\n    assert(!hookName.endsWith(')'));\n    const errPrefix = `The ${pc.cyan('pageContext')} object provided by the ${hookName}() hook defined by ${hookFilePath}`;\n    assertUsage(isObject(pageContextProvidedByUser), `${errPrefix} should be an object (but it's ${pc.cyan(`typeof pageContext === ${JSON.stringify(typeof pageContextProvidedByUser)}`)} instead)`);\n    assertUsage(!('_objectCreatedByVike' in pageContextProvidedByUser), `${errPrefix} shouldn't be the whole ${pc.cyan('pageContext')} object, see https://vike.dev/pageContext-manipulation#do-not-return-entire-pagecontext`);\n    // In principle, it's possible to use onBeforeRoute()` to override and define the whole routing.\n    // Is that a good idea to allow users to do this? Beyond deep integration with Vue Router or React Router, is there a use case for this?\n    assertWarning(!('_pageId' in pageContextProvidedByUser), `${errPrefix} sets ${pc.cyan('pageContext._pageId')} which means that Vike's routing is overriden. This is an experimental feature: make sure to contact a vike maintainer before using this.`, { onlyOnce: true });\n    assertUsage(!('is404' in pageContextProvidedByUser), `${errPrefix} sets ${pc.cyan('pageContext.is404')} which is forbidden, use ${pc.cyan('throw render()')} instead, see https://vike.dev/render`);\n}\n","export { assertHookReturnedObject };\nimport { assert, assertUsage, stringifyStringArray } from './utils.js';\nfunction assertHookReturnedObject(obj, keysExpected, errPrefix) {\n    assert(!errPrefix.endsWith(' '));\n    const keysUnknown = [];\n    const keys = Object.keys(obj);\n    for (const key of keys) {\n        if (!keysExpected.includes(key)) {\n            keysUnknown.push(key);\n        }\n    }\n    assertUsage(keysUnknown.length === 0, [\n        errPrefix,\n        'returned an object with following unknown keys:',\n        stringifyStringArray(keysUnknown) + '.',\n        'Only following keys are allowed:',\n        stringifyStringArray(keysExpected) + '.'\n    ].join(' '));\n}\n","export { assertOnBeforeRenderHookReturn };\nimport { assertUsage, isPlainObject } from './utils.js';\nimport { assertPageContextProvidedByUser } from './assertPageContextProvidedByUser.js';\nimport { assertHookReturnedObject } from './assertHookReturnedObject.js';\nimport pc from '@brillout/picocolors';\nfunction assertOnBeforeRenderHookReturn(hookReturnValue, hookFilePath) {\n    if (hookReturnValue === undefined || hookReturnValue === null) {\n        return;\n    }\n    const errPrefix = `The onBeforeRender() hook defined by ${hookFilePath}`;\n    assertUsage(isPlainObject(hookReturnValue), `${errPrefix} should return a plain JavaScript object, ${pc.cyan('undefined')}, or ${pc.cyan('null')}`);\n    assertHookReturnedObject(hookReturnValue, ['pageContext'], errPrefix);\n    if (hookReturnValue.pageContext) {\n        assertPageContextProvidedByUser(hookReturnValue['pageContext'], { hookName: 'onBeforeRender', hookFilePath });\n    }\n}\n","import { isPlainObject } from './isPlainObject.js';\nexport { isObjectWithKeys };\nfunction isObjectWithKeys(obj, keys) {\n    if (!isPlainObject(obj)) {\n        return false;\n    }\n    for (const key of Object.keys(obj)) {\n        if (!keys.includes(key)) {\n            return false;\n        }\n    }\n    return true;\n}\n","export function isStringRecord(thing) {\n    return typeof thing === 'object' && thing !== null && Object.values(thing).every((val) => typeof val === 'string');\n}\n","export { joinEnglish };\nimport { assert } from './assert.js';\n// https://stackoverflow.com/questions/53879088/join-an-array-by-commas-and-and/53879103#53879103\nfunction joinEnglish(arr, conjunction, colorizer = (s) => s) {\n    assert(arr.length > 0);\n    if (arr.length === 1)\n        return colorizer(arr[0]);\n    const firsts = arr.slice(0, arr.length - 1);\n    const last = arr[arr.length - 1];\n    return firsts.map(colorizer).join(', ') + ` ${conjunction} ` + colorizer(last);\n}\n","// Utils needed by:\n//  - runtime of server\n//  - runtime of client (Client Routing)\n// Ensure we don't bloat runtime of Server Routing with the utils down below\nimport { assertClientRouting } from '../../utils/assertRoutingType.js';\nimport { isBrowser } from '../../utils/isBrowser.js';\nif (isBrowser()) {\n    assertClientRouting();\n}\nexport * from '../../utils/assert.js';\nexport * from '../../utils/hasProp.js';\nexport * from '../../utils/isObjectWithKeys.js';\nexport * from '../../utils/sorter.js';\nexport * from '../../utils/isPromise.js';\nexport * from '../../utils/isPlainObject.js';\nexport * from '../../utils/objectAssign.js';\nexport * from '../../utils/slice.js';\nexport * from '../../utils/isStringRecord.js';\nexport * from '../../utils/unique.js';\nexport * from '../../utils/isBrowser.js';\nexport * from '../../utils/parseUrl.js';\nexport * from '../hooks/executeHook.js';\nexport * from '../../utils/checkType.js';\nexport * from '../../utils/joinEnglish.js';\nexport * from '../../utils/projectInfo.js';\nexport * from '../../utils/truncateString.js';\nexport * from '../../utils/isCallable.js';\n","export { executeGuardHook };\nimport { getHook, getHookTimeoutDefault } from '../hooks/getHook.js';\nimport { assert, assertUsage, executeHook, isCallable } from './utils.js';\nasync function executeGuardHook(pageContext, prepareForUserConsumption) {\n    let hook;\n    if (pageContext._pageFilesAll.length > 0) {\n        // V0.4 design\n        assert(pageContext._pageConfigs.length === 0);\n        hook = findPageGuard(pageContext._pageId, pageContext._pageFilesAll);\n    }\n    else {\n        // V1 design\n        hook = getHook(pageContext, 'guard');\n    }\n    if (!hook)\n        return;\n    const guard = hook.hookFn;\n    let pageContextForUserConsumption = pageContext;\n    const res = prepareForUserConsumption(pageContext);\n    if (res)\n        pageContextForUserConsumption = res;\n    const hookResult = await executeHook(() => guard(pageContextForUserConsumption), hook);\n    assertUsage(hookResult === undefined, `The guard() hook of ${hook.hookFilePath} returns a value, but guard() doesn't accept any return value`);\n}\nfunction findPageGuard(pageId, pageFilesAll) {\n    const pageRouteFile = pageFilesAll.find((p) => p.pageId === pageId && p.fileType === '.page.route');\n    if (!pageRouteFile)\n        return null;\n    const { filePath, fileExports } = pageRouteFile;\n    assert(fileExports); // loadPageRoutes() should already have been called\n    const hookFn = fileExports.guard;\n    if (!hookFn)\n        return null;\n    const hookFilePath = filePath;\n    const hookTimeout = getHookTimeoutDefault('guard');\n    assertUsage(isCallable(hookFn), `guard() defined by ${hookFilePath} should be a function`);\n    return { hookFn, hookName: 'guard', hookFilePath, hookTimeout };\n}\n","export { redirect };\nexport { render };\nexport { RenderErrorPage };\nexport { isAbortError };\nexport { isAbortPageContext };\nexport { logAbortErrorHandled };\nexport { getPageContextFromAllRewrites };\nexport { AbortRender };\nexport { assertNoInfiniteAbortLoop };\nimport { assert, assertInfo, assertUsage, assertWarning, checkType, hasProp, joinEnglish, objectAssign, projectInfo, truncateString } from './utils.js';\nimport pc from '@brillout/picocolors';\n/**\n * Abort the rendering of the current page, and redirect the user to another URL instead.\n *\n * https://vike.dev/redirect\n *\n * @param url The URL to redirect to.\n * @param statusCode By default a temporary redirection (`302`) is performed. For permanent redirections (`301`), use `config.redirects` https://vike.dev/redirects instead or, alternatively, set the `statusCode` argument to `301`.\n */\nfunction redirect(url, statusCode) {\n    const abortCaller = 'throw redirect()';\n    const args = [JSON.stringify(url)];\n    if (!statusCode) {\n        statusCode = 302;\n    }\n    else {\n        assertStatusCode(statusCode, [301, 302], 'redirect');\n        args.push(String(statusCode));\n    }\n    const pageContextAbort = {};\n    objectAssign(pageContextAbort, {\n        _abortCaller: abortCaller,\n        _abortCall: `throw redirect(${args.join(', ')})`,\n        _urlRedirect: {\n            url,\n            statusCode\n        }\n    });\n    return AbortRender(pageContextAbort);\n}\nfunction render(value, abortReason) {\n    const args = [typeof value === 'number' ? String(value) : JSON.stringify(value)];\n    if (abortReason !== undefined)\n        args.push(truncateString(JSON.stringify(abortReason), 30));\n    const abortCaller = 'throw render()';\n    const abortCall = `throw render(${args.join(', ')})`;\n    return render_(value, abortReason, abortCall, abortCaller);\n}\nfunction render_(value, abortReason, abortCall, abortCaller, pageContextAddendum) {\n    const pageContextAbort = {\n        abortReason,\n        _abortCaller: abortCaller,\n        _abortCall: abortCall\n    };\n    if (pageContextAddendum) {\n        assert(pageContextAddendum._isLegacyRenderErrorPage === true);\n        objectAssign(pageContextAbort, pageContextAddendum);\n    }\n    if (typeof value === 'string') {\n        const url = value;\n        objectAssign(pageContextAbort, {\n            _urlRewrite: url\n        });\n        return AbortRender(pageContextAbort);\n    }\n    else {\n        const abortStatusCode = value;\n        assertStatusCode(value, [401, 403, 404, 410, 429, 500, 503], 'render');\n        objectAssign(pageContextAbort, {\n            abortStatusCode,\n            is404: abortStatusCode === 404\n        });\n        return AbortRender(pageContextAbort);\n    }\n}\nfunction AbortRender(pageContextAbort) {\n    const err = new Error('AbortRender');\n    objectAssign(err, { _pageContextAbort: pageContextAbort, [stamp]: true });\n    checkType(err);\n    return err;\n}\n// TODO/v1-release: remove\n/**\n * @deprecated Use `throw render()` or `throw redirect()` instead, see https://vike.dev/render'\n */\nfunction RenderErrorPage({ pageContext = {} } = {}) {\n    assertWarning(false, `${pc.cyan('throw RenderErrorPage()')} is deprecated and will be removed in the next major release. Use ${pc.cyan('throw render()')} or ${pc.cyan('throw redirect()')} instead, see https://vike.dev/render`, { onlyOnce: false });\n    let abortStatusCode = 404;\n    let abortReason = 'Page Not Found';\n    if (pageContext.is404 === false || pageContext.pageProps?.is404 === false) {\n        abortStatusCode = 500;\n        abortReason = 'Something went wrong';\n    }\n    objectAssign(pageContext, { _isLegacyRenderErrorPage: true });\n    return render_(abortStatusCode, abortReason, 'throw RenderErrorPage()', 'throw RenderErrorPage()', pageContext);\n}\nconst stamp = '_isAbortError';\nfunction isAbortError(thing) {\n    return typeof thing === 'object' && thing !== null && stamp in thing;\n}\nfunction isAbortPageContext(pageContext) {\n    if (!(pageContext._urlRewrite || pageContext._urlRedirect || pageContext.abortStatusCode)) {\n        return false;\n    }\n    assert(hasProp(pageContext, '_abortCall', 'string'));\n    /* Isn't needed and is missing on the client-side\n    assert(hasProp(pageContext, '_abortCaller', 'string'))\n    */\n    checkType(pageContext);\n    return true;\n}\nfunction logAbortErrorHandled(err, isProduction, pageContext) {\n    if (isProduction)\n        return;\n    const urlCurrent = pageContext._urlRewrite ?? pageContext.urlOriginal;\n    assert(urlCurrent);\n    const abortCall = err._pageContextAbort._abortCall;\n    assertInfo(false, `${pc.cyan(abortCall)} intercepted while rendering ${pc.cyan(urlCurrent)}`, { onlyOnce: false });\n}\nfunction assertStatusCode(statusCode, expected, caller) {\n    const expectedEnglish = joinEnglish(expected.map((s) => s.toString()), 'or');\n    assertWarning(expected.includes(statusCode), `Unepexected status code ${statusCode} passed to ${caller}(), we recommend ${expectedEnglish} instead. (Or reach out at ${projectInfo.githubRepository}/issues/1008 if you believe ${statusCode} should be added.)`, { onlyOnce: true });\n}\nfunction getPageContextFromAllRewrites(pageContextsFromRewrite) {\n    assertNoInfiniteLoop(pageContextsFromRewrite);\n    const pageContextFromAllRewrites = { _urlRewrite: null };\n    pageContextsFromRewrite.forEach((pageContextFromRewrite) => {\n        Object.assign(pageContextFromAllRewrites, pageContextFromRewrite);\n    });\n    return pageContextFromAllRewrites;\n}\nfunction assertNoInfiniteLoop(pageContextsFromRewrite) {\n    const urlRewrites = [];\n    pageContextsFromRewrite.forEach((pageContext) => {\n        const urlRewrite = pageContext._urlRewrite;\n        {\n            const idx = urlRewrites.indexOf(urlRewrite);\n            if (idx !== -1) {\n                const loop = [...urlRewrites.slice(idx), urlRewrite].map((url) => `render('${url}')`).join(' => ');\n                assertUsage(false, `Infinite loop of render() calls: ${loop}`);\n            }\n        }\n        urlRewrites.push(urlRewrite);\n    });\n}\nfunction assertNoInfiniteAbortLoop(rewriteCount, redirectCount) {\n    const abortCalls = [\n        // prettier-ignore\n        rewriteCount > 0 && pc.cyan(\"throw render('/some-url')\"),\n        redirectCount > 0 && pc.cyan(\"throw redirect('/some-url')\")\n    ]\n        .filter(Boolean)\n        .join(' and ');\n    assertUsage(rewriteCount + redirectCount <= 7, `Maximum chain length of 7 ${abortCalls} exceeded. Did you define an infinite loop of ${abortCalls}?`);\n}\n","export { getPageContextFromHooks_firstRender };\nexport { getPageContextFromHooks_uponNavigation };\nexport { getPageContextFromHooks_errorPage };\nexport { isAlreadyServerSideRouted };\nimport { assert, assertUsage, hasProp, objectAssign, getProjectError, serverSideRouteTo, executeHook, isObject, getGlobalObject } from './utils.js';\nimport { parse } from '@brillout/json-serializer/parse';\nimport { getPageContextSerializedInHtml } from '../shared/getPageContextSerializedInHtml.js';\nimport { analyzePageServerSide } from '../../shared/getPageFiles/analyzePageServerSide.js';\nimport { getErrorPageId } from '../../shared/error-page.js';\nimport { getHook } from '../../shared/hooks/getHook.js';\nimport { preparePageContextForUserConsumptionClientSide } from '../shared/preparePageContextForUserConsumptionClientSide.js';\nimport { loadPageFilesClientSide } from '../shared/loadPageFilesClientSide.js';\nimport { removeBuiltInOverrides } from './getPageContext/removeBuiltInOverrides.js';\nimport { getPageContextRequestUrl } from '../../shared/getPageContextRequestUrl.js';\nimport { getConfigValue, getPageConfig } from '../../shared/page-configs/helpers.js';\nimport { assertOnBeforeRenderHookReturn } from '../../shared/assertOnBeforeRenderHookReturn.js';\nimport { executeGuardHook } from '../../shared/route/executeGuardHook.js';\nimport { AbortRender, isAbortPageContext } from '../../shared/route/abort.js';\nconst globalObject = getGlobalObject('router/getPageContext.ts', {});\nasync function getPageContextFromHooks_firstRender(pageContext) {\n    const pageContextFromHooks = getPageContextSerializedInHtml();\n    removeBuiltInOverrides(pageContextFromHooks);\n    objectAssign(pageContextFromHooks, {\n        isHydration: true,\n        _hasPageContextFromClient: false\n    });\n    objectAssign(pageContextFromHooks, await loadPageFilesClientSide(pageContextFromHooks._pageId, pageContext));\n    {\n        const pageContextForHook = { ...pageContext, ...pageContextFromHooks };\n        if (onBeforeRenderClientOnlyExists(pageContextForHook)) {\n            const pageContextFromHook = await executeOnBeforeRenderHookClientSide(pageContextForHook);\n            objectAssign(pageContextFromHooks, pageContextFromHook);\n        }\n    }\n    setPageContextInitHasClientData(pageContextFromHooks);\n    return pageContextFromHooks;\n}\nasync function getPageContextFromHooks_errorPage(pageContext) {\n    const errorPageId = getErrorPageId(pageContext._pageFilesAll, pageContext._pageConfigs);\n    if (!errorPageId)\n        throw new Error('No error page defined.');\n    const pageContextFromHooks = {\n        isHydration: false,\n        _pageId: errorPageId\n    };\n    objectAssign(pageContextFromHooks, await getPageContextAlreadyRouted({ ...pageContext, ...pageContextFromHooks }, true));\n    return pageContextFromHooks;\n}\nasync function getPageContextFromHooks_uponNavigation(pageContext) {\n    const pageContextFromHooks = {\n        isHydration: false,\n        _pageId: pageContext._pageId\n    };\n    objectAssign(pageContextFromHooks, await getPageContextAlreadyRouted({ ...pageContext, ...pageContextFromHooks }, false));\n    setPageContextInitHasClientData(pageContextFromHooks);\n    return pageContextFromHooks;\n}\nasync function getPageContextAlreadyRouted(pageContext, isErrorPage) {\n    let pageContextFromHooks = {};\n    objectAssign(pageContextFromHooks, { _hasPageContextFromClient: false });\n    objectAssign(pageContextFromHooks, await loadPageFilesClientSide(pageContext._pageId, pageContext));\n    let pageContextFetchedFromServer = false;\n    // Needs to be called before any client-side hook, because it may contain pageContextInit.user which is needed for guard() and onBeforeRender()\n    if (\n    // For the error page, we cannot fetch pageContext from the server because the pageContext JSON request is based on the URL\n    !isErrorPage &&\n        // true if pageContextInit has some client data or the onBeforeRender hook is server-side only:\n        (await hasPageContextServer({ ...pageContext, ...pageContextFromHooks }))) {\n        const pageContextFromServer = await fetchPageContextFromServer(pageContext);\n        pageContextFetchedFromServer = true;\n        if (!pageContextFromServer['_isError']) {\n            objectAssign(pageContextFromHooks, pageContextFromServer);\n        }\n        else {\n            const errorPageId = getErrorPageId(pageContext._pageFilesAll, pageContext._pageConfigs);\n            assert(errorPageId);\n            pageContextFromHooks = {};\n            objectAssign(pageContextFromHooks, {\n                _hasPageContextFromClient: false,\n                isHydration: false,\n                _pageId: errorPageId\n            });\n            objectAssign(pageContextFromHooks, await loadPageFilesClientSide(pageContextFromHooks._pageId, pageContext));\n            assert(hasProp(pageContextFromServer, 'is404', 'boolean'));\n            assert(hasProp(pageContextFromServer, 'pageProps', 'object'));\n            assert(hasProp(pageContextFromServer.pageProps, 'is404', 'boolean'));\n            // When the user hasn't define a `_error.page.js` file: the mechanism with `serverSideError: true` is used instead\n            assert(!('serverSideError' in pageContextFromServer));\n            objectAssign(pageContextFromHooks, pageContextFromServer);\n        }\n    }\n    else {\n        objectAssign(pageContextFromHooks, { _hasPageContextFromServer: false });\n        // We don't need to call guard() on the client-side if we fetch pageContext from the server side. (Because the `${url}.pageContext.json` HTTP request will already trigger the routing and guard() hook on the serve-side.)\n        // We cannot call guard() before retrieving pageContext from server, since the server-side may define pageContextInit.user which is paramount for guard() hooks\n        if (!isErrorPage) {\n            // Should we really call the guard() hook on the client-side? Shouldn't we make the guard() hook a server-side only hook? Or maybe make its env configurable like onBeforeRender()?\n            await executeGuardHook({\n                ...pageContext,\n                ...pageContextFromHooks\n            }, (pageContext) => preparePageContextForUserConsumptionClientSide(pageContext, true));\n        }\n    }\n    // For the error page, we also execute the client-side onBeforeRender() hook, but maybe we shouldn't? The server-side does it as well (but maybe it shouldn't).\n    {\n        const pageContextForHook = { ...pageContext, ...pageContextFromHooks };\n        if (onBeforeRenderClientOnlyExists(pageContextForHook) || !pageContextFetchedFromServer) {\n            // This won't do anything if no hook has been defined or if the hook's env.client is false.\n            const pageContextFromHook = await executeOnBeforeRenderHookClientSide(pageContextForHook);\n            objectAssign(pageContextFromHooks, pageContextFromHook);\n        }\n        else {\n            assert(pageContextFetchedFromServer);\n        }\n    }\n    return pageContextFromHooks;\n}\nasync function executeOnBeforeRenderHookClientSide(pageContext) {\n    const hook = getHook(pageContext, 'onBeforeRender');\n    if (!hook) {\n        // No hook defined or hook's env.client is false\n        const pageContextFromOnBeforeRender = {\n            _hasPageContextFromClient: false\n        };\n        return pageContextFromOnBeforeRender;\n    }\n    const onBeforeRender = hook.hookFn;\n    const pageContextFromOnBeforeRender = {\n        _hasPageContextFromClient: true\n    };\n    const pageContextForUserConsumption = preparePageContextForUserConsumptionClientSide({\n        ...pageContext,\n        ...pageContextFromOnBeforeRender\n    }, true);\n    const hookResult = await executeHook(() => onBeforeRender(pageContextForUserConsumption), hook);\n    assertOnBeforeRenderHookReturn(hookResult, hook.hookFilePath);\n    const pageContextFromHook = hookResult?.pageContext;\n    objectAssign(pageContextFromOnBeforeRender, pageContextFromHook);\n    return pageContextFromOnBeforeRender;\n}\n// Workaround for the fact that the client-side cannot known whether a pageContext JSON request is needed in order to fetch pageContextInit data passed to the client.\n//  - The workaround is reliable as long as the user sets additional pageContextInit to undefined instead of not defining the property:\n//    ```diff\n//    - // Breaks the workaround:\n//    - const pageContextInit = { urlOriginal: req.url }\n//    - if (user) pageContextInit.user = user\n//    + // Makes the workaround reliable:\n//    + const pageContextInit = { urlOriginal: req.url, user }\n//    ```\n// - We can show a warning to users when the pageContextInit keys aren't always the same. (We didn't implement the waning yet because it would require a new doc page https://vike.dev/pageContextInit#avoid-conditional-properties\n// - Workaround cannot be made completely reliable because the workaround assumes that passToClient is always the same, but the user may set a different passToClient value for another page\n// - Alternatively, we could define a new config `alwaysFetchPageContextFromServer: boolean`\nfunction setPageContextInitHasClientData(pageContext) {\n    if (pageContext._pageContextInitHasClientData) {\n        globalObject.pageContextInitHasClientData = true;\n    }\n}\nasync function hasPageContextServer(pageContext) {\n    return !!globalObject.pageContextInitHasClientData || (await onBeforeRenderServerOnlyExists(pageContext));\n}\nasync function onBeforeRenderServerOnlyExists(pageContext) {\n    if (pageContext._pageConfigs.length > 0) {\n        // V1\n        const pageConfig = getPageConfig(pageContext._pageId, pageContext._pageConfigs);\n        const onBeforeRenderEnv = getConfigValue(pageConfig, 'onBeforeRenderEnv')?.value ?? {};\n        assert(isObject(onBeforeRenderEnv));\n        return !!onBeforeRenderEnv.server && !onBeforeRenderEnv.client;\n    }\n    else {\n        // TODO/v1-release: remove\n        // V0.4\n        const { hasOnBeforeRenderServerSideOnlyHook } = await analyzePageServerSide(pageContext._pageFilesAll, pageContext._pageId);\n        return hasOnBeforeRenderServerSideOnlyHook;\n    }\n}\nfunction onBeforeRenderClientOnlyExists(pageContext) {\n    if (pageContext._pageConfigs.length > 0) {\n        // V1\n        const pageConfig = getPageConfig(pageContext._pageId, pageContext._pageConfigs);\n        const onBeforeRenderEnv = getConfigValue(pageConfig, 'onBeforeRenderEnv')?.value ?? {};\n        assert(isObject(onBeforeRenderEnv));\n        return !!onBeforeRenderEnv.client && !onBeforeRenderEnv.server;\n    }\n    else {\n        // TODO/v1-release: remove\n        // Client-only onBeforeRender() hooks were never supported for the V0.4 design\n        return false;\n    }\n}\nasync function fetchPageContextFromServer(pageContext) {\n    const pageContextUrl = getPageContextRequestUrl(pageContext._urlRewrite ?? pageContext.urlOriginal);\n    const response = await fetch(pageContextUrl);\n    {\n        const contentType = response.headers.get('content-type');\n        const contentTypeCorrect = 'application/json';\n        const isCorrect = contentType && contentType.includes(contentTypeCorrect);\n        // Static hosts + page doesn't exist\n        if (!isCorrect && response.status === 404) {\n            serverSideRouteTo(pageContext.urlOriginal);\n            throw AlreadyServerSideRouted();\n        }\n        assertUsage(isCorrect, `Wrong Content-Type for ${pageContextUrl}: it should be ${contentTypeCorrect} but it's ${contentType} instead. Make sure to properly use pageContext.httpResponse.headers, see https://vike.dev/renderPage`);\n    }\n    const responseText = await response.text();\n    const pageContextFromServer = parse(responseText);\n    assert(isObject(pageContextFromServer));\n    if ('serverSideError' in pageContextFromServer) {\n        throw getProjectError(`The pageContext object couldn't be fetched from the server as an error occurred on the server-side. Check your server logs.`);\n    }\n    if (isAbortPageContext(pageContextFromServer)) {\n        throw AbortRender(pageContextFromServer);\n    }\n    assert(hasProp(pageContextFromServer, '_pageId', 'string'));\n    removeBuiltInOverrides(pageContextFromServer);\n    objectAssign(pageContextFromServer, { _hasPageContextFromServer: true });\n    return pageContextFromServer;\n}\nfunction isAlreadyServerSideRouted(err) {\n    return isObject(err) && !!err._alreadyServerSideRouted;\n}\nfunction AlreadyServerSideRouted() {\n    const err = new Error(\"Page doesn't exist\");\n    Object.assign(err, { _alreadyServerSideRouted: true });\n    return err;\n}\n","// URLs props need to be computed props, because the user can modify the URL e.g. with onBeforeRoute() for i18n\nexport { addUrlComputedProps };\nexport { assertPageContextUrlComputedProps };\nimport { assert, parseUrl, assertWarning, isPlainObject, isPropertyGetter, isBrowser } from './utils.js';\nfunction addUrlComputedProps(pageContext, enumerable = true) {\n    assert(pageContext.urlOriginal);\n    if ('urlPathname' in pageContext) {\n        assert(typeof pageContext.urlPathname === 'string');\n        /* If this assert() fails then it's most likely because Object.assign() was used instead of objectAssign(), i.e.:\n           ```js\n           // Add property getters such as pageContext.urlPathname to pageContext\n           addUrlComputedProps(pageContext)\n           // ❌ Breaks the property getters of pageContext set by addUrlComputedProps() such as pageContext.urlPathname\n           Object.assign(pageContext2, pageContext)\n           // ❌ Also breaks the property getters\n           const pageContext3 = { ...pageContext }\n           // ✅ Preserves property getters of pageContext (see objectAssign() implementation)\n           objectAssign(pageContext2, pageContext)\n           ```\n        */\n        assert(isPropertyGetter(pageContext, 'urlPathname'));\n    }\n    if ('urlParsed' in pageContext)\n        assert(isPropertyGetter(pageContext, 'urlParsed'));\n    // TODO/v1-release: move pageContext.urlParsed to pageContext.url\n    if ('url' in pageContext)\n        assert(isPropertyGetter(pageContext, 'url'));\n    Object.defineProperty(pageContext, 'urlPathname', {\n        get: urlPathnameGetter,\n        enumerable,\n        configurable: true\n    });\n    Object.defineProperty(pageContext, 'url', {\n        get: urlGetter,\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(pageContext, 'urlParsed', {\n        get: urlParsedGetter,\n        enumerable,\n        configurable: true\n    });\n}\nfunction getUrlParsed(pageContext) {\n    // We need a url handler function because the onBeforeRoute() hook may set pageContext.urlLogical (typically for i18n)\n    let urlHandler = pageContext._urlHandler;\n    if (!urlHandler) {\n        urlHandler = (url) => url;\n    }\n    let urlResolved = pageContext._urlRewrite ?? pageContext.urlLogical ?? pageContext.urlOriginal;\n    urlResolved = urlHandler(urlResolved);\n    const baseServer = pageContext._baseServer;\n    assert(urlResolved && typeof urlResolved === 'string');\n    assert(baseServer.startsWith('/'));\n    return parseUrl(urlResolved, baseServer);\n}\nfunction urlPathnameGetter() {\n    const { pathname } = getUrlParsed(this);\n    const urlPathname = pathname;\n    assert(urlPathname.startsWith('/'));\n    return urlPathname;\n}\nfunction urlGetter() {\n    // TODO/v1-release: remove\n    assertWarning(false, '`pageContext.url` is outdated. Use `pageContext.urlPathname`, `pageContext.urlParsed`, or `pageContext.urlOriginal` instead. (See https://vike.dev/migration/0.4.23 for more information.)', { onlyOnce: true, showStackTrace: true });\n    return urlPathnameGetter.call(this);\n}\nfunction urlParsedGetter() {\n    const urlParsedOriginal = getUrlParsed(this);\n    const { origin, pathname, pathnameOriginal, search, searchAll, searchOriginal, hash, hashOriginal } = urlParsedOriginal;\n    const hashIsAvailable = isBrowser();\n    const warnHashNotAvailable = (prop) => {\n        assertWarning(hashIsAvailable, `pageContext.urlParsed.${prop} isn't available on the server-side (HTTP requests don't include the URL hash by design)`, { onlyOnce: true, showStackTrace: true });\n    };\n    const urlParsed = {\n        origin,\n        pathname,\n        pathnameOriginal,\n        search,\n        searchAll,\n        searchOriginal,\n        get hash() {\n            warnHashNotAvailable('hash');\n            return hash;\n        },\n        get hashOriginal() {\n            warnHashNotAvailable('hashOriginal');\n            return hashOriginal;\n        },\n        get hashString() {\n            assertWarning(false, 'pageContext.urlParsed.hashString has been renamed to pageContext.urlParsed.hashOriginal', {\n                onlyOnce: true,\n                showStackTrace: true\n            });\n            warnHashNotAvailable('hashString');\n            return hashOriginal;\n        },\n        get searchString() {\n            assertWarning(false, 'pageContext.urlParsed.searchString has been renamed to pageContext.urlParsed.searchOriginal', { onlyOnce: true, showStackTrace: true });\n            return searchOriginal;\n        }\n    };\n    makeNonEnumerable(urlParsed, 'hashString');\n    makeNonEnumerable(urlParsed, 'searchString');\n    if (!hashIsAvailable) {\n        makeNonEnumerable(urlParsed, 'hash');\n        makeNonEnumerable(urlParsed, 'hashOriginal');\n    }\n    return urlParsed;\n}\nfunction makeNonEnumerable(obj, prop) {\n    const descriptor = Object.getOwnPropertyDescriptor(obj, prop);\n    Object.defineProperty(obj, prop, { ...descriptor, enumerable: false });\n}\nfunction assertPageContextUrlComputedProps(pageContext) {\n    assert(typeof pageContext.urlOriginal === 'string');\n    assert(typeof pageContext.urlPathname === 'string');\n    assert(isPlainObject(pageContext.urlParsed));\n    assert(pageContext.urlPathname === pageContext.urlParsed.pathname);\n}\n","// Unit tests at ./deduceRouteStringFromFilesystemPath.spec.ts\nimport { assert, higherFirst, slice } from './utils.js';\nexport { deduceRouteStringFromFilesystemPath };\n// TODO/next-major-update: remove this and whole filesystemRoot mechanism\nfunction deduceRouteStringFromFilesystemPath(pageId, filesystemRoots) {\n    // Handle Filesystem Routing Root\n    const filesystemRootsMatch = filesystemRoots\n        .filter(({ filesystemRoot }) => pageId.startsWith(filesystemRoot))\n        .sort(higherFirst(({ filesystemRoot }) => filesystemRoot.length));\n    const fsBase = filesystemRootsMatch[0];\n    let filesystemRoute;\n    if (fsBase) {\n        // Example values:\n        //  - `{\"pageId\":\"/pages/index\",\"filesystemRoot\":\"/\",\"urlRoot\":\"/client_portal\"}`\n        const { filesystemRoot, urlRoot } = fsBase;\n        const debugInfo = { pageId, filesystemRoot, urlRoot };\n        assert(urlRoot.startsWith('/') && pageId.startsWith('/') && filesystemRoot.startsWith('/'), debugInfo);\n        assert(pageId.startsWith(filesystemRoot), debugInfo);\n        if (filesystemRoot !== '/') {\n            assert(!filesystemRoot.endsWith('/'), debugInfo);\n            filesystemRoute = slice(pageId, filesystemRoot.length, 0);\n        }\n        else {\n            filesystemRoute = pageId;\n        }\n        assert(filesystemRoute.startsWith('/'), debugInfo);\n        filesystemRoute = urlRoot + (urlRoot.endsWith('/') ? '' : '/') + slice(filesystemRoute, 1, 0);\n    }\n    else {\n        filesystemRoute = pageId;\n    }\n    assert(filesystemRoute.startsWith('/'));\n    // Remove `pages/`, `index/, and `src/`, directories\n    filesystemRoute = filesystemRoute\n        .split('/')\n        .filter((dir) => dir !== 'pages' && dir !== 'src' && dir !== 'index')\n        .join('/');\n    // Hanlde `/index.page.*` suffix\n    assert(!filesystemRoute.includes('.page.'));\n    assert(!filesystemRoute.endsWith('.'));\n    if (filesystemRoute.endsWith('/index')) {\n        filesystemRoute = slice(filesystemRoute, 0, -'/index'.length);\n    }\n    if (filesystemRoute === '') {\n        filesystemRoute = '/';\n    }\n    assert(filesystemRoute.startsWith('/'));\n    assert(!filesystemRoute.endsWith('/') || filesystemRoute === '/');\n    return filesystemRoute;\n}\n","export { resolveRouteFunction };\nexport { assertRouteParams };\nexport { assertSyncRouting };\nexport { warnDeprecatedAllowKey };\nimport { assertPageContextUrlComputedProps } from '../addUrlComputedProps.js';\nimport { assert, assertUsage, assertWarning, hasProp, isPlainObject, isPromise, isStringRecord } from './utils.js';\nimport pc from '@brillout/picocolors';\nasync function resolveRouteFunction(routeFunction, pageContext, routeDefinedAt) {\n    assertPageContextUrlComputedProps(pageContext);\n    let result = routeFunction(pageContext);\n    assertSyncRouting(result, `The Route Function ${routeDefinedAt}`);\n    // TODO/v1-release: make resolveRouteFunction() and route() sync\n    //* We disallow asynchronous routing, because we need to check whether a link is a Vike link in a synchronous fashion before calling ev.preventDefault() in the 'click' event listener\n    result = await result;\n    //*/\n    if (result === false) {\n        return null;\n    }\n    if (result === true) {\n        result = {};\n    }\n    assertUsage(isPlainObject(result), `The Route Function ${routeDefinedAt} should return a boolean or a plain JavaScript object (but it's ${pc.cyan(`typeof result === ${JSON.stringify(typeof result)}`)} instead)`);\n    // AFAICT this return interface is superfluous. Should we soft-deprecate it and remove it?\n    if ('match' in result) {\n        const { match } = result;\n        assertUsage(typeof match === 'boolean', `The ${pc.cyan('match')} value returned by the Route Function ${routeDefinedAt} should be a boolean.`);\n        if (!match) {\n            return null;\n        }\n    }\n    let precedence = null;\n    if ('precedence' in result) {\n        precedence = result.precedence;\n        assertUsage(typeof precedence === 'number', `The ${pc.cyan('precedence')} value returned by the Route Function ${routeDefinedAt} should be a number.`);\n    }\n    assertRouteParams(result, `The ${pc.cyan('routeParams')} object returned by the Route Function ${routeDefinedAt} should`);\n    const routeParams = result.routeParams || {};\n    assertUsage(!('pageContext' in result), `Providing ${pc.cyan('pageContext')} in Route Functions is prohibited, see https://vike.dev/route-function#cannot-provide-pagecontext`);\n    assert(isPlainObject(routeParams));\n    Object.keys(result).forEach((key) => {\n        assertUsage(key === 'match' || key === 'routeParams' || key === 'precedence', `The Route Function ${routeDefinedAt} returned an object with an unknown property ${pc.cyan(key)} (the known properties are ${pc.cyan('match')}, ${pc.cyan('routeParams')}, and ${pc.cyan('precedence')})`);\n    });\n    return {\n        precedence,\n        routeParams\n    };\n}\n// TODO/v1-release: remove, and make routing synchronous (enabling Vike to synchronously check whether a link is a Vike link before even calling ev.preventDefault())\nfunction assertSyncRouting(res, errPrefix) {\n    assertWarning(!isPromise(res), `${errPrefix} returned a promise, but asynchronous routing is deprecated and will be removed in the next major release, see https://vike.dev/route-function#async`, { onlyOnce: true });\n}\n// TODO/v1-release: remove\nfunction warnDeprecatedAllowKey() {\n    const allowKey = pc.cyan('iKnowThePerformanceRisksOfAsyncRouteFunctions');\n    assertWarning(false, `${allowKey} is deprecated and will be removed in the next major release`, { onlyOnce: true });\n}\nfunction assertRouteParams(result, errPrefix) {\n    assert(errPrefix.endsWith(' should'));\n    if (!hasProp(result, 'routeParams')) {\n        return;\n    }\n    assert(errPrefix.endsWith(' should'));\n    assertUsage(isPlainObject(result.routeParams), `${errPrefix} be a plain JavaScript object.`);\n    assertUsage(isStringRecord(result.routeParams), `${errPrefix} only hold string values.`);\n}\n","export { loadPageRoutes };\nimport { isErrorPageId } from '../error-page.js';\nimport { assert, assertUsage, hasProp, slice } from './utils.js';\nimport { deduceRouteStringFromFilesystemPath } from './deduceRouteStringFromFilesystemPath.js';\nimport { isCallable } from '../utils.js';\nimport { getConfigValue, getDefinedAtString } from '../page-configs/helpers.js';\nimport { warnDeprecatedAllowKey } from './resolveRouteFunction.js';\nimport { getHookFromPageConfigGlobal, getHookTimeoutDefault } from '../hooks/getHook.js';\nasync function loadPageRoutes(\n// Remove all arguments and use GlobalContext instead?\npageFilesAll, pageConfigs, pageConfigGlobal, allPageIds) {\n    await Promise.all(pageFilesAll.filter((p) => p.fileType === '.page.route').map((p) => p.loadFile?.()));\n    const { onBeforeRouteHook, filesystemRoots } = getGlobalHooks(pageFilesAll, pageConfigs, pageConfigGlobal);\n    const pageRoutes = getPageRoutes(filesystemRoots, pageFilesAll, pageConfigs, allPageIds);\n    return { pageRoutes, onBeforeRouteHook };\n}\nfunction getPageRoutes(filesystemRoots, pageFilesAll, pageConfigs, allPageIds) {\n    const pageRoutes = [];\n    let pageIds = [...allPageIds];\n    // V1 Design\n    if (pageConfigs.length > 0) {\n        assert(filesystemRoots === null);\n        const comesFromV1PageConfig = true;\n        pageConfigs\n            .filter((p) => !p.isErrorPage)\n            .forEach((pageConfig) => {\n            const pageId = pageConfig.pageId;\n            pageIds = removePageId(pageIds, pageId);\n            let pageRoute = null;\n            {\n                const configName = 'route';\n                const configValue = getConfigValue(pageConfig, configName);\n                if (configValue) {\n                    const route = configValue.value;\n                    const definedAt = getDefinedAtString(configValue.definedAt, configName);\n                    if (typeof route === 'string') {\n                        pageRoute = {\n                            pageId,\n                            comesFromV1PageConfig,\n                            routeString: route,\n                            routeDefinedAt: definedAt,\n                            routeType: 'STRING'\n                        };\n                    }\n                    else {\n                        assert(isCallable(route));\n                        if (getConfigValue(pageConfig, 'iKnowThePerformanceRisksOfAsyncRouteFunctions', 'boolean'))\n                            warnDeprecatedAllowKey();\n                        pageRoute = {\n                            pageId,\n                            comesFromV1PageConfig,\n                            routeFunction: route,\n                            routeDefinedAt: definedAt,\n                            routeType: 'FUNCTION'\n                        };\n                    }\n                }\n            }\n            if (!pageRoute) {\n                const { routeFilesystem } = pageConfig;\n                assert(routeFilesystem);\n                const { routeString, definedBy } = routeFilesystem;\n                assert(routeFilesystem.routeString.startsWith('/'));\n                pageRoute = {\n                    pageId,\n                    routeFilesystemDefinedBy: definedBy,\n                    comesFromV1PageConfig,\n                    routeString,\n                    routeDefinedAt: null,\n                    routeType: 'FILESYSTEM'\n                };\n            }\n            assert(pageRoute);\n            pageRoutes.push(pageRoute);\n        });\n    }\n    // Old design\n    // TODO/v1-release: remove\n    if (pageConfigs.length === 0) {\n        assert(filesystemRoots);\n        const comesFromV1PageConfig = false;\n        pageIds\n            .filter((pageId) => !isErrorPageId(pageId, false))\n            .forEach((pageId) => {\n            const pageRouteFile = pageFilesAll.find((p) => p.pageId === pageId && p.fileType === '.page.route');\n            if (!pageRouteFile || !('default' in pageRouteFile.fileExports)) {\n                const routeString = deduceRouteStringFromFilesystemPath(pageId, filesystemRoots);\n                assert(routeString.startsWith('/'));\n                assert(!routeString.endsWith('/') || routeString === '/');\n                pageRoutes.push({\n                    pageId,\n                    comesFromV1PageConfig,\n                    routeString,\n                    routeDefinedAt: null,\n                    routeFilesystemDefinedBy: `${pageId}.page.*`,\n                    routeType: 'FILESYSTEM'\n                });\n            }\n            else {\n                const { filePath, fileExports } = pageRouteFile;\n                assert(fileExports.default);\n                if (hasProp(fileExports, 'default', 'string')) {\n                    const routeString = fileExports.default;\n                    assertUsage(routeString.startsWith('/'), `A Route String should start with a leading slash '/' but ${filePath} has \\`export default '${routeString}'\\`. Make sure to \\`export default '/${routeString}'\\` instead.`);\n                    pageRoutes.push({\n                        pageId,\n                        comesFromV1PageConfig,\n                        routeString,\n                        routeDefinedAt: filePath,\n                        routeType: 'STRING'\n                    });\n                    return;\n                }\n                if (hasProp(fileExports, 'default', 'function')) {\n                    const routeFunction = fileExports.default;\n                    {\n                        const allowKey = 'iKnowThePerformanceRisksOfAsyncRouteFunctions';\n                        if (allowKey in fileExports) {\n                            warnDeprecatedAllowKey();\n                        }\n                    }\n                    pageRoutes.push({\n                        pageId,\n                        comesFromV1PageConfig,\n                        routeFunction,\n                        routeDefinedAt: filePath,\n                        routeType: 'FUNCTION'\n                    });\n                    return;\n                }\n                assertUsage(false, `The default export of ${filePath} should be a string or a function.`);\n            }\n        });\n    }\n    return pageRoutes;\n}\nfunction getGlobalHooks(pageFilesAll, pageConfigs, pageConfigGlobal) {\n    // V1 Design\n    if (pageConfigs.length > 0) {\n        const hook = getHookFromPageConfigGlobal(pageConfigGlobal, 'onBeforeRoute');\n        return { onBeforeRouteHook: hook, filesystemRoots: null };\n    }\n    // Old design\n    // TODO/v1-release: remove\n    let onBeforeRouteHook = null;\n    const filesystemRoots = [];\n    pageFilesAll\n        .filter((p) => p.fileType === '.page.route' && p.isDefaultPageFile)\n        .forEach(({ filePath, fileExports }) => {\n        assert(fileExports);\n        if ('onBeforeRoute' in fileExports) {\n            assertUsage(hasProp(fileExports, 'onBeforeRoute', 'function'), `\\`export { onBeforeRoute }\\` of ${filePath} should be a function.`);\n            const { onBeforeRoute } = fileExports;\n            const hookName = 'onBeforeRoute';\n            onBeforeRouteHook = {\n                hookFilePath: filePath,\n                hookFn: onBeforeRoute,\n                hookName,\n                hookTimeout: getHookTimeoutDefault(hookName)\n            };\n        }\n        if ('filesystemRoutingRoot' in fileExports) {\n            assertUsage(hasProp(fileExports, 'filesystemRoutingRoot', 'string'), `\\`export { filesystemRoutingRoot }\\` of ${filePath} should be a string.`);\n            assertUsage(hasProp(fileExports, 'filesystemRoutingRoot', 'string'), `\\`export { filesystemRoutingRoot }\\` of ${filePath} is \\`'${fileExports.filesystemRoutingRoot}'\\` but it should start with a leading slash \\`/\\`.`);\n            filesystemRoots.push({\n                filesystemRoot: dirname(filePath),\n                urlRoot: fileExports.filesystemRoutingRoot\n            });\n        }\n    });\n    return { onBeforeRouteHook, filesystemRoots };\n}\nfunction dirname(filePath) {\n    assert(filePath.startsWith('/'));\n    assert(!filePath.endsWith('/'));\n    const paths = filePath.split('/');\n    const dirPath = slice(paths, 0, -1).join('/') || '/';\n    assert(dirPath.startsWith('/'));\n    assert(!dirPath.endsWith('/') || dirPath === '/');\n    return dirPath;\n}\nfunction removePageId(pageIds, pageId) {\n    const { length } = pageIds;\n    pageIds = pageIds.filter((id) => id !== pageId);\n    assert(pageIds.length === length - 1);\n    return pageIds;\n}\n","export { getBaseServer };\nimport { assert } from '../server-routing-runtime/utils.js';\nfunction getBaseServer() {\n    // @ts-ignore Since dist/cjs/client/ is never used, we can ignore this error.\n    const baseServer = import.meta.env.BASE_SERVER;\n    assert(isBaseServer(baseServer));\n    return baseServer;\n}\n// We don't use isBaseServer() defined in utils/parseUrl.ts to avoid loading the whole file in the browser\nfunction isBaseServer(baseServer) {\n    return baseServer.startsWith('/');\n}\n","export { createPageContext };\nimport { addUrlComputedProps } from '../../shared/addUrlComputedProps.js';\nimport { getPageFilesAll } from '../../shared/getPageFiles.js';\nimport { loadPageRoutes } from '../../shared/route/loadPageRoutes.js';\nimport { getBaseServer } from './getBaseServer.js';\nimport { assert, isBaseServer, getGlobalObject } from './utils.js';\nconst globalObject = getGlobalObject('createPageContext.ts', {});\nasync function createPageContext(urlOriginal) {\n    if (!globalObject.pageFilesData) {\n        globalObject.pageFilesData = await getPageFilesAll(true);\n    }\n    const { pageFilesAll, allPageIds, pageConfigs, pageConfigGlobal } = globalObject.pageFilesData;\n    const { pageRoutes, onBeforeRouteHook } = await loadPageRoutes(pageFilesAll, pageConfigs, pageConfigGlobal, allPageIds);\n    const baseServer = getBaseServer();\n    assert(isBaseServer(baseServer));\n    // @ts-ignore Since dist/cjs/client/ is never used, we can ignore this error.\n    const isProd = import.meta.env.PROD;\n    const pageContext = {\n        urlOriginal,\n        _objectCreatedByVike: true,\n        _urlHandler: null,\n        _urlRewrite: null,\n        _baseServer: baseServer,\n        _isProduction: isProd,\n        _pageFilesAll: pageFilesAll,\n        _pageConfigs: pageConfigs,\n        _pageConfigGlobal: pageConfigGlobal,\n        _allPageIds: allPageIds,\n        _pageRoutes: pageRoutes,\n        _onBeforeRouteHook: onBeforeRouteHook\n    };\n    addUrlComputedProps(pageContext);\n    return pageContext;\n}\n","export { skipLink };\nimport { getBaseServer } from './getBaseServer.js';\nimport { assert, parseUrl, isBaseServer, isParsable, isExternalLink } from './utils.js';\nfunction skipLink(linkTag) {\n    const url = linkTag.getAttribute('href');\n    if (url === null)\n        return true;\n    if (url === '')\n        return true;\n    if (isExternalLink(url))\n        return true;\n    if (isNewTabLink(linkTag))\n        return true;\n    if (isHashUrl(url))\n        return true;\n    if (!hasBaseServer(url)) {\n        return true;\n    }\n    if (!isParsable(url)) {\n        return true;\n    }\n    // Purposely last because disableAutomaticLinkInterception will be removed in the major release\n    if (!isVikeLink(linkTag))\n        return true;\n    return false;\n}\n// TODO/v1-release: remove this in favor of synchronously checking whether URL matches the route of a page (possible since Async Route Functions will be deprecated)\nfunction isVikeLink(linkTag) {\n    const disableAutomaticLinkInterception = isDisableAutomaticLinkInterception();\n    if (!disableAutomaticLinkInterception) {\n        return true;\n    }\n    else {\n        const target = linkTag.getAttribute('data-vike-link');\n        return target !== null && target !== 'false';\n    }\n}\nfunction isNewTabLink(linkTag) {\n    const target = linkTag.getAttribute('target');\n    const rel = linkTag.getAttribute('rel');\n    return target === '_blank' || target === '_external' || rel === 'external' || linkTag.hasAttribute('download');\n}\nfunction isHashUrl(url) {\n    if (url.startsWith('#')) {\n        return true;\n    }\n    const removeHash = (url) => url.split('#')[0];\n    if (url.includes('#') && removeHash(url) === removeHash(window.location.href)) {\n        return true;\n    }\n    return false;\n}\nfunction hasBaseServer(url) {\n    const baseServer = getBaseServer();\n    assert(isBaseServer(baseServer));\n    const { hasBaseServer } = parseUrl(url, baseServer);\n    return hasBaseServer;\n}\nfunction isDisableAutomaticLinkInterception() {\n    // @ts-ignore\n    return !!window._disableAutomaticLinkInterception;\n    /* globalObject should be used if we want to make disableAutomaticLinkInterception a page-by-page setting\n    return globalObject.disableAutomaticLinkInterception ?? false\n    */\n}\n","export { getPrefetchSettings };\nimport { assert, assertUsage, assertInfo, assertWarning, isPlainObject } from '../utils.js';\nfunction getPrefetchSettings(pageContext, linkTag) {\n    let prefetchStaticAssets = getPrefetchStaticAssets(pageContext, linkTag);\n    if (prefetchStaticAssets === 'viewport' && !pageContext._isProduction) {\n        assertInfo(false, 'Viewport prefetching is disabled in development', { onlyOnce: true });\n        prefetchStaticAssets = 'hover';\n    }\n    return {\n        prefetchStaticAssets\n    };\n}\nfunction getPrefetchStaticAssets(pageContext, linkTag) {\n    {\n        const prefetchAttribute = getPrefetchAttribute(linkTag);\n        if (prefetchAttribute !== null)\n            return prefetchAttribute;\n    }\n    // TODO/v1-release: remove\n    if ('prefetchLinks' in pageContext.exports) {\n        assertUsage(false, '`export { prefetchLinks }` is deprecated, use `export { prefetchStaticAssets }` instead.');\n    }\n    if ('prefetchStaticAssets' in pageContext.exports) {\n        const { prefetchStaticAssets } = pageContext.exports;\n        if (prefetchStaticAssets === false) {\n            return false;\n        }\n        if (prefetchStaticAssets === 'hover') {\n            return 'hover';\n        }\n        if (prefetchStaticAssets === 'viewport') {\n            return 'viewport';\n        }\n        const wrongUsageMsg = \"prefetchStaticAssets value should be false, 'hover', or 'viewport'\";\n        // TODO/v1-release: remove\n        assertUsage(isPlainObject(prefetchStaticAssets), wrongUsageMsg);\n        const keys = Object.keys(prefetchStaticAssets);\n        assertUsage(keys.length === 1 && keys[0] === 'when', wrongUsageMsg);\n        const { when } = prefetchStaticAssets;\n        if (when === 'HOVER' || when === 'VIEWPORT') {\n            const correctValue = when.toLowerCase();\n            assertWarning(false, `prefetchStaticAssets value \\`{ when: '${when}' }\\` is outdated: set prefetchStaticAssets to '${correctValue}' instead`, { onlyOnce: true });\n            return correctValue;\n        }\n        assertUsage(false, wrongUsageMsg);\n    }\n    return 'hover';\n}\nfunction getPrefetchAttribute(linkTag) {\n    const attr = linkTag.getAttribute('data-prefetch-static-assets');\n    const attrOld = linkTag.getAttribute('data-prefetch');\n    if (attr === null && attrOld === null) {\n        return null;\n    }\n    // TODO/v1-release: remove\n    const deprecationNotice = 'The attribute data-prefetch is outdated, use data-prefetch-static-assets instead.';\n    if (attr) {\n        assertUsage(attrOld === null, deprecationNotice);\n        if (attr === 'hover' || attr === 'viewport') {\n            return attr;\n        }\n        if (attr === 'false') {\n            return false;\n        }\n        assertUsage(false, `data-prefetch-static-assets has value \"${attr}\" but it should instead be \"false\", \"hover\", or \"viewport\"`);\n    }\n    // TODO/v1-release: remove\n    if (attrOld) {\n        assert(!attr);\n        assertWarning(false, deprecationNotice, {\n            onlyOnce: true\n        });\n        if (attrOld === 'true') {\n            return 'viewport';\n        }\n        if (attrOld === 'false') {\n            return 'hover';\n        }\n        assertUsage(false, `data-prefetch has value \"${attrOld}\" but it should instead be \"true\" or \"false\"`);\n    }\n    assert(false);\n}\n","export { isAlreadyPrefetched };\nexport { markAsAlreadyPrefetched };\nimport { parseUrl } from '../utils.js';\nconst linkAlreadyPrefetched = new Map();\nfunction isAlreadyPrefetched(url) {\n    const urlPathname = getUrlPathname(url);\n    return linkAlreadyPrefetched.has(urlPathname);\n}\nfunction markAsAlreadyPrefetched(url) {\n    const urlPathname = getUrlPathname(url);\n    linkAlreadyPrefetched.set(urlPathname, true);\n}\nfunction getUrlPathname(url) {\n    const urlPathname = parseUrl(url, '/').pathname;\n    return urlPathname;\n}\n","export { getExportNames };\nimport { assert } from '../../utils.js';\nfunction getExportNames(p) {\n    if (p.fileType === '.css') {\n        return [];\n    }\n    if (p.exportNames) {\n        return p.exportNames;\n    }\n    assert(p.fileExports, p.filePath);\n    const exportNames = Object.keys(p.fileExports);\n    return exportNames;\n}\n","export { analyzeExports };\nimport { getExportNames } from './getExportNames.js';\nimport { assertUsage } from '../../utils.js';\n// TODO/v1-release: remove\nfunction analyzeExports({ pageFilesClientSide, pageFilesServerSide, pageId }) {\n    return { isHtmlOnly: isHtmlOnly(), isClientRouting: isClientRouting() };\n    function isHtmlOnly() {\n        {\n            const hasPageIdIsmrphFile = pageFilesServerSide.some((p) => p.pageId === pageId && p.fileType === '.page');\n            if (hasPageIdIsmrphFile) {\n                assertClientSideRenderHook();\n                return false;\n            }\n        }\n        {\n            const hasPageIdServerFile = pageFilesServerSide.some((p) => p.pageId === pageId && p.fileType === '.page.server');\n            if (!hasPageIdServerFile) {\n                return false;\n            }\n        }\n        {\n            const definesClientRenderer = pageFilesClientSide.some((p) => p.pageId === pageId && p.fileType === '.page.client' && getExportNames(p).includes('render'));\n            if (definesClientRenderer) {\n                return false;\n            }\n        }\n        return true;\n    }\n    function assertClientSideRenderHook() {\n        const hasClientSideRenderHook = pageFilesClientSide.some((p) => {\n            return getExportNames(p).includes('render');\n        });\n        assertUsage(hasClientSideRenderHook, [\n            'No client-side `render()` hook found.',\n            'See https://vike.dev/render-modes for more information.',\n            [\n                'Loaded client-side page files (none of them `export { render }`):',\n                ...pageFilesClientSide.map((p, i) => ` (${i + 1}): ${p.filePath}`)\n            ].join('\\n')\n        ].join(' '));\n    }\n    function isClientRouting() {\n        const hasClientRoutingExport = pageFilesClientSide.some((p) => {\n            return getExportNames(p).includes('clientRouting');\n        });\n        return hasClientRoutingExport;\n    }\n}\n","// TODO/v1-release: remove\nexport { determineClientEntry };\nexport { getVikeClientEntry };\nfunction determineClientEntry({ pageFilesClientSide, pageFilesServerSide, isHtmlOnly, isClientRouting }) {\n    let clientEntries = [];\n    const pageFilesServerSideOnly = pageFilesServerSide.filter((p) => !pageFilesClientSide.includes(p));\n    const clientDependencies = [];\n    clientDependencies.push(...pageFilesClientSide.map((p) => ({ id: p.filePath, onlyAssets: false, eagerlyImported: false })));\n    // CSS & assets\n    clientDependencies.push(...pageFilesServerSideOnly.map((p) => ({ id: p.filePath, onlyAssets: true, eagerlyImported: false })));\n    // Handle SPA & SSR pages.\n    if (isHtmlOnly) {\n        clientEntries = pageFilesClientSide.map((p) => p.filePath);\n    }\n    else {\n        // Add the vike client entry\n        const clientEntry = getVikeClientEntry(isClientRouting);\n        clientDependencies.push({ id: clientEntry, onlyAssets: false, eagerlyImported: false });\n        clientEntries = [clientEntry];\n    }\n    // console.log(pageFilesClientSide, pageFilesServerSide, clientDependencies, clientEntry)\n    return { clientEntries, clientDependencies };\n}\nfunction getVikeClientEntry(isClientRouting) {\n    return isClientRouting\n        ? '@@vike/dist/esm/client/client-routing-runtime/entry.js'\n        : '@@vike/dist/esm/client/server-routing-runtime/entry.js';\n}\n","export { analyzePageClientSide };\nexport { analyzePageClientSideInit };\nimport { analyzeExports } from './analyzePageClientSide/analyzeExports.js';\nimport { determineClientEntry } from './analyzePageClientSide/determineClientEntry.js';\nimport { getPageFilesClientSide } from './getAllPageIdFiles.js';\nimport { getPageFilesServerSide } from './getAllPageIdFiles.js';\nimport { assert } from '../utils.js';\nimport { getExportNames } from './analyzePageClientSide/getExportNames.js';\n// TODO/v1-release: remove analyzePageClientSide(), use analyzeClientSide() instead\nfunction analyzePageClientSide(pageFilesAll, pageId) {\n    let pageFilesClientSide = getPageFilesClientSide(pageFilesAll, pageId);\n    const pageFilesServerSide = getPageFilesServerSide(pageFilesAll, pageId);\n    const { isHtmlOnly, isClientRouting } = analyzeExports({ pageFilesClientSide, pageFilesServerSide, pageId });\n    if (isHtmlOnly) {\n        // HTML-only pages don't need any client-side `render()` hook. For apps that have both HTML-only and SSR/SPA pages, we skip the `.page.client.js` file that defines `render()` for HTML-only pages.\n        pageFilesClientSide = pageFilesClientSide.filter((p) => p.isEnv('CLIENT_ONLY') && !getExportNames(p).includes('render'));\n        pageFilesClientSide = removeOverridenPageFiles(pageFilesClientSide);\n    }\n    const { clientEntries, clientDependencies } = determineClientEntry({\n        pageFilesClientSide,\n        pageFilesServerSide,\n        isHtmlOnly,\n        isClientRouting\n    });\n    return { isHtmlOnly, isClientRouting, clientEntries, clientDependencies, pageFilesClientSide, pageFilesServerSide };\n}\n// TODO:v1-release: remove\nasync function analyzePageClientSideInit(pageFilesAll, pageId, { sharedPageFilesAlreadyLoaded }) {\n    const pageFilesClientSide = getPageFilesClientSide(pageFilesAll, pageId);\n    await Promise.all(pageFilesClientSide.map(async (p) => {\n        assert(p.isEnv('CLIENT_ONLY') || p.isEnv('CLIENT_AND_SERVER'));\n        if (sharedPageFilesAlreadyLoaded && p.isEnv('CLIENT_AND_SERVER')) {\n            return;\n        }\n        // TODO: Is `loadExportNames()` cached ? Does it use filesExports if possible? HMR?\n        await p.loadExportNames?.();\n        /*\n        if (pageFile.exportNames) {\n          return pageFile.exportNames.includes(clientRouting)\n        }\n        if (pageFile.fileExports) {\n          return Object.keys(pageFile.fileExports).includes(clientRouting)\n        }\n        */\n    }));\n}\n// [WIP] Just an experiment needed by https://vike.dev/banner\n//  - Not sure I want to make something like a public API: the CSS of `_default.page.server.js` are still loaded -> weird DX.\nfunction removeOverridenPageFiles(pageFilesClientSide) {\n    const pageFilesClientSide_ = [];\n    for (const p of pageFilesClientSide) {\n        pageFilesClientSide_.push(p);\n        if (getExportNames(p).includes('overrideDefaultPages')) {\n            break;\n        }\n    }\n    return pageFilesClientSide_;\n}\n","export { analyzeClientSide };\nimport { getConfigValue } from '../page-configs/helpers.js';\nimport { analyzePageClientSide } from './analyzePageClientSide.js';\nfunction analyzeClientSide(pageConfig, pageFilesAll, pageId) {\n    // V1 design\n    if (pageConfig) {\n        const isClientRouting = getConfigValue(pageConfig, 'clientRouting', 'boolean')?.value ?? false;\n        const isClientSideRenderable = getConfigValue(pageConfig, 'isClientSideRenderable', 'boolean')?.value ?? false;\n        return { isClientSideRenderable, isClientRouting };\n    }\n    else {\n        // TODO/v1-release: remove\n        // V0.4 design\n        const { isHtmlOnly, isClientRouting } = analyzePageClientSide(pageFilesAll, pageId);\n        return { isClientSideRenderable: !isHtmlOnly, isClientRouting };\n    }\n}\n","export { isClientSideRoutable };\nimport { analyzePageClientSideInit } from '../../shared/getPageFiles/analyzePageClientSide.js';\nimport { findPageConfig } from '../../shared/page-configs/findPageConfig.js';\nimport { analyzeClientSide } from '../../shared/getPageFiles/analyzeClientSide.js';\nasync function isClientSideRoutable(pageId, pageContext) {\n    await analyzePageClientSideInit(pageContext._pageFilesAll, pageId, {\n        sharedPageFilesAlreadyLoaded: false\n    });\n    const pageConfig = findPageConfig(pageContext._pageConfigs, pageId);\n    const { isClientSideRenderable, isClientRouting } = analyzeClientSide(pageConfig, pageContext._pageFilesAll, pageId);\n    return isClientSideRenderable && isClientRouting;\n}\n","export { resolveRouteString };\nexport { getUrlFromRouteString };\nexport { isStaticRouteString };\nexport { analyzeRouteString };\nexport { assertRouteString };\nexport { parseRouteString };\nimport { assertWarning, isBrowser, escapeRegex } from '../utils.js';\nimport { assert, assertUsage } from './utils.js';\nimport pc from '@brillout/picocolors';\nconst PARAM_TOKEN_NEW = '@';\n// TODO/v1-release: remove\nconst PARAM_TOKEN_OLD = ':';\nfunction assertRouteString(routeString, errPrefix = 'Invalid') {\n    let errPrefix2 = `${errPrefix} Route String ${highlight(routeString)}`;\n    assertUsage(routeString !== '', `${errPrefix2} (empty string): set it to ${highlight('/')} instead`);\n    assertUsage(['/', '*'].includes(routeString[0]), `${errPrefix2}: it should start with ${highlight('/')} or ${highlight('*')}`);\n    assertUsage(!routeString.includes('**'), `${errPrefix2}: set it to ${highlight(routeString.split('**').join('*'))} instead`);\n}\nfunction resolveRouteString(routeString, urlPathname) {\n    assertRouteString(routeString);\n    const segments = parseRouteString(routeString);\n    const routeRegexStrInner = segments\n        .map((segment) => {\n        if (segment.param) {\n            return '[^/]+';\n        }\n        if (segment.glob) {\n            if (segment.isLastDir) {\n                return '|/.*';\n            }\n            else {\n                return '.*';\n            }\n        }\n        // segment.static\n        return escapeRegex(segment.static);\n    })\n        .map((s) => `(${s})`)\n        .join('');\n    const routeRegex = new RegExp(`^${routeRegexStrInner}/?$`);\n    const routeRegexMatch = urlPathname.match(routeRegex);\n    /* DEBUG\n    console.log()\n    console.log('routeString', routeString)\n    console.log('urlPathname', urlPathname)\n    console.log('routeSegments', segments)\n    console.log('routeRegex', routeRegex)\n    console.log('routeRegexMatch', routeRegexMatch)\n    //*/\n    if (!routeRegexMatch)\n        return null;\n    const routeParams = {};\n    const [_, ...segmentsValue] = routeRegexMatch;\n    let globIdx = 0;\n    const hasMultipleGlobs = segments.filter((segment) => segment.glob).length > 1;\n    segments.forEach((segment, i) => {\n        let val = segmentsValue[i];\n        if (segment.param) {\n            routeParams[segment.param] = val;\n        }\n        if (segment.glob) {\n            const param = `*${hasMultipleGlobs ? ++globIdx : ''}`;\n            if (segment.isLastDir)\n                val = val.slice(1);\n            routeParams[param] = val;\n        }\n    });\n    return { routeParams };\n}\nfunction parseRouteString(routeString) {\n    const segments = [];\n    const pushStatic = (s) => {\n        const segmentLast = segments[segments.length - 1];\n        if (segmentLast?.static) {\n            segmentLast.static += s;\n        }\n        else {\n            segments.push({ static: s });\n        }\n    };\n    const parts = routeString.split('/');\n    parts.forEach((s, i) => {\n        const isFirst = i === 0;\n        const isLast = i === parts.length - 1;\n        if (isParam(s)) {\n            assertWarning(!s.startsWith(PARAM_TOKEN_OLD), `Outdated Route String ${highlight(routeString)}, use ${highlight(routeString.split(PARAM_TOKEN_OLD).join(PARAM_TOKEN_NEW))} instead`, { onlyOnce: true });\n            if (!isFirst)\n                pushStatic('/');\n            segments.push({ param: s.slice(1) });\n        }\n        else {\n            if (s === '*' && isLast && routeString !== '*' && routeString !== '/*') {\n                segments.push({ glob: true, isLastDir: true });\n            }\n            else {\n                if (!isFirst)\n                    pushStatic('/');\n                s.split('*').forEach((s, i) => {\n                    if (i !== 0)\n                        segments.push({ glob: true });\n                    if (s !== '') {\n                        pushStatic(s);\n                    }\n                });\n            }\n        }\n    });\n    return segments;\n}\nfunction getUrlFromRouteString(routeString) {\n    assert(routeString.startsWith('/'));\n    if (isStaticRouteString(routeString)) {\n        const url = routeString;\n        return url;\n    }\n    return null;\n}\nfunction analyzeRouteString(routeString) {\n    const segments = parseRouteString(routeString);\n    const countStaticParts = (s) => s?.split('/').filter(Boolean).length || 0;\n    let numberOfStaticPartsBeginning = 0;\n    for (const segment of segments) {\n        if (!segment.static)\n            break;\n        numberOfStaticPartsBeginning += countStaticParts(segment.static);\n    }\n    const numberOfStaticParts = segments.map((s) => countStaticParts(s.static)).reduce((sum, a) => sum + a, 0);\n    const numberOfParams = segments.filter((s) => s.param).length;\n    const numberOfGlobs = segments.filter((s) => s.glob).length;\n    return { numberOfStaticPartsBeginning, numberOfStaticParts, numberOfParams, numberOfGlobs };\n}\nfunction isParam(routeSegment) {\n    return routeSegment.startsWith(PARAM_TOKEN_NEW) || routeSegment.startsWith(PARAM_TOKEN_OLD);\n}\nfunction isStaticRouteString(routeString) {\n    const url = routeString;\n    const match = resolveRouteString(routeString, url);\n    assert(match);\n    return Object.keys(match.routeParams).length === 0;\n}\nfunction highlight(routeString) {\n    if (isBrowser()) {\n        return `'${routeString}'`;\n    }\n    else {\n        if (routeString === '') {\n            routeString = \"''\";\n        }\n        return pc.cyan(routeString);\n    }\n}\n","export { resolvePrecendence };\n// export type { RouteMatch }\nimport { analyzeRouteString } from './resolveRouteString.js';\nimport { higherFirst, lowerFirst } from './utils.js';\nimport { makeFirst } from './utils.js';\nimport { isStaticRouteString } from './resolveRouteString.js';\n// See https://vike.dev/route-function#precedence\nfunction resolvePrecendence(routeMatches) {\n    // prettier-ignore\n    routeMatches\n        .sort(sortMatches)\n        .sort(makeFirst((routeMatch) => routeMatch.routeType === 'FUNCTION' && !!routeMatch.precedence && routeMatch.precedence < 0))\n        .sort(makeFirst((routeMatch) => routeMatch.routeType === 'STRING' && isStaticRouteString(routeMatch.routeString) === false))\n        .sort(makeFirst((routeMatch) => routeMatch.routeType === 'FUNCTION' && !routeMatch.precedence))\n        .sort(makeFirst((routeMatch) => routeMatch.routeType === 'STRING' && isStaticRouteString(routeMatch.routeString) === true))\n        .sort(makeFirst((routeMatch) => routeMatch.routeType === 'FILESYSTEM'))\n        .sort(makeFirst((routeMatch) => routeMatch.routeType === 'FUNCTION' && !!routeMatch.precedence && routeMatch.precedence > 0));\n}\n// -1 => routeMatch1 higher precedence\n// +1 => routeMatch2 higher precedence\nfunction sortMatches(routeMatch1, routeMatch2) {\n    {\n        const precedence1 = routeMatch1.precedence ?? 0;\n        const precedence2 = routeMatch2.precedence ?? 0;\n        if (precedence1 !== precedence2) {\n            return precedence1 > precedence2 ? -1 : 1;\n        }\n    }\n    if (!routeMatch2.routeString) {\n        return 0;\n    }\n    if (!routeMatch1.routeString) {\n        return 0;\n    }\n    /* DEBUG\n    console.log('routeMatch1.routeString', routeMatch1.routeString)\n    console.log('routeMatch2.routeString', routeMatch2.routeString)\n    console.log('parseRouteString(routeMatch1.routeString)', parseRouteString(routeMatch1.routeString))\n    console.log('parseRouteString(routeMatch2.routeString)', parseRouteString(routeMatch2.routeString))\n    //*/\n    // Return route with highest number of static path segments at beginning first\n    {\n        const getValue = (routeString) => analyzeRouteString(routeString).numberOfStaticPartsBeginning;\n        const result = higherFirst(getValue)(routeMatch1.routeString, routeMatch2.routeString);\n        if (result !== 0) {\n            /* DEBUG\n            console.log('analyzeRouteString(routeMatch1.routeString).numberOfStaticPartsBeginning', getValue(routeMatch1.routeString))\n            console.log('analyzeRouteString(routeMatch2.routeString).numberOfStaticPartsBeginning', getValue(routeMatch2.routeString))\n            //*/\n            return result;\n        }\n    }\n    // Return route with highest number of static path segments in total first\n    {\n        const getValue = (routeString) => analyzeRouteString(routeString).numberOfStaticParts;\n        const result = higherFirst(getValue)(routeMatch1.routeString, routeMatch2.routeString);\n        if (result !== 0) {\n            /* DEBUG\n            console.log('analyzeRouteString(routeMatch1.routeString).numberOfStaticParts', getValue(routeMatch1.routeString))\n            console.log('analyzeRouteString(routeMatch2.routeString).numberOfStaticParts', getValue(routeMatch2.routeString))\n            //*/\n            return result;\n        }\n    }\n    // Return route with least amount of globs first\n    {\n        const getValue = (routeString) => analyzeRouteString(routeString).numberOfGlobs;\n        const result = lowerFirst(getValue)(routeMatch1.routeString, routeMatch2.routeString);\n        if (result !== 0) {\n            /* DEBUG\n            console.log('analyzeRouteString(routeMatch1.routeString).numberOfGlobs', getValue(routeMatch1.routeString))\n            console.log('analyzeRouteString(routeMatch2.routeString).numberOfGlobs', getValue(routeMatch2.routeString))\n            //*/\n            return result;\n        }\n    }\n    // Return route with highest number of parameters first\n    {\n        const getValue = (routeString) => analyzeRouteString(routeString).numberOfParams;\n        const result = higherFirst(getValue)(routeMatch1.routeString, routeMatch2.routeString);\n        if (result !== 0) {\n            /* DEBUG\n            console.log('analyzeRouteString(routeMatch1.routeString).numberOfParams', getValue(routeMatch1.routeString))\n            console.log('analyzeRouteString(routeMatch2.routeString).numberOfParams', getValue(routeMatch2.routeString))\n            //*/\n            return result;\n        }\n    }\n    return 0;\n}\n","export { executeOnBeforeRouteHook };\nimport { assertPageContextProvidedByUser } from '../assertPageContextProvidedByUser.js';\nimport { assertUsage, hasProp, isObjectWithKeys, objectAssign, assertWarning, assertUsageUrl, joinEnglish, assert, executeHook } from './utils.js';\nimport { assertRouteParams, assertSyncRouting } from './resolveRouteFunction.js';\nimport pc from '@brillout/picocolors';\nasync function executeOnBeforeRouteHook(pageContext) {\n    const pageContextFromOnBeforeRouteHook = {};\n    if (!pageContext._onBeforeRouteHook)\n        return null;\n    const pageContextFromHook = await getPageContextFromHook(pageContext._onBeforeRouteHook, pageContext);\n    if (pageContextFromHook) {\n        objectAssign(pageContextFromOnBeforeRouteHook, pageContextFromHook);\n        if (hasProp(pageContextFromOnBeforeRouteHook, '_pageId', 'string') ||\n            hasProp(pageContextFromOnBeforeRouteHook, '_pageId', 'null')) {\n            // We bypass Vike's routing\n            if (!hasProp(pageContextFromOnBeforeRouteHook, 'routeParams')) {\n                objectAssign(pageContextFromOnBeforeRouteHook, { routeParams: {} });\n            }\n            else {\n                assert(hasProp(pageContextFromOnBeforeRouteHook, 'routeParams', 'object'));\n            }\n            objectAssign(pageContextFromOnBeforeRouteHook, {\n                _routingProvidedByOnBeforeRouteHook: true,\n                _debugRouteMatches: 'CUSTOM_ROUTING'\n            });\n            return pageContextFromOnBeforeRouteHook;\n        }\n    }\n    objectAssign(pageContextFromOnBeforeRouteHook, {\n        _routingProvidedByOnBeforeRouteHook: false\n    });\n    return pageContextFromOnBeforeRouteHook;\n}\nasync function getPageContextFromHook(onBeforeRouteHook, pageContext) {\n    let hookReturn = onBeforeRouteHook.hookFn(pageContext);\n    assertSyncRouting(hookReturn, `The onBeforeRoute() hook ${onBeforeRouteHook.hookFilePath}`);\n    // TODO/v1-release: make executeOnBeforeRouteHook() and route() sync\n    hookReturn = await executeHook(() => hookReturn, onBeforeRouteHook);\n    const errPrefix = `The onBeforeRoute() hook defined by ${onBeforeRouteHook.hookFilePath}`;\n    assertUsage(hookReturn === null ||\n        hookReturn === undefined ||\n        (isObjectWithKeys(hookReturn, ['pageContext']) && hasProp(hookReturn, 'pageContext')), `${errPrefix} should return ${pc.cyan('null')}, ${pc.cyan('undefined')}, or a plain JavaScript object ${pc.cyan('{ pageContext: { /* ... */ } }')}`);\n    if (hookReturn === null || hookReturn === undefined) {\n        return null;\n    }\n    assertUsage(hasProp(hookReturn, 'pageContext', 'object'), `${errPrefix} returned ${pc.cyan('{ pageContext }')} but pageContext should be a plain JavaScript object.`);\n    if (hasProp(hookReturn.pageContext, '_pageId') && !hasProp(hookReturn.pageContext, '_pageId', 'null')) {\n        const errPrefix2 = `${errPrefix} returned ${pc.cyan('{ pageContext: { _pageId } }')} but ${pc.cyan('_pageId')} should be`;\n        assertUsage(hasProp(hookReturn.pageContext, '_pageId', 'string'), `${errPrefix2} a string or null`);\n        assertUsage(pageContext._allPageIds.includes(hookReturn.pageContext._pageId), `${errPrefix2} ${joinEnglish(pageContext._allPageIds.map((s) => pc.cyan(s)), 'or')}`);\n    }\n    if (hasProp(hookReturn.pageContext, 'routeParams')) {\n        assertRouteParams(hookReturn.pageContext, `${errPrefix} returned ${pc.cyan('{ pageContext: { routeParams } }')} but routeParams should`);\n    }\n    const deprecatedReturn = (prop) => `${errPrefix} returned ${pc.cyan(`{ pageContext: { ${prop} } }`)} which is deprecated. Return ${pc.cyan('{ pageContext: { urlLogical } }')} instead.`;\n    if (hasProp(hookReturn.pageContext, 'url')) {\n        assertWarning(false, deprecatedReturn('url'), { onlyOnce: true });\n        hookReturn.pageContext.urlLogical = hookReturn.pageContext.url;\n        delete hookReturn.pageContext.url;\n    }\n    if (hasProp(hookReturn.pageContext, 'urlOriginal')) {\n        assertWarning(false, deprecatedReturn('urlOriginal'), { onlyOnce: true });\n        hookReturn.pageContext.urlLogical = hookReturn.pageContext.urlOriginal;\n        delete hookReturn.pageContext.urlOriginal;\n    }\n    if (hasProp(hookReturn.pageContext, 'urlLogical')) {\n        assertUsageUrl(hookReturn.pageContext.urlLogical, `${errPrefix} returned ${pc.cyan('{ pageContext: { urlLogical } }')} but ${pc.cyan('urlLogical')}`);\n    }\n    assertPageContextProvidedByUser(hookReturn.pageContext, {\n        hookFilePath: onBeforeRouteHook.hookFilePath,\n        hookName: 'onBeforeRoute'\n    });\n    const pageContextAddendumHook = {};\n    objectAssign(pageContextAddendumHook, hookReturn.pageContext);\n    return pageContextAddendumHook;\n}\n","export { debug };\nvar _debug;\nfunction debug(...args) {\n    if (!_debug) {\n        // We use this trick instead of `import { createDebugger } from '../../utils/debug` in order to ensure that the `debug` mechanism is only loaded on the server-side\n        _debug = globalThis.__brillout_debug_createDebugger?.('vike:routing');\n    }\n    if (_debug) {\n        _debug(...args);\n    }\n}\n","export { route };\n// Ensure we don't bloat runtime of Server Routing\nimport { assertClientRouting } from '../../utils/assertRoutingType.js';\nimport { isBrowser } from '../../utils/isBrowser.js';\nif (isBrowser()) {\n    assertClientRouting();\n}\nimport { assert, assertUsage, isPlainObject, objectAssign } from './utils.js';\nimport { addUrlComputedProps } from '../addUrlComputedProps.js';\nimport { resolvePrecendence } from './resolvePrecedence.js';\nimport { resolveRouteString } from './resolveRouteString.js';\nimport { resolveRouteFunction } from './resolveRouteFunction.js';\nimport { executeOnBeforeRouteHook } from './executeOnBeforeRouteHook.js';\nimport { debug } from './debug.js';\nimport pc from '@brillout/picocolors';\nasync function route(pageContextForRoute) {\n    debug('Pages routes:', pageContextForRoute._pageRoutes);\n    addUrlComputedProps(pageContextForRoute);\n    const pageContextFromRoute = {};\n    // onBeforeRoute()\n    const pageContextFromOnBeforeRouteHook = await executeOnBeforeRouteHook(pageContextForRoute);\n    if (pageContextFromOnBeforeRouteHook) {\n        if (pageContextFromOnBeforeRouteHook._routingProvidedByOnBeforeRouteHook) {\n            assert(pageContextFromOnBeforeRouteHook._pageId);\n            return pageContextFromOnBeforeRouteHook;\n        }\n        else {\n            objectAssign(pageContextFromRoute, pageContextFromOnBeforeRouteHook);\n        }\n    }\n    // We take into account pageContext.urlLogical set by onBeforeRoute()\n    const pageContext = {};\n    objectAssign(pageContext, pageContextForRoute);\n    objectAssign(pageContext, pageContextFromOnBeforeRouteHook);\n    // Vike's routing\n    const allPageIds = pageContext._allPageIds;\n    assert(allPageIds.length >= 0);\n    assertUsage(pageContext._pageFilesAll.length > 0 || pageContext._pageConfigs.length > 0, 'No *.page.js file found. You must create at least one *.page.js file.');\n    assertUsage(allPageIds.length > 0, \"You must create at least one *.page.js file that isn't _default.page.*\");\n    const { urlPathname } = pageContext;\n    assert(urlPathname.startsWith('/'));\n    const routeMatches = [];\n    await Promise.all(pageContext._pageRoutes.map(async (pageRoute) => {\n        const { pageId, routeType } = pageRoute;\n        // Filesytem Routing\n        if (pageRoute.routeType === 'FILESYSTEM') {\n            const { routeString } = pageRoute;\n            const match = resolveRouteString(routeString, urlPathname);\n            if (match) {\n                const { routeParams } = match;\n                routeMatches.push({ pageId, routeParams, routeString, routeType });\n            }\n            return;\n        }\n        // Route String defined in `.page.route.js`\n        if (pageRoute.routeType === 'STRING') {\n            const { routeString } = pageRoute;\n            const match = resolveRouteString(routeString, urlPathname);\n            if (match) {\n                const { routeParams } = match;\n                assert(routeType === 'STRING');\n                routeMatches.push({\n                    pageId,\n                    routeString,\n                    routeParams,\n                    routeType\n                });\n            }\n            return;\n        }\n        // Route Function defined in `.page.route.js`\n        if (pageRoute.routeType === 'FUNCTION') {\n            const { routeFunction, routeDefinedAt } = pageRoute;\n            const match = await resolveRouteFunction(routeFunction, pageContext, routeDefinedAt);\n            if (match) {\n                const { routeParams, precedence } = match;\n                routeMatches.push({ pageId, precedence, routeParams, routeType });\n            }\n            return;\n        }\n        assert(false);\n    }));\n    resolvePrecendence(routeMatches);\n    const winner = routeMatches[0];\n    debug(`Route matches for URL ${pc.cyan(urlPathname)} (in precedence order):`, routeMatches);\n    objectAssign(pageContextFromRoute, { _debugRouteMatches: routeMatches });\n    if (!winner) {\n        objectAssign(pageContextFromRoute, {\n            _pageId: null,\n            routeParams: {}\n        });\n        return pageContextFromRoute;\n    }\n    {\n        const { routeParams } = winner;\n        assert(isPlainObject(routeParams));\n        objectAssign(pageContextFromRoute, {\n            _pageId: winner.pageId,\n            routeParams: winner.routeParams\n        });\n    }\n    return pageContextFromRoute;\n}\n","export { prefetch };\nexport { addLinkPrefetchHandlers };\nimport { assert, assertClientRouting, assertUsage, assertWarning, checkIfClientRouting, getGlobalObject, isExternalLink } from './utils.js';\nimport { isErrorFetchingStaticAssets, loadPageFilesClientSide } from '../shared/loadPageFilesClientSide.js';\nimport { skipLink } from './skipLink.js';\nimport { getPrefetchSettings } from './prefetch/getPrefetchSettings.js';\nimport { isAlreadyPrefetched, markAsAlreadyPrefetched } from './prefetch/alreadyPrefetched.js';\nimport { disableClientRouting } from './renderPageClientSide.js';\nimport { isClientSideRoutable } from './isClientSideRoutable.js';\nimport { createPageContext } from './createPageContext.js';\nimport { route } from '../../shared/route/index.js';\nimport { noRouteMatch } from '../../shared/route/noRouteMatch.js';\nassertClientRouting();\nconst globalObject = getGlobalObject('prefetch.ts', { linkPrefetchHandlerAdded: new Map() });\nasync function prefetchAssets(pageId, pageContext) {\n    try {\n        await loadPageFilesClientSide(pageId, pageContext);\n    }\n    catch (err) {\n        if (isErrorFetchingStaticAssets(err)) {\n            disableClientRouting(err, true);\n        }\n        else {\n            throw err;\n        }\n    }\n}\n/**\n * Programmatically prefetch client assets.\n *\n * https://vike.dev/prefetch\n *\n * @param url - The URL of the page you want to prefetch.\n */\nasync function prefetch(url) {\n    assertUsage(checkIfClientRouting(), 'prefetch() only works with Client Routing, see https://vike.dev/prefetch', {\n        showStackTrace: true\n    });\n    const errPrefix = `Cannot prefetch URL ${url} because it`;\n    assertUsage(!isExternalLink(url), `${errPrefix} lives on another domain`, { showStackTrace: true });\n    if (isAlreadyPrefetched(url))\n        return;\n    markAsAlreadyPrefetched(url);\n    const pageContext = await createPageContext(url);\n    let pageContextFromRoute;\n    try {\n        pageContextFromRoute = await route(pageContext);\n    }\n    catch {\n        // If a route() hook has a bug or `throw render()` / `throw redirect()`\n        return;\n    }\n    const pageId = pageContextFromRoute._pageId;\n    if (!pageId) {\n        assertWarning(false, `${errPrefix} ${noRouteMatch}`, {\n            showStackTrace: true,\n            onlyOnce: false\n        });\n        return;\n    }\n    await prefetchAssets(pageId, pageContext);\n}\nfunction addLinkPrefetchHandlers(pageContext) {\n    // Current URL is already prefetched\n    markAsAlreadyPrefetched(pageContext.urlPathname);\n    const linkTags = [...document.getElementsByTagName('A')];\n    linkTags.forEach((linkTag) => {\n        if (globalObject.linkPrefetchHandlerAdded.has(linkTag))\n            return;\n        globalObject.linkPrefetchHandlerAdded.set(linkTag, true);\n        const url = linkTag.getAttribute('href');\n        if (skipLink(linkTag))\n            return;\n        assert(url);\n        if (isAlreadyPrefetched(url))\n            return;\n        const { prefetchStaticAssets } = getPrefetchSettings(pageContext, linkTag);\n        if (!prefetchStaticAssets)\n            return;\n        if (prefetchStaticAssets === 'hover') {\n            linkTag.addEventListener('mouseover', () => {\n                prefetchIfPossible(url);\n            });\n            linkTag.addEventListener('touchstart', () => {\n                prefetchIfPossible(url);\n            }, { passive: true });\n        }\n        if (prefetchStaticAssets === 'viewport') {\n            const observer = new IntersectionObserver((entries) => {\n                entries.forEach((entry) => {\n                    if (entry.isIntersecting) {\n                        prefetchIfPossible(url);\n                        observer.disconnect();\n                    }\n                });\n            });\n            observer.observe(linkTag);\n        }\n    });\n}\nasync function prefetchIfPossible(url) {\n    const pageContext = await createPageContext(url);\n    let pageContextFromRoute;\n    try {\n        pageContextFromRoute = await route(pageContext);\n    }\n    catch {\n        // If a route() hook has a bug or `throw render()` / `throw redirect()`\n        return;\n    }\n    if (!pageContextFromRoute?._pageId)\n        return;\n    if (!(await isClientSideRoutable(pageContextFromRoute._pageId, pageContext)))\n        return;\n    await prefetchAssets(pageContextFromRoute._pageId, pageContext);\n}\n","export { executeOnRenderClientHook };\nimport { assert, assertUsage, executeHook } from '../server-routing-runtime/utils.js';\nimport { getHook } from '../../shared/hooks/getHook.js';\nimport { preparePageContextForUserConsumptionClientSide } from './preparePageContextForUserConsumptionClientSide.js';\nasync function executeOnRenderClientHook(pageContext, isClientRouting) {\n    const pageContextForUserConsumption = preparePageContextForUserConsumptionClientSide(pageContext, isClientRouting);\n    let hook = null;\n    let hookName;\n    {\n        const renderHook = getHook(pageContext, 'render');\n        hook = renderHook;\n        hookName = 'render';\n    }\n    {\n        const renderHook = getHook(pageContext, 'onRenderClient');\n        if (renderHook) {\n            hook = renderHook;\n            hookName = 'onRenderClient';\n        }\n    }\n    if (!hook) {\n        const urlToShowToUser = getUrlToShowToUser(pageContext);\n        assert(urlToShowToUser);\n        if (pageContext._pageConfigs.length > 0) {\n            // V1 design\n            assertUsage(false, `No onRenderClient() hook defined for URL '${urlToShowToUser}', but it's needed, see https://vike.dev/onRenderClient`);\n        }\n        else {\n            // TODO/v1-release: remove\n            // V0.4 design\n            const pageClientsFilesLoaded = pageContext._pageFilesLoaded.filter((p) => p.fileType === '.page.client');\n            let errMsg;\n            if (pageClientsFilesLoaded.length === 0) {\n                errMsg = 'No file `*.page.client.*` found for URL ' + urlToShowToUser;\n            }\n            else {\n                errMsg =\n                    'One of the following files should export a render() hook: ' +\n                        pageClientsFilesLoaded.map((p) => p.filePath).join(' ');\n            }\n            assertUsage(false, errMsg);\n        }\n    }\n    assert(hook);\n    const renderHook = hook.hookFn;\n    assert(hookName);\n    // We don't use a try-catch wrapper because rendering errors are usually handled by the UI framework. (E.g. React's Error Boundaries.)\n    const hookResult = await executeHook(() => renderHook(pageContextForUserConsumption), hook);\n    assertUsage(hookResult === undefined, `The ${hookName}() hook defined by ${hook.hookFilePath} isn't allowed to return a value`);\n}\nfunction getUrlToShowToUser(pageContext) {\n    let url;\n    // try/catch to avoid passToClient assertUsage() (although: this may not be needed anymore, since we're now accessing pageContext and not pageContextForUserConsumption)\n    try {\n        url =\n            // Client Routing\n            pageContext.urlPathname ??\n                // Server Routing\n                pageContext.urlOriginal;\n    }\n    catch { }\n    url = url ?? window.location.href;\n    return url;\n}\n","export { setScrollPosition };\nexport { autoSaveScrollPosition };\nimport { assert, onPageHide, sleep, throttle } from './utils.js';\nimport { saveScrollPosition } from './history.js';\nfunction setScrollPosition(scrollTarget) {\n    if (scrollTarget === 'preserve-scroll') {\n        return;\n    }\n    let scrollPosition;\n    if (scrollTarget === 'scroll-to-top-or-hash') {\n        const hash = getUrlHash();\n        // We replicate the browser's native behavior\n        if (hash && hash !== 'top') {\n            const hashTarget = document.getElementById(hash) || document.getElementsByName(hash)[0];\n            if (hashTarget) {\n                hashTarget.scrollIntoView();\n                return;\n            }\n        }\n        scrollPosition = { x: 0, y: 0 };\n    }\n    else {\n        assert('x' in scrollTarget && 'y' in scrollTarget);\n        scrollPosition = scrollTarget;\n    }\n    setScroll(scrollPosition);\n}\n/** Change the browser's scoll position, in a way that works during a repaint. */\nfunction setScroll(scrollPosition) {\n    const scroll = () => window.scrollTo(scrollPosition.x, scrollPosition.y);\n    const done = () => window.scrollX === scrollPosition.x && window.scrollY === scrollPosition.y;\n    // In principle, this `done()` call should force the repaint to be finished. But that doesn't seem to be the case with `Firefox 97.0.1`.\n    if (done())\n        return;\n    scroll();\n    // Because `done()` doesn't seem to always force the repaint to be finished, we potentially need to retry again.\n    if (done())\n        return;\n    requestAnimationFrame(() => {\n        scroll();\n        if (done())\n            return;\n        setTimeout(async () => {\n            scroll();\n            if (done())\n                return;\n            // In principle, `requestAnimationFrame() -> setTimeout(, 0)` should be enough.\n            //  - https://stackoverflow.com/questions/61281139/waiting-for-repaint-in-javascript\n            //  - But it's not enough for `Firefox 97.0.1`.\n            //  - The following strategy is very agressive. It doesn't need to be that aggressive for Firefox. But we do it to be safe.\n            const start = new Date().getTime();\n            while (true) {\n                await sleep(10);\n                scroll();\n                if (done())\n                    return;\n                const millisecondsElapsed = new Date().getTime() - start;\n                if (millisecondsElapsed > 100)\n                    return;\n            }\n        }, 0);\n    });\n}\nfunction getUrlHash() {\n    let { hash } = window.location;\n    if (hash === '')\n        return null;\n    assert(hash.startsWith('#'));\n    hash = hash.slice(1);\n    return hash;\n}\n// Save scroll position (needed for back-/forward navigation)\nfunction autoSaveScrollPosition() {\n    // Safari cannot handle more than 100 `history.replaceState()` calls within 30 seconds (https://github.com/vikejs/vike/issues/46)\n    window.addEventListener('scroll', throttle(saveScrollPosition, Math.ceil(1000 / 3)), { passive: true });\n    onPageHide(saveScrollPosition);\n}\n","export { onBrowserHistoryNavigation };\nexport { updateState };\nimport { getCurrentUrl, getGlobalObject } from './utils.js';\nimport { initHistoryState, getHistoryState } from './history.js';\nimport { renderPageClientSide } from './renderPageClientSide.js';\nimport { setScrollPosition } from './setScrollPosition.js';\nconst globalObject = getGlobalObject('onBrowserHistoryNavigation.ts', { previousState: getState() });\nfunction onBrowserHistoryNavigation() {\n    // - The popstate event is trigged upon:\n    //   - Back-/forward navigation.\n    //     - By user clicking on his browser's back-/forward navigation (or using a shortcut)\n    //     - By JavaScript: `history.back()` / `history.forward()`\n    //   - URL hash change.\n    //     - By user clicking on a hash link `<a href=\"#some-hash\" />`\n    //       - The popstate event is *only* triggered if `href` starts with '#' (even if `href` is '/#some-hash' while the current URL's pathname is '/' then the popstate still isn't triggered)\n    //     - By JavaScript: `location.hash = 'some-hash'`\n    // - The `event` argument of `window.addEventListener('popstate', (event) => /*...*/)` is useless: the History API doesn't provide the previous state (the popped state), see https://stackoverflow.com/questions/48055323/is-history-state-always-the-same-as-popstate-event-state\n    window.addEventListener('popstate', (ev) => {\n        const currentState = getState();\n        const scrollTarget = currentState.historyState.scrollPosition || 'scroll-to-top-or-hash';\n        const isUserLandPushStateNavigation = currentState.historyState.triggedBy === 'user';\n        const isHashNavigation = currentState.urlWithoutHash === globalObject.previousState.urlWithoutHash;\n        const isBackwardNavigation = !currentState.historyState.timestamp || !globalObject.previousState.historyState.timestamp\n            ? null\n            : currentState.historyState.timestamp < globalObject.previousState.historyState.timestamp;\n        globalObject.previousState = currentState;\n        if (isHashNavigation && !isUserLandPushStateNavigation) {\n            // - `history.state` is uninitialized (`null`) when:\n            //   - The user's code runs `window.location.hash = '#section'`.\n            //   - The user clicks on an anchor link `<a href=\"#section\">Section</a>` (because Vike's `onLinkClick()` handler skips hash links).\n            // - `history.state` is `null` when uninitialized: https://developer.mozilla.org/en-US/docs/Web/API/History/state\n            // - Alternatively, we completely take over hash navigation and reproduce the browser's native behavior upon hash navigation.\n            //   - Problem: we cannot intercept `window.location.hash = '#section'`. (Or maybe we can with the `hashchange` event?)\n            //   - Other potential problem: would there be a conflict when the user wants to override the browser's default behavior? E.g. for smooth scrolling, or when using hashes for saving states of some fancy animations.\n            // - Another alternative: we use the browser's scroll restoration mechanism (see `browserNativeScrollRestoration_enable()` below).\n            //   - Problem: not clear when to call `browserNativeScrollRestoration_disable()`/`browserNativeScrollRestoration_enable()`\n            //   - Other potential problem are inconsistencies between browsers: specification says that setting `window.history.scrollRestoration` only affects the current entry in the session history. But this seems to contradict what folks saying.\n            //     - Specification: https://html.spec.whatwg.org/multipage/history.html#the-history-interface\n            //     - https://stackoverflow.com/questions/70188241/history-scrollrestoration-manual-doesnt-prevent-safari-from-restoring-scrol\n            if (window.history.state === null) {\n                // The browser already scrolled to `#${hash}` => the current scroll position is the right one => we save it with `initHistoryState()`.\n                initHistoryState();\n                globalObject.previousState = getState();\n            }\n            else {\n                // If `history.state !== null` then it means that `popstate` was triggered by the user clicking on his browser's forward/backward history button.\n                setScrollPosition(scrollTarget);\n            }\n        }\n        else {\n            renderPageClientSide({ scrollTarget, isBackwardNavigation, isUserLandPushStateNavigation });\n        }\n    });\n}\nfunction getState() {\n    return {\n        urlWithoutHash: getCurrentUrl({ withoutHash: true }),\n        historyState: getHistoryState()\n    };\n}\nfunction updateState() {\n    globalObject.previousState = getState();\n}\n","// Handle the browser's native scroll restoration mechanism\nexport { browserNativeScrollRestoration_disable };\nexport { setupNativeScrollRestoration };\nexport { setInitialRenderIsDone };\nimport { getGlobalObject, onPageHide, onPageShow } from './utils.js';\nconst globalObject = getGlobalObject('scrollRestoration.ts', {});\n// We use the browser's native scroll restoration mechanism only for the first render\nfunction setupNativeScrollRestoration() {\n    browserNativeScrollRestoration_enable();\n    onPageHide(browserNativeScrollRestoration_enable);\n    onPageShow(() => globalObject.initialRenderIsDone && browserNativeScrollRestoration_disable());\n}\nfunction setInitialRenderIsDone() {\n    globalObject.initialRenderIsDone = true;\n}\nfunction browserNativeScrollRestoration_disable() {\n    if ('scrollRestoration' in window.history) {\n        window.history.scrollRestoration = 'manual';\n    }\n}\nfunction browserNativeScrollRestoration_enable() {\n    if ('scrollRestoration' in window.history) {\n        window.history.scrollRestoration = 'auto';\n    }\n}\n","export { renderPageClientSide };\nexport { getRenderCount };\nexport { disableClientRouting };\nimport { assert, getCurrentUrl, isEquivalentError, objectAssign, serverSideRouteTo, getGlobalObject, executeHook, hasProp } from './utils.js';\nimport { getPageContextFromHooks_errorPage, getPageContextFromHooks_firstRender, getPageContextFromHooks_uponNavigation, isAlreadyServerSideRouted } from './getPageContextFromHooks.js';\nimport { createPageContext } from './createPageContext.js';\nimport { addLinkPrefetchHandlers } from './prefetch.js';\nimport { assertInfo, assertWarning, isReact } from './utils.js';\nimport { executeOnRenderClientHook } from '../shared/executeOnRenderClientHook.js';\nimport { assertHook, getHook } from '../../shared/hooks/getHook.js';\nimport { isErrorFetchingStaticAssets } from '../shared/loadPageFilesClientSide.js';\nimport { pushHistory } from './history.js';\nimport { assertNoInfiniteAbortLoop, getPageContextFromAllRewrites, isAbortError, logAbortErrorHandled } from '../../shared/route/abort.js';\nimport { route } from '../../shared/route/index.js';\nimport { isClientSideRoutable } from './isClientSideRoutable.js';\nimport { setScrollPosition } from './setScrollPosition.js';\nimport { updateState } from './onBrowserHistoryNavigation.js';\nimport { browserNativeScrollRestoration_disable, setInitialRenderIsDone } from './scrollRestoration.js';\nconst globalObject = getGlobalObject('renderPageClientSide.ts', { renderCounter: 0 });\nasync function renderPageClientSide(renderArgs) {\n    const { scrollTarget, urlOriginal = getCurrentUrl(), overwriteLastHistoryEntry = false, isBackwardNavigation, pageContextsFromRewrite = [], redirectCount = 0, isUserLandPushStateNavigation, isClientSideNavigation = true } = renderArgs;\n    const { abortRender, setHydrationCanBeAborted, isFirstRender } = getAbortRender();\n    assert(isClientSideNavigation === !isFirstRender);\n    assertNoInfiniteAbortLoop(pageContextsFromRewrite.length, redirectCount);\n    if (globalObject.clientRoutingIsDisabled) {\n        serverSideRouteTo(urlOriginal);\n        return;\n    }\n    const pageContext = await createPageContext(urlOriginal);\n    if (abortRender())\n        return;\n    objectAssign(pageContext, {\n        isBackwardNavigation,\n        isClientSideNavigation\n    });\n    {\n        const pageContextFromAllRewrites = getPageContextFromAllRewrites(pageContextsFromRewrite);\n        objectAssign(pageContext, pageContextFromAllRewrites);\n    }\n    let renderState = {};\n    const onError = (err) => {\n        assert(err);\n        assert(!('err' in renderState));\n        assert(!('errorWhileRendering' in pageContext));\n        renderState.err = err;\n        pageContext.errorWhileRendering = err;\n    };\n    if (!isFirstRender) {\n        // Route\n        try {\n            renderState = { pageContextFromRoute: await route(pageContext) };\n        }\n        catch (err) {\n            onError(err);\n        }\n        if (abortRender())\n            return;\n        // Check whether rendering should be skipped\n        if (renderState.pageContextFromRoute) {\n            const { pageContextFromRoute } = renderState;\n            objectAssign(pageContext, pageContextFromRoute);\n            let isClientRoutable;\n            if (!pageContextFromRoute._pageId) {\n                isClientRoutable = false;\n            }\n            else {\n                isClientRoutable = await isClientSideRoutable(pageContextFromRoute._pageId, pageContext);\n                if (abortRender())\n                    return;\n            }\n            if (!isClientRoutable) {\n                serverSideRouteTo(urlOriginal);\n                return;\n            }\n            const isSamePage = pageContextFromRoute._pageId &&\n                globalObject.previousPageContext?._pageId &&\n                pageContextFromRoute._pageId === globalObject.previousPageContext._pageId;\n            if (isUserLandPushStateNavigation && isSamePage) {\n                // Skip's Vike's rendering; let the user handle the navigation\n                return;\n            }\n        }\n    }\n    // onPageTransitionStart()\n    const callTransitionHooks = !isFirstRender;\n    if (callTransitionHooks) {\n        if (!globalObject.isTransitioning) {\n            if (globalObject.onPageTransitionStart) {\n                const hook = globalObject.onPageTransitionStart;\n                const { hookFn } = hook;\n                await executeHook(() => hookFn(pageContext), hook);\n            }\n            globalObject.isTransitioning = true;\n            if (abortRender())\n                return;\n        }\n    }\n    if (isFirstRender) {\n        assert(!renderState.pageContextFromRoute);\n        assert(!renderState.err);\n        try {\n            renderState.pageContextFromHooks = await getPageContextFromHooks_firstRender(pageContext);\n        }\n        catch (err) {\n            onError(err);\n        }\n        if (abortRender())\n            return;\n    }\n    else {\n        if (!renderState.err) {\n            const { pageContextFromRoute } = renderState;\n            assert(pageContextFromRoute);\n            assert(pageContextFromRoute._pageId);\n            assert(hasProp(pageContextFromRoute, '_pageId', 'string')); // Help TS\n            objectAssign(pageContext, pageContextFromRoute);\n            try {\n                renderState.pageContextFromHooks = await getPageContextFromHooks_uponNavigation(pageContext);\n            }\n            catch (err) {\n                onError(err);\n            }\n            if (abortRender())\n                return;\n        }\n    }\n    if ('err' in renderState) {\n        const { err } = renderState;\n        if (!isAbortError(err)) {\n            // We don't swallow 404 errors:\n            //  - On the server-side, Vike swallows / doesn't show any 404 error log because it's expected that a user may go to some random non-existent URL. (We don't want to flood the app's error tracking with 404 logs.)\n            //  - On the client-side, if the user navigates to a 404 then it means that the UI has a broken link. (It isn't expected that users can go to some random URL using the client-side router, as it would require, for example, the user to manually change the URL of a link by manually manipulating the DOM which highly unlikely.)\n            console.error(err);\n        }\n        else {\n            // We swallow throw redirect()/render() called by client-side hooks onBeforeRender() and guard()\n            // We handle the abort error down below.\n        }\n        if (shouldSwallowAndInterrupt(err, pageContext, isFirstRender))\n            return;\n        if (isAbortError(err)) {\n            const errAbort = err;\n            logAbortErrorHandled(err, pageContext._isProduction, pageContext);\n            const pageContextAbort = errAbort._pageContextAbort;\n            // throw render('/some-url')\n            if (pageContextAbort._urlRewrite) {\n                await renderPageClientSide({\n                    ...renderArgs,\n                    scrollTarget: 'scroll-to-top-or-hash',\n                    pageContextsFromRewrite: [...pageContextsFromRewrite, pageContextAbort]\n                });\n                return;\n            }\n            // throw redirect('/some-url')\n            if (pageContextAbort._urlRedirect) {\n                const urlRedirect = pageContextAbort._urlRedirect.url;\n                if (urlRedirect.startsWith('http')) {\n                    // External redirection\n                    window.location.href = urlRedirect;\n                    return;\n                }\n                else {\n                    await renderPageClientSide({\n                        ...renderArgs,\n                        scrollTarget: 'scroll-to-top-or-hash',\n                        urlOriginal: urlRedirect,\n                        overwriteLastHistoryEntry: false,\n                        isBackwardNavigation: false,\n                        redirectCount: redirectCount + 1\n                    });\n                }\n                return;\n            }\n            // throw render(statusCode)\n            assert(pageContextAbort.abortStatusCode);\n            objectAssign(pageContext, pageContextAbort);\n            if (pageContextAbort.abortStatusCode === 404) {\n                objectAssign(pageContext, { is404: true });\n            }\n        }\n        else {\n            objectAssign(pageContext, { is404: false });\n        }\n        try {\n            renderState.pageContextFromHooks = await getPageContextFromHooks_errorPage(pageContext);\n        }\n        catch (err2) {\n            // - When user hasn't defined a `_error.page.js` file\n            // - Some unpexected vike internal error\n            if (shouldSwallowAndInterrupt(err2, pageContext, isFirstRender))\n                return;\n            if (!isFirstRender) {\n                setTimeout(() => {\n                    // We let the server show the 404 page\n                    window.location.pathname = urlOriginal;\n                }, 0);\n            }\n            if (!isEquivalentError(err, err2)) {\n                throw err2;\n            }\n            else {\n                // Abort\n                return;\n            }\n        }\n        if (abortRender())\n            return;\n    }\n    const { pageContextFromHooks } = renderState;\n    assert(pageContextFromHooks);\n    objectAssign(pageContext, pageContextFromHooks);\n    // Set global onPageTransitionStart()\n    assertHook(pageContext, 'onPageTransitionStart');\n    const onPageTransitionStartHook = getHook(pageContext, 'onPageTransitionStart');\n    globalObject.onPageTransitionStart = onPageTransitionStartHook;\n    // Set global hydrationCanBeAborted\n    if (pageContext.exports.hydrationCanBeAborted) {\n        setHydrationCanBeAborted();\n    }\n    else {\n        assertWarning(!isReact(), 'You seem to be using React; we recommend setting hydrationCanBeAborted to true, see https://vike.dev/hydrationCanBeAborted', { onlyOnce: true });\n    }\n    // There wasn't any `await` but result may change because we just called setHydrationCanBeAborted()\n    if (abortRender())\n        return;\n    // We use globalObject.renderPromise in order to ensure that there is never two concurrent onRenderClient() calls\n    if (globalObject.renderPromise) {\n        // Make sure that the previous render has finished\n        await globalObject.renderPromise;\n        assert(globalObject.renderPromise === undefined);\n        if (abortRender())\n            return;\n    }\n    changeUrl(urlOriginal, overwriteLastHistoryEntry);\n    globalObject.previousPageContext = pageContext;\n    assert(globalObject.renderPromise === undefined);\n    globalObject.renderPromise = (async () => {\n        await executeOnRenderClientHook(pageContext, true);\n        addLinkPrefetchHandlers(pageContext);\n        globalObject.renderPromise = undefined;\n    })();\n    await globalObject.renderPromise;\n    assert(globalObject.renderPromise === undefined);\n    /* We don't abort in order to ensure that onHydrationEnd() is called: we abort only after onHydrationEnd() is called.\n    if (abortRender(true)) return\n    */\n    // onHydrationEnd()\n    if (isFirstRender) {\n        assertHook(pageContext, 'onHydrationEnd');\n        const hook = getHook(pageContext, 'onHydrationEnd');\n        if (hook) {\n            const { hookFn } = hook;\n            await executeHook(() => hookFn(pageContext), hook);\n            if (abortRender(true))\n                return;\n        }\n    }\n    // We abort only after onHydrationEnd() is called\n    if (abortRender(true))\n        return;\n    // onPageTransitionEnd()\n    if (callTransitionHooks) {\n        assertHook(pageContext, 'onPageTransitionEnd');\n        const hook = getHook(pageContext, 'onPageTransitionEnd');\n        if (hook) {\n            const { hookFn } = hook;\n            await executeHook(() => hookFn(pageContext), hook);\n            if (abortRender(true))\n                return;\n        }\n        globalObject.isTransitioning = undefined;\n    }\n    // Page scrolling\n    setScrollPosition(scrollTarget);\n    browserNativeScrollRestoration_disable();\n    setInitialRenderIsDone();\n}\nfunction changeUrl(url, overwriteLastHistoryEntry) {\n    if (getCurrentUrl() === url)\n        return;\n    browserNativeScrollRestoration_disable();\n    pushHistory(url, overwriteLastHistoryEntry);\n    updateState();\n}\nfunction shouldSwallowAndInterrupt(err, pageContext, isFirstRender) {\n    if (isAlreadyServerSideRouted(err))\n        return true;\n    if (handleErrorFetchingStaticAssets(err, pageContext, isFirstRender))\n        return true;\n    return false;\n}\nfunction handleErrorFetchingStaticAssets(err, pageContext, isFirstRender) {\n    if (!isErrorFetchingStaticAssets(err)) {\n        return false;\n    }\n    if (isFirstRender) {\n        disableClientRouting(err, false);\n        // This may happen if the frontend was newly deployed during hydration.\n        // Ideally: re-try a couple of times by reloading the page (not entirely trivial to implement since `localStorage` is needed.)\n        throw err;\n    }\n    else {\n        disableClientRouting(err, true);\n    }\n    serverSideRouteTo(pageContext.urlOriginal);\n    return true;\n}\nfunction disableClientRouting(err, log) {\n    assert(isErrorFetchingStaticAssets(err));\n    globalObject.clientRoutingIsDisabled = true;\n    if (log) {\n        // We don't use console.error() to avoid flooding error trackers such as Sentry\n        console.log(err);\n    }\n    // @ts-ignore Since dist/cjs/client/ is never used, we can ignore this error.\n    const isProd = import.meta.env.PROD;\n    assertInfo(false, [\n        'Failed to fetch static asset.',\n        isProd ? 'This usually happens when a new frontend is deployed.' : null,\n        'Falling back to Server Routing.',\n        '(The next page navigation will use Server Routing instead of Client Routing.)'\n    ]\n        .filter(Boolean)\n        .join(' '), { onlyOnce: true });\n}\nfunction getAbortRender() {\n    const renderNumber = ++globalObject.renderCounter;\n    assert(renderNumber >= 1);\n    let hydrationCanBeAborted = false;\n    const setHydrationCanBeAborted = () => {\n        hydrationCanBeAborted = true;\n    };\n    /** Whether the rendering should be aborted because a new rendering has started. We should call this after each `await`. */\n    const abortRender = (isRenderCleanup) => {\n        // Never abort hydration if `hydrationCanBeAborted` isn't `true`\n        if (!isRenderCleanup) {\n            const isHydration = renderNumber === 1;\n            if (isHydration && !hydrationCanBeAborted) {\n                return false;\n            }\n        }\n        // If there is a newer rendering, we should abort all previous renderings\n        return renderNumber !== globalObject.renderCounter;\n    };\n    return {\n        abortRender,\n        setHydrationCanBeAborted,\n        isFirstRender: renderNumber === 1\n    };\n}\nfunction getRenderCount() {\n    return globalObject.renderCounter;\n}\n","// Code adapted from https://github.com/HenrikJoreteg/internal-nav-helper/blob/5199ec5448d0b0db7ec63cf76d88fa6cad878b7d/src/index.js#L11-L29\nexport { onLinkClick };\nimport { assert } from './utils.js';\nimport { skipLink } from './skipLink.js';\nimport { renderPageClientSide } from './renderPageClientSide.js';\nfunction onLinkClick() {\n    document.addEventListener('click', handler);\n}\nfunction handler(ev) {\n    if (!isNormalLeftClick(ev))\n        return;\n    const linkTag = findLinkTag(ev.target);\n    if (!linkTag)\n        return;\n    const url = linkTag.getAttribute('href');\n    if (skipLink(linkTag))\n        return;\n    assert(url);\n    ev.preventDefault();\n    const keepScrollPosition = ![null, 'false'].includes(linkTag.getAttribute('keep-scroll-position'));\n    const scrollTarget = keepScrollPosition ? 'preserve-scroll' : 'scroll-to-top-or-hash';\n    renderPageClientSide({\n        scrollTarget,\n        urlOriginal: url,\n        isBackwardNavigation: false\n    });\n}\nfunction isNormalLeftClick(ev) {\n    return ev.button === 0 && !ev.ctrlKey && !ev.shiftKey && !ev.altKey && !ev.metaKey;\n}\nfunction findLinkTag(target) {\n    while (target.tagName !== 'A') {\n        const { parentNode } = target;\n        if (!parentNode) {\n            return null;\n        }\n        target = parentNode;\n    }\n    return target;\n}\n","export { installClientRouter };\nimport { assert } from './utils.js';\nimport { initHistoryState, monkeyPatchHistoryPushState } from './history.js';\nimport { getRenderCount, renderPageClientSide } from './renderPageClientSide.js';\nimport { onBrowserHistoryNavigation } from './onBrowserHistoryNavigation.js';\nimport { onLinkClick } from './onLinkClick.js';\nimport { setupNativeScrollRestoration } from './scrollRestoration.js';\nimport { autoSaveScrollPosition } from './setScrollPosition.js';\nfunction installClientRouter() {\n    setupNativeScrollRestoration();\n    initHistoryState();\n    autoSaveScrollPosition();\n    monkeyPatchHistoryPushState();\n    // First initial render\n    assert(getRenderCount() === 0);\n    renderPageClientSide({ scrollTarget: 'preserve-scroll', isBackwardNavigation: null, isClientSideNavigation: false });\n    assert(getRenderCount() === 1);\n    // Intercept <a> links\n    onLinkClick();\n    // Handle back-/forward navigation\n    onBrowserHistoryNavigation();\n}\n","import { assertClientRouting } from '../../utils/assertRoutingType.js';\nassertClientRouting();\nimport './pageFiles';\nimport { installClientRouter } from './installClientRouter.js';\nimport { onClientEntry_ClientRouting } from './utils.js';\n// @ts-ignore Since dist/cjs/client/ is never used, we can ignore this error.\nconst isProd = import.meta.env.PROD;\nonClientEntry_ClientRouting(isProd);\ninstallClientRouter();\n"],"file":"assets/entries/entry-client-routing.EwNyoUy1.js"}