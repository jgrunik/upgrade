import{o as z,a as te,c as h,u as oe,b as ne,d as B,e as M,f as w,h as y,g as i,s as f,m as H,j as m,k as A,l as O,S as re,r as p,t as d,n as _,p as v,I as se,q as j,v as le,w as F,x as ae,y as ce,i as ie}from"../chunks/chunk-Tt4mbXiW.js";import{_ as de}from"../chunks/chunk-GgBbLaes.js";function x(t,e={}){const o=ne(t);function n(s){var a;let l=(a=e.onInit)==null?void 0:a.call(e,s);return z(()=>{var c;l=(c=e.onMount)==null?void 0:c.call(e,l)}),te(()=>{var c;return(c=e.onCleanUp)==null?void 0:c.call(e,l)}),h(o.Provider,{value:t,get children(){return s.children}})}function r(){const s=oe(o);if(s===void 0)throw new Error("use() must be used within a Context.Provider");return s}return{Provider:n,use:r}}const[J,me]=B(),{Provider:ue,use:Y}=x({Peer:J,createPeer:ge},{onMount:()=>de(()=>import("../chunks/chunk-C7zfqIA9.js"),__vite__mapDeps([])).then(t=>me(()=>t.default))});function ge(...t){const e=J();if(!e)throw new Error("Peer used before ready");return new e(...t)}const he={MESSAGE:function(e,o){const{message:n}=o;console.log("Message received.",{id:e.peer,message:n})}},[pe,N]=M({players:[]}),{Provider:fe,use:S}=x({room:pe,setRoom:N},{onInit(){},onMount(){const e=new URLSearchParams(document.location.search).get("room");N({id:e??void 0,isHost:e===null})},onCleanUp(){}}),_e={PLAYER_INITIAL_INFO:(t,e)=>{const{peer:o}=t,{nickname:n,avatarSeed:r}=e,{room:s,setRoom:l}=S();console.log("Initialising player",{playerId:o,...e}),l("players",a=>a.map(c=>c.id!==o?c:{...c,nickname:n,avatarSeed:r})),console.table({id:o,...e})}},Q={...he,..._e};class ve{constructor(e,o){return{type:e,payload:o}}}function q(...t){t==null||t.forEach(([e,o])=>$e(e,o))}function $e(t,e){w(y(e,()=>localStorage.setItem(t,e()),{defer:!0}))}const[$,V]=M(),{Provider:ye,use:D}=x({localPlayer:$,setLocalPlayer:V},{onInit(){q(["playerId",()=>$.id],["nickname",()=>$.nickname],["avatarSeed",()=>$.avatarSeed])},onMount(){V({id:localStorage.getItem("playerId")??window.crypto.randomUUID(),nickname:localStorage.getItem("nickname")??"",avatarSeed:localStorage.getItem("avatarSeed")??window.crypto.randomUUID()})},onCleanUp(){}});function G(){const{room:t,setRoom:e}=S(),{createPeer:o}=Y(),n=o($.id),r=t.id;n.on("error",s=>{console.warn({roomId:r,error:s}),e("error",s),n.destroy()}).on("open",()=>{console.log("Connecting to room",{roomId:r});const s=n.connect(r);s.on("open",()=>{console.log("Connected to room",{roomId:r}),e("connection",s),s.send(new ve("PLAYER_INITIAL_INFO",{nickname:$.nickname,avatarSeed:$.avatarSeed}))}).on("close",()=>{console.log("Disconnected from room",{roomId:r})}).on("error",l=>{console.warn("Local Player Room error",{roomId:r,error:l}),e("error",l)}).on("data",l=>{console.log("Data from room",{roomId:r,data:l});const{type:a,payload:c}=l;if(a===void 0){const u=new Error("Malformed data from room",{cause:{roomId:r,data:l}});console.warn(u),e("error",u);return}Q[a](s,c)})})}const we=d("<img alt=avatar draggable=false>"),Se=d("<button>"),{localPlayer:k,setLocalPlayer:be}=D();function xe(t){const e=w(()=>{if(k!=null&&k.avatarSeed)return`https://api.dicebear.com/7.x/lorelei/svg?seed=${k.avatarSeed}`});return(()=>{const o=i(Se);return f(o,H(t,{id:"avatar_selector_button",class:"container border-3 border-dashed shadow shadow-small",style:{"font-size":"x-large","max-width":"28ch","aspect-ratio":1,height:"auto"},onClick:Pe}),!1,!0),m(o,h(re,{get when(){return e()},get children(){const n=i(we);return n.style.setProperty("margin","0"),n.style.setProperty("border","0"),A(()=>O(n,"src",e())),n}})),p(),o})()}function Pe(){be("avatarSeed",window.crypto.randomUUID())}const Ie=d("<svg xmlns=http://www.w3.org/2000/svg width=24 height=24><style>@keyframes spinner_xe7Q{93.75%,to{r:3px}46.875%{r:.2px}}.spinner_b2T7{animation:spinner_xe7Q .8s linear infinite}</style><circle cx=4 cy=12 r=3 class=spinner_b2T7></circle><circle cx=12 cy=12 r=3 class=spinner_b2T7 style=animation-delay:-.65s></circle><circle cx=20 cy=12 r=3 class=spinner_b2T7 style=animation-delay:-.5s>"),Ce=(t={})=>(()=>{const e=i(Ie);return f(e,t,!0,!0),p(),e})(),ke=d("<button>"),{room:E}=S();function Me(t){const{loading:e=()=>!0}=t,o=w(()=>w(()=>e()?Ce:`âš” ${E!=null&&E.isHost?"Host":"Join"} Room`));return(()=>{const n=i(ke);return f(n,H(t,{id:"enter_room_button",class:"btn-secondary-outline",style:"fill:var(--secondary); min-width: 11ch; max-width: fit-content; font-size: xx-large; font-variant: small-caps"}),!1,!0),m(n,()=>t.children??o()),p(),n})()}const Le=d("<input>");function Re(t){const{localPlayer:e,setLocalPlayer:o}=D();return(()=>{const n=i(Le);return f(n,H(t,{id:"nickname_name_input",type:"text",placeholder:"nickname goes here â™¥",class:"container border-3 border-dashed shadow shadow-hover shadow-small",maxlength:"24",style:{"text-align":"center","font-size":"x-large","max-width":"28ch"},get value(){return e==null?void 0:e.nickname},onInput:r=>o("nickname",r.target.value)}),!1,!1),p(),n})()}const Ee=()=>{const{room:t,setRoom:e}=S();return{hostRoom:t,setHostRoom:e}};function Ue(){console.log("Creating Host Room");const{hostRoom:t,setHostRoom:e}=Ee(),{createPeer:o}=Y(),n=o(t.id);return n.on("error",r=>{console.warn("Host Room Peer error",{error:r}),n.destroy()}).on("open",r=>{console.log("Room opened",{roomId:r}),e("id",r)}).on("connection",r=>{const s=r.peer;console.log("Player connecting",{playerId:s}),r.on("open",()=>{console.log("Player connected",{playerId:s});const l={id:s,connection:r};e("players",a=>[...a,l])}).on("close",()=>{console.log("Player disconnected",{playerId:s})}).on("error",l=>console.warn("Player connection error",{playerId:s,error:l})).on("data",l=>{const{type:a,payload:c}=l;if(a===void 0){console.warn("Malformed data from player",{playerId:s,data:l});return}Q[a](r,c)})}),{hostRoom:t,setHostRoom:e}}const He=d("<section><!$><!/><!$><!/>");function X(){const{localPlayer:t}=D(),{room:e}=S(),{UI:o,setUI:n}=L(),[r,s]=B(!1);w(y(()=>e.connection,()=>n("scene",{name:"Lobby"}),{defer:!0})),_(y(()=>e.id,()=>{e.isHost&&G()},{defer:!0})),_(y(()=>e.error,a=>{switch(a.type??a.name){case"peer-unavailable":{n("alert",{show:!0,level:"alert-warning",innerHTML:"Could not connect to room ðŸ¤”"});break}default:n("alert",{show:!0,level:"alert-danger",innerHTML:a.message})}},{defer:!0})),_(()=>{o.alert.show||s(!1)});function l(){s(!0);const{room:a}=S();a.isHost?Ue():G()}return[(()=>{const a=i(He),c=a.firstChild,[u,P]=v(c.nextSibling),R=u.nextSibling,[I,C]=v(R.nextSibling);return m(a,h(xe,{get disabled(){return r()}}),u,P),m(a,h(Re,{get disabled(){return r()}}),I,C),a})(),h(Me,{get disabled(){return!(t!=null&&t.nickname)||r()},onclick:l,loading:r})]}function Ae(){return"Game Layout"}const De=d('<svg xmlns=http://www.w3.org/2000/svg width=1em height=1em fill=none stroke-width=0 style=overflow:visible;color:currentcolor viewBox="0 -4 24 24"><path fill=currentColor fill-rule=evenodd d="M7 3a4.002 4.002 0 0 1 3.874 3H19v2h-8.126A4.002 4.002 0 0 1 3 7a4 4 0 0 1 4-4m0 6a2 2 0 1 0 0-4 2 2 0 0 0 0 4m10 11a4.002 4.002 0 0 1-3.874-3H5v-2h8.126A4.002 4.002 0 0 1 21 16a4 4 0 0 1-4 4m0-2a2 2 0 1 0 0-4 2 2 0 0 0 0 4"clip-rule=evenodd>'),Te=(t={})=>(()=>{const e=i(De);return f(e,t,!0,!0),p(),e})(),Ne=d('<div class="row flex-spaces tabs"><input id=tab1 type=radio name=tabs checked><label for=tab1><!$><!/> : Lobby</label><input id=tab2 type=radio name=tabs><label for=tab2><!$><!/> Options</label><div class=content id=content1><h4></h4><!$><!/></div><div class=content id=content2>settings...'),Ve=d("<li>");function Ge(){const{room:t}=S();return z(()=>{new URLSearchParams(document.location.search).get("room")==null&&history.pushState({},"",`?room=${t.id}`)}),(()=>{const e=i(Ne),o=e.firstChild,n=o.nextSibling,r=n.firstChild,[s,l]=v(r.nextSibling);s.nextSibling;const a=n.nextSibling,c=a.nextSibling,u=c.firstChild,[P,R]=v(u.nextSibling);P.nextSibling;const I=c.nextSibling,C=I.firstChild,K=C.nextSibling,[W,Z]=v(K.nextSibling);return m(n,()=>t.players.length,s,l),c.style.setProperty("height","5em"),m(c,Te,P,R),m(C,()=>`${t.players.length} player${t.players.length==1?"":"s"} in lobby`),m(I,h(se,{get each(){return t.players},children:(ee,$t)=>(()=>{const T=i(Ve);return m(T,()=>ee().id),T})()}),W,Z),e})()}const ze=["light","dark"],Be=ze,U=["system",...Be],Oe={Entry:X,Lobby:Ge,Game:Ae},[g,b]=M({colorScheme:{isDark:!1,setting:"system",toggleSetting:Je},scene:{name:"Entry",component:X},alert:{show:!1,level:"alert-warning",innerHTML:"Hello, world!"}}),{Provider:je,use:L}=x({UI:g,setUI:b},{onInit(){q(["colorSchemeSetting",()=>g.colorScheme.setting]),_(y(()=>g.colorScheme.isDark,()=>{g.colorScheme.isDark?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},{defer:!1})),_(()=>{b("colorScheme","isDark",g.colorScheme.setting!=="system"?g.colorScheme.setting==="dark":Fe()??g.colorScheme.isDark)}),_(y(()=>g.scene.name,()=>b("scene",{component:Oe[g.scene.name]}),{defer:!0}))},onMount(){const t=localStorage.getItem("colorSchemeSetting")??g.colorScheme.setting;b("colorScheme","setting",t),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:e})=>{g.colorScheme.setting==="system"&&b("colorScheme",{isDark:e})})},onCleanUp(){}});function Fe(){if(window.matchMedia!==void 0)return window.matchMedia("(prefers-color-scheme: dark)").matches}function Je(){const e=(U.indexOf(g.colorScheme.setting)+1)%U.length;b("colorScheme","setting",U[e])}const Ye=d("<dialog><input id=alertModal class=alert-state type=checkbox><div><!$><!/><label class=btn-close for=alertModal>"),Qe=()=>{const{UI:t,setUI:e}=L();return _(y(()=>t.alert.show,()=>{var o,n;t.alert.show?(o=t.alert.dialogRef)==null||o.showModal():(n=t.alert.dialogRef)==null||n.close()},{defer:!0})),_(()=>t.alert.dialogRef.addEventListener("close",()=>e("alert",{show:!1}))),(()=>{const o=i(Ye),n=o.firstChild,r=n.nextSibling,s=r.firstChild,[l,a]=v(s.nextSibling),c=l.nextSibling;return le(u=>e("alert",{dialogRef:u}),o),m(r,()=>t.alert.innerHTML,l,a),c.$$click=()=>{var u;return(u=t.alert.dialogRef)==null?void 0:u.close()},F(c,"innerText","X"),A(()=>ae(r,"alert  "+t.alert.level)),p(),o})()};j(["click"]);function qe(t){const{components:e=[],children:o}=t;return w(()=>e.reduceRight((n,r)=>h(r,{children:n}),o))}const[Xe,Ke]=M({}),{Provider:We,use:St}=x({game:Xe,setGame:Ke},{onInit(){},onMount(){},onCleanUp(){}}),Ze=[We,ye,ue,fe,je];const et=d('<footer><p xmlns:cc=http://creativecommons.org/ns# xmlns:dct=http://purl.org/dc/terms/><a rel=cc:attributionURL property=dct:title href=https://github.com/jgrunik/upgrade>Upgrade</a>&nbsp;by&nbsp;<a style=margin-right:0.5ch; rel="cc:attributionURL dct:creator"property=cc:attributionName href=https://github.com/jgrunik>Joshua Grunik</a>is licenced under<a style=display:inline-flex;margin-left:0.5ch; rel="license noopener noreferrer"href=http://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank></a><span style=display:inline-flex;height:1.75ch;margin-left:0.5ch;><img src=https://mirrors.creativecommons.org/presskit/icons/cc.svg><img src=https://mirrors.creativecommons.org/presskit/icons/by.svg><img src=https://mirrors.creativecommons.org/presskit/icons/nc.svg><img src=https://mirrors.creativecommons.org/presskit/icons/sa.svg>'),tt=()=>(()=>{const t=i(et),e=t.firstChild,o=e.firstChild,n=o.nextSibling,r=n.nextSibling,s=r.nextSibling,l=s.nextSibling;return F(l,"innerText","CC BY-NC-SA 4.0"),t})(),ot=d('<svg xmlns=http://www.w3.org/2000/svg width=1em height=1em fill=none stroke=currentColor stroke-width=0 style=overflow:visible;color:currentcolor viewBox="0 0 24 24"><path fill=currentColor fill-rule=evenodd stroke=none d="M2.25 5.25a3 3 0 0 1 3-3h13.5a3 3 0 0 1 3 3V15a3 3 0 0 1-3 3h-3v.257c0 .597.237 1.17.659 1.591l.621.622a.75.75 0 0 1-.53 1.28h-9a.75.75 0 0 1-.53-1.28l.621-.622a2.25 2.25 0 0 0 .659-1.59V18h-3a3 3 0 0 1-3-3zm1.5 0v7.5a1.5 1.5 0 0 0 1.5 1.5h13.5a1.5 1.5 0 0 0 1.5-1.5v-7.5a1.5 1.5 0 0 0-1.5-1.5H5.25a1.5 1.5 0 0 0-1.5 1.5"clip-rule=evenodd>'),nt=(t={})=>(()=>{const e=i(ot);return f(e,t,!0,!0),p(),e})(),rt=d('<svg xmlns=http://www.w3.org/2000/svg width=1em height=1em fill=currentColor stroke-width=0 style=overflow:visible;color:currentcolor viewBox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732z">'),st=(t={})=>(()=>{const e=i(rt);return f(e,t,!0,!0),p(),e})(),lt=d('<svg xmlns=http://www.w3.org/2000/svg width=1em height=1em fill=currentColor stroke-width=0 style=overflow:visible;color:currentcolor viewBox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0m9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708">'),at=(t={})=>(()=>{const e=i(lt);return f(e,t,!0,!0),p(),e})(),ct=d('<button class="card border"style=margin-right:0;margin:0;padding:0.5rem>'),it={system:nt,dark:st,light:at};function dt(){const{UI:t}=L(),e=w(()=>it[t.colorScheme.setting]);return(()=>{const o=i(ct);return ce(o,"click",t.colorScheme.toggleSetting,!0),m(o,e),A(()=>O(o,"popover-left",`color scheme '${t.colorScheme.setting}'`)),p(),o})()}j(["click"]);const mt=d('<svg xmlns=http://www.w3.org/2000/svg width=1em height=1em fill=currentColor stroke-width=0 style=overflow:visible;color:currentcolor viewBox="0 0 16 16"><path d="M12.775 5.44C9.751 3.192 8.708 1.393 8.001 0c-.708 1.393-1.75 3.192-4.774 5.44-5.157 3.833-.303 9.182 3.965 6.238-.278 1.827-1.227 3.159-2.191 3.733v.59h6v-.59c-.964-.574-1.913-1.906-2.191-3.733 4.268 2.944 9.122-2.405 3.965-6.238">'),ut=(t={})=>(()=>{const e=i(mt);return f(e,t,!0,!0),p(),e})();const gt=d("<header class=not-selectable><h1><!$><!/> Upgrade</h1><!$><!/>"),ht=()=>(()=>{const t=i(gt),e=t.firstChild,o=e.firstChild,[n,r]=v(o.nextSibling);n.nextSibling;const s=e.nextSibling,[l,a]=v(s.nextSibling);return m(e,ut,n,r),m(t,h(dt,{}),l,a),t})(),pt=d("<main>"),{UI:ft}=L();function _t(){return h(qe,{components:Ze,get children(){return[h(ht,{}),(()=>{const t=i(pt);return m(t,()=>ft.scene.component()),t})(),h(tt,{}),h(Qe,{})]}})}const vt=Object.freeze(Object.defineProperty({__proto__:null,default:_t},Symbol.toStringTag,{value:"Module"})),bt=[{configName:"onRenderClient",importPath:"/renderer/+onRenderClient.tsx",isValueFile:!0,exportValues:ie},{configName:"Page",importPath:"/pages/index/+Page.tsx",isValueFile:!0,exportValues:vt}],xt={onBeforeRenderEnv:{definedAt:{isComputed:!0},valueSerialized:"null"}};export{bt as configValuesImported,xt as configValuesSerialized};
//# sourceMappingURL=pages_index.BnASkYJf.js.map
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}